

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>decimal &mdash; Python Standard Library Doc</title>
  

  
  
    <link rel="shortcut icon" href="../_static/py.png"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python Standard Library Doc" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Python Standard Library Doc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01to05.html">Ch 01 - 05</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../01_intro/01.html">01 Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_builtin_functions/02.html">02 Built-in Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../02_builtin_functions/02.html#summary-table">Summary Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02_builtin_functions/02.html#a-e">a-e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02_builtin_functions/02.html#e-g">e-g</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02_builtin_functions/02.html#h-i">h-i</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02_builtin_functions/02.html#l-o">l-o</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02_builtin_functions/02.html#p-r">p-r</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02_builtin_functions/02.html#s-z">s-z</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../03_builtin_func_nonessential/03.html">03 Non-essential Built-in Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_builtin_constants/04.html">04 Built-in Constants</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../04_builtin_constants/04.html#constants-added-by-the-site-module">Constants added by the <code class="docutils literal"><span class="pre">site</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../05_builtin_types/05.html">05 Built-in Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/truth_value.html">1. Truth Value Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/boolean.html">2. Boolean Operations &#8212; <code class="docutils literal"><span class="pre">and</span></code>, <code class="docutils literal"><span class="pre">or</span></code>, <code class="docutils literal"><span class="pre">not</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/comparison.html">3. Comparisons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/numeric_types.html">4. Numeric Types &#8212; <code class="docutils literal"><span class="pre">int</span></code>, <code class="docutils literal"><span class="pre">float</span></code>, <code class="docutils literal"><span class="pre">long</span></code>, <code class="docutils literal"><span class="pre">complex</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/numeric_types.html#bitwise-operations-on-integer-types">4.1. Bitwise Operations on Integer Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/numeric_types.html#additional-methods-on-integer-types">4.2. Additional Methods on Integer Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/numeric_types.html#additional-methods-on-float">4.3. Additional Methods on Float</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/iterator_types.html">5. Iterator Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/iterator_types.html#generator-types">5.1. Generator Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/seq_types.html">6. Sequence Types &#8212; <code class="docutils literal"><span class="pre">str</span></code>, <code class="docutils literal"><span class="pre">unicode</span></code>, <code class="docutils literal"><span class="pre">list</span></code>, <code class="docutils literal"><span class="pre">tuple</span></code>, <code class="docutils literal"><span class="pre">bytearray</span></code>, <code class="docutils literal"><span class="pre">buffer</span></code>, <code class="docutils literal"><span class="pre">xrange</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/seq_types.html#string-methods">6.1. String Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/seq_types.html#string-formatting-operations">6.2. String Formatting Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/seq_types.html#xrange-type">6.3. XRange Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/seq_types.html#mutable-sequence-types">6.4. Mutable Sequence Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/set_types.html">7. Set Types &#8212; <code class="docutils literal"><span class="pre">set</span></code>, <code class="docutils literal"><span class="pre">frozenset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/mapping_types.html">8. Mapping Types &#8212; <code class="docutils literal"><span class="pre">dict</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/mapping_types.html#dictionary-view-objects">8.1. Dictionary view objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/file_objects.html">9. File Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/memory_view.html">10. memoryview type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/context_manager.html">11. Context Manager Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/other_tyeps.html">12. Other Built-in Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#modules">12.1. Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#classes-and-class-instances">12.2. Classes and Class Instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#functions">12.3. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#methods">12.4. Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#code-objects">12.5. Code Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#type-objects">12.6. Type Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#the-null-object">12.7. The Null Object</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#the-ellipsis-object">12.8. The Ellipsis Object</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#the-notimplemented-object">12.9. The NotImplemented Object</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#boolean-values">12.10. Boolean Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05_builtin_types/other_tyeps.html#internal-objects">12.11. Internal Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../05_builtin_types/special_attr.html">13. Special Attributes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../06to10.html">Ch 06 - 10</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../06_exceptions/06.html">06 Built-in Exceptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../06_exceptions/06.html#exception-hierarchy">Exception hierarchy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../07_string_services/7.html">07. String Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.1.string.html">1. <code class="docutils literal"><span class="pre">string</span></code> &#8212; Common string operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.1.string.html#string-constants">1.1. String constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.1.string.html#custom-string-formatting">1.2. Custom String Formatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.1.string.html#format-string-syntax">1.3. Format String Syntax</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.1.string.html#format-specification-mini-language">1.3.1. Format Specification Mini-Language</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.1.string.html#format-examples">1.3.2. Format examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.1.string.html#template-strings">1.4. Template strings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.1.string.html#string-functions">1.5. String functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.1.string.html#deprecated-string-functions">1.6. Deprecated string functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.2.re.html">2. <code class="docutils literal"><span class="pre">re</span></code> &#8212; Regular expression operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.2.re.html#regular-expression-syntax">2.1. Regular Expression Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.2.re.html#module-contents">2.2. Module Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.2.re.html#regular-expression-objects">2.3. Regular Expression Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.2.re.html#match-objects">2.4. Match Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.2.re.html#examples">2.5. Examples</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.2.re.html#checking-for-a-pair">2.5.1. Checking For a Pair</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.2.re.html#simulating-scanf">2.5.2. Simulating scanf()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.2.re.html#search-vs-match">2.5.3. search() vs. match()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.2.re.html#making-a-phonebook">2.5.4. Making a Phonebook</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.2.re.html#text-munging">2.5.5. Text Munging</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.2.re.html#finding-all-adverbs">2.5.6. Finding all Adverbs</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.2.re.html#finding-all-adverbs-and-their-positions">2.5.7. Finding all Adverbs and their Positions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.2.re.html#raw-string-notation">2.5.8. Raw String Notation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.3.struct.html">3. <code class="docutils literal"><span class="pre">struct</span></code> &#8212; Interpret strings as packed binary data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.3.struct.html#functions-and-exceptions">3.1. Functions and Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.3.struct.html#format-strings">3.2. Format Strings</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.3.struct.html#byte-order-size-and-alignment">3.2.1. Byte Order, Size, and Alignment</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.3.struct.html#format-characters">3.2.2. Format Characters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.3.struct.html#examples">3.2.3. Examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.3.struct.html#classes">3.3. Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.4.difflib.html">4. <code class="docutils literal"><span class="pre">difflib</span></code> &#8212; Helpers for computing deltas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.4.difflib.html#sequencematcher-objects">4.1. SequenceMatcher Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.4.difflib.html#sequencematcher-examples">4.2. SequenceMatcher Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.4.difflib.html#differ-objects">4.3. Differ Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.4.difflib.html#differ-example">4.4. Differ Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.4.difflib.html#a-command-line-interface-to-difflib">4.5. A command-line interface to difflib</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.5.stringio.html">5. <code class="docutils literal"><span class="pre">StringIO</span></code> &#8212; Read and write strings as files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.6.cstringio.html">6. <code class="docutils literal"><span class="pre">cStringIO</span></code> &#8212; Faster version of <code class="docutils literal"><span class="pre">StringIO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.7.textwrap.html">7. <code class="docutils literal"><span class="pre">textwrap</span></code> &#8212; Text wrapping and filling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.8.codecs.html">8. <code class="docutils literal"><span class="pre">codecs</span></code> &#8212; Codec registry and base classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.8.codecs.html#codec-base-classes">8.1. Codec Base Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.8.codecs.html#codec-objects">8.1.1. Codec Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.8.codecs.html#incrementalencoder-objects">8.1.2. IncrementalEncoder Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.8.codecs.html#incrementaldecoder-objects">8.1.3. IncrementalDecoder Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.8.codecs.html#streamwriter-objects">8.1.4. StreamWriter Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.8.codecs.html#streamreader-objects">8.1.5. StreamReader Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.8.codecs.html#streamreaderwriter-objects">8.1.6. StreamReaderWriter Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../07_string_services/7.8.codecs.html#streamrecoder-objects">8.1.7. StreamRecoder Objects</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.8.codecs.html#encodings-and-unicode">8.2. Encodings and Unicode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.8.codecs.html#standard-encodings">8.3. Standard Encodings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.8.codecs.html#python-specific-encodings">8.4. Python Specific Encodings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.8.codecs.html#module-encodings.idna">8.5. <code class="docutils literal"><span class="pre">encodings.idna</span></code> &#8212; Internationalized Domain Names in Applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../07_string_services/7.8.codecs.html#module-encodings.utf_8_sig">8.6. <code class="docutils literal"><span class="pre">encodings.utf_8_sig</span></code> &#8212; UTF-8 codec with BOM signature</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.9.unicodedata.html">9. <code class="docutils literal"><span class="pre">unicodedata</span></code> &#8212; Unicode Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.10.stringprep.html">10. <code class="docutils literal"><span class="pre">stringprep</span></code> &#8212; Internet String Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../07_string_services/7.11.fpformat.html">11. (deprecated) <code class="docutils literal"><span class="pre">fpformat</span></code> &#8212; Floating point conversions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../08_datat_types/8.html">08. Data Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/datetime.html">1. <code class="docutils literal"><span class="pre">datetime</span></code> &#8212; Basic date and time types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/datetime.html#available-types">1.1. Available Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/datetime.html#timedelta-objects">1.2. <code class="docutils literal"><span class="pre">timedelta</span></code> Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/datetime.html#date-objects">1.3. <code class="docutils literal"><span class="pre">date</span></code> Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/datetime.html#datetime-objects">1.4. <code class="docutils literal"><span class="pre">datetime</span></code> Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/datetime.html#time-objects">1.5. <code class="docutils literal"><span class="pre">time</span></code> Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/datetime.html#tzinfo-objects">1.6. <code class="docutils literal"><span class="pre">tzinfo</span></code> Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/datetime.html#strftime-and-strptime-behavior">1.7. <code class="docutils literal"><span class="pre">strftime()</span></code> and <code class="docutils literal"><span class="pre">strptime()</span></code> Behavior</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/calendar.html">2. <code class="docutils literal"><span class="pre">calendar</span></code> &#8212; General calendar-related functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/collections.html">3. <code class="docutils literal"><span class="pre">collections</span></code> &#8212; High-performance container datatypes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/collections.html#counter-objects">3.1. <code class="docutils literal"><span class="pre">Counter</span></code> objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/collections.html#deque-objects">3.2. <code class="docutils literal"><span class="pre">deque</span></code> objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../08_datat_types/collections.html#deque-recipes">3.2.1. <code class="docutils literal"><span class="pre">deque</span></code> Recipes</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/collections.html#defaultdict-objects">3.3. <code class="docutils literal"><span class="pre">defaultdict</span></code> objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../08_datat_types/collections.html#defaultdict-examples">3.3.1. <code class="docutils literal"><span class="pre">defaultdict</span></code> Examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/collections.html#namedtuple-factory-function-for-tuples-with-named-fields">3.4. <code class="docutils literal"><span class="pre">namedtuple()</span></code> Factory Function for Tuples with Named Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/collections.html#ordereddict-objects">3.5. <code class="docutils literal"><span class="pre">OrderedDict</span></code> objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../08_datat_types/collections.html#ordereddict-examples-and-recipes">3.5.1. <code class="docutils literal"><span class="pre">OrderedDict</span></code> Examples and Recipes</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/collections.html#collections-abstract-base-classes">3.6. Collections Abstract Base Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/heapq.html">4. <code class="docutils literal"><span class="pre">heapq</span></code> &#8212; Heap queue algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/heapq.html#basic-examples">4.1. Basic Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/heapq.html#priority-queue-implementation-notes">4.2. Priority Queue Implementation Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/heapq.html#theory">4.3. Theory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/bisect.html">5. <code class="docutils literal"><span class="pre">bisect</span></code> &#8212; Array bisection algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/bisect.html#searching-sorted-lists">5.1. Searching Sorted Lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/bisect.html#other-examples">5.2. Other Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/array.html">6. <code class="docutils literal"><span class="pre">array</span></code> &#8212; Efficient arrays of numeric values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/sets.html">7. <code class="docutils literal"><span class="pre">sets</span></code> &#8212; Unordered collections of unique elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/sets.html#set-objects">7.1. Set Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/sets.html#example">7.2. Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/sets.html#protocol-for-automatic-conversion-to-immutable">7.3. Protocol for automatic conversion to immutable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/sets.html#comparison-to-the-built-in-set-types">7.4. Comparison to the built-in <code class="docutils literal"><span class="pre">set</span></code> types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/sched.html">8. <code class="docutils literal"><span class="pre">sched</span></code> &#8212; Event scheduler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/sched.html#scheduler-objects">8.1. Scheduler Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/mutex.html">9. <code class="docutils literal"><span class="pre">mutex</span></code> &#8212; Mutual exclusion support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/mutex.html#mutex-objects">9.1. Mutex Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/queue.html">10. <code class="docutils literal"><span class="pre">Queue</span></code> &#8212; A synchronized queue class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/queue.html#queue-objects">10.1. Queue Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/weakref.html">11. <code class="docutils literal"><span class="pre">weakref</span></code> &#8212; Weak references</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/weakref.html#weak-reference-objects">11.1. Weak Reference Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/weakref.html#example">11.2. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/userdict.html">12. <code class="docutils literal"><span class="pre">UserDict</span></code> &#8212; Class wrapper for dictionary objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/userdict.html#module-UserList">13. <code class="docutils literal"><span class="pre">UserList</span></code> &#8212; Class wrapper for list objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/userdict.html#module-UserString">14. <code class="docutils literal"><span class="pre">UserString</span></code> &#8212; Class wrapper for string objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/types.html">15. <code class="docutils literal"><span class="pre">types</span></code> &#8212; Names for built-in types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/new.html">16. <code class="docutils literal"><span class="pre">new</span></code> &#8212; Creation of runtime internal objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/copy.html">17. <code class="docutils literal"><span class="pre">copy</span></code> &#8212; Shallow and deep copy operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/pprint.html">18. <code class="docutils literal"><span class="pre">pprint</span></code> &#8212; Data pretty printer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/pprint.html#prettyprinter-objects">18.1. PrettyPrinter Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/pprint.html#pprint-example">18.2. pprint Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08_datat_types/repr.html">19. <code class="docutils literal"><span class="pre">repr</span></code> &#8212; Alternate <code class="docutils literal"><span class="pre">repr()</span></code> implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/repr.html#repr-objects">19.1. Repr Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../08_datat_types/repr.html#subclassing-repr-objects">19.2. Subclassing Repr Objects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../09_numeric/09.html">09 Numeric and Mathematical Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/numbers.html">1. <code class="docutils literal"><span class="pre">numbers</span></code> &#8212; Numeric abstract base classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/numbers.html#the-numeric-tower">1.1. The numeric tower</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/numbers.html#notes-for-type-implementors">1.2. Notes for type implementors</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../09_numeric/numbers.html#adding-more-numeric-abcs">1.2.1. Adding More Numeric ABCs</a></li>
<li class="toctree-l5"><a class="reference internal" href="../09_numeric/numbers.html#implementing-the-arithmetic-operations">1.2.2. Implementing the arithmetic operations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/math.html">2. <code class="docutils literal"><span class="pre">math</span></code> &#8212; Mathematical functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/math.html#number-theoretic-and-representation-functions">2.1. Number-theoretic and representation functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/math.html#power-and-logarithmic-functions">2.2. Power and logarithmic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/math.html#trigonometric-functions">2.3. Trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/math.html#angular-conversion">2.4. Angular conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/math.html#hyperbolic-functions">2.5. Hyperbolic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/math.html#special-functions">2.6. Special functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/math.html#constants">2.7. Constants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/cmath.html">3. <code class="docutils literal"><span class="pre">cmath</span></code> &#8212; Mathematical functions for complex numbers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/cmath.html#conversions-to-and-from-polar-coordinates">3.1. Conversions to and from polar coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/cmath.html#power-and-logarithmic-functions">3.2. Power and logarithmic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/cmath.html#trigonometric-functions">3.3. Trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/cmath.html#hyperbolic-functions">3.4. Hyperbolic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/cmath.html#classification-functions">3.5. Classification functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/cmath.html#constants">3.6. Constants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/decimal.html">4. <code class="docutils literal"><span class="pre">decimal</span></code> &#8212; Decimal fixed point and floating point arithmetic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/decimal.html#quick-start-tutorial">4.1. Quick-start Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/decimal.html#decimal-objects">4.2. Decimal objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../09_numeric/decimal.html#logical-operands">4.2.1. Logical operands</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/decimal.html#context-objects">4.3. Context objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/decimal.html#signals">4.4. Signals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/decimal.html#floating-point-notes">4.5. Floating Point Notes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../09_numeric/decimal.html#mitigating-round-off-error-with-increased-precision">4.5.1. Mitigating round-off error with increased precision</a></li>
<li class="toctree-l5"><a class="reference internal" href="../09_numeric/decimal.html#special-values">4.5.2. Special values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/decimal.html#working-with-threads">4.6. Working with threads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/decimal.html#recipes">4.7. Recipes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/decimal.html#decimal-faq">4.8. Decimal FAQ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/fractions.html">5. <code class="docutils literal"><span class="pre">fractions</span></code> &#8212; Rational numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/random.html">6. <code class="docutils literal"><span class="pre">random</span></code> &#8212; Generate pseudo-random numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/itertools.html">7. <code class="docutils literal"><span class="pre">itertools</span></code> &#8212; Functions creating iterators for efficient looping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/itertools.html#itertool-functions">7.1. Itertool functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/itertools.html#recipes">7.2. Recipes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/functools.html">8. <code class="docutils literal"><span class="pre">functools</span></code> &#8212; Higher-order functions and operations on callable objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/functools.html#partial-objects">8.1. <code class="docutils literal"><span class="pre">partial</span></code> Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../09_numeric/operator.html">9. <code class="docutils literal"><span class="pre">operator</span></code> &#8212; Standard operators as functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../09_numeric/operator.html#mapping-operators-to-functions">9.1. Mapping Operators to Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../10_filesys/10.html">10 File and Directory Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/os.path.html">1. <code class="docutils literal"><span class="pre">os.path</span></code> &#8212; Common pathname manipulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/fileinput.html">2. <code class="docutils literal"><span class="pre">fileinput</span></code> &#8212; Iterate over lines from multiple input streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/stat.html">3. <code class="docutils literal"><span class="pre">stat</span></code> &#8212; Interpreting <code class="docutils literal"><span class="pre">stat()</span></code> results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/statvfs.html">4. <code class="docutils literal"><span class="pre">statvfs</span></code> &#8212; Constants used with <code class="docutils literal"><span class="pre">os.statvfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/filecmp.html">5. <code class="docutils literal"><span class="pre">filecmp</span></code> &#8212; File and Directory Comparisons</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../10_filesys/filecmp.html#the-dircmp-class">5.1. The <code class="docutils literal"><span class="pre">dircmp</span></code> class</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/tempfile.html">6. <code class="docutils literal"><span class="pre">tempfile</span></code> &#8212; Generate temporary files and directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/glob.html">7. <code class="docutils literal"><span class="pre">glob</span></code> &#8212; Unix style pathname pattern expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/fnmatch.html">8. <code class="docutils literal"><span class="pre">fnmatch</span></code> &#8212; Unix filename pattern matching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/linecache.html">9. <code class="docutils literal"><span class="pre">linecache</span></code> &#8212; Random access to text lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/shutil.html">10. <code class="docutils literal"><span class="pre">shutil</span></code> &#8212; High-level file operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../10_filesys/shutil.html#directory-and-files-operations">10.1. Directory and files operations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../10_filesys/shutil.html#copytree-example">10.1.1. copytree example</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../10_filesys/shutil.html#archiving-operations">10.2. Archiving operations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../10_filesys/shutil.html#archiving-example">10.2.1. Archiving example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/dircache.html">11. <code class="docutils literal"><span class="pre">dircache</span></code> &#8212; Cached directory listings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10_filesys/macpath.html">12. <code class="docutils literal"><span class="pre">macpath</span></code> &#8212; Mac OS 9 path manipulation functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../11to15.html">Ch 11 - 15</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../11_data_persistence/11.html">11. Data Persistence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html">1. <code class="docutils literal"><span class="pre">pickle</span></code> &#8212; Python object serialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#relationship-to-other-python-modules">1.1. Relationship to other Python modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#data-stream-format">1.2. Data stream format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#usage">1.3. Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#what-can-be-pickled-and-unpickled">1.4. What can be pickled and unpickled?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#the-pickle-protocol">1.5. The pickle protocol</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#pickling-and-unpickling-normal-class-instances">1.5.1. Pickling and unpickling normal class instances</a></li>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#pickling-and-unpickling-extension-types">1.5.2. Pickling and unpickling extension types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#pickling-and-unpickling-external-objects">1.5.3. Pickling and unpickling external objects</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#subclassing-unpicklers">1.6. Subclassing Unpicklers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.1_pickle.html#example">1.7. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.2_cpickle.html">2. <code class="docutils literal"><span class="pre">cPickle</span></code> &#8212; A faster <code class="docutils literal"><span class="pre">pickle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.3_copy_reg.html">3. <code class="docutils literal"><span class="pre">copy_reg</span></code> &#8212; Register <code class="docutils literal"><span class="pre">pickle</span></code> support functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.3_copy_reg.html#example">3.1. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.4_shelve.html">4. <code class="docutils literal"><span class="pre">shelve</span></code> &#8212; Python object persistence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.4_shelve.html#restrictions">4.1. Restrictions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.4_shelve.html#example">4.2. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.5_marshal.html">5. <code class="docutils literal"><span class="pre">marshal</span></code> &#8212; Internal Python object serialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.6_anydbm.html">6. <code class="docutils literal"><span class="pre">anydbm</span></code> &#8212; Generic access to DBM-style databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.7_whichdb.html">7. <code class="docutils literal"><span class="pre">whichdb</span></code> &#8212; Guess which DBM module created a database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.8_dbm.html">8. <code class="docutils literal"><span class="pre">dbm</span></code> &#8212; Simple &#8220;database&#8221; interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.9_gdbm.html">9. <code class="docutils literal"><span class="pre">gdbm</span></code> &#8212; GNU&#8217;s reinterpretation of dbm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.10_dbhash.html">10. (deprecated) <code class="docutils literal"><span class="pre">dbhash</span></code> &#8212; DBM-style interface to the BSD database library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.10_dbhash.html#database-objects">10.1. Database Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.11_bsddb.html">11. (deprecated) <code class="docutils literal"><span class="pre">bsddb</span></code> &#8212; Interface to Berkeley DB library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.11_bsddb.html#hash-btree-and-record-objects">11.1. Hash, BTree and Record Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.12_dumbdbm.html">12. <code class="docutils literal"><span class="pre">dumbdbm</span></code> &#8212; Portable DBM implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.12_dumbdbm.html#dumbdbm-objects">12.1. Dumbdbm Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html">13. <code class="docutils literal"><span class="pre">sqlite3</span></code> &#8212; DB-API 2.0 interface for SQLite databases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#module-functions-and-constants">13.1. Module functions and constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#connection-objects">13.2. Connection Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#cursor-objects">13.3. Cursor Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#row-objects">13.4. Row Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#sqlite-and-python-types">13.5. SQLite and Python types</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#introduction">13.5.1. Introduction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#using-adapters-to-store-additional-python-types-in-sqlite-databases">13.5.2. Using adapters to store additional Python types in SQLite databases</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#letting-your-object-adapt-itself">13.5.2.1. Letting your object adapt itself</a></li>
<li class="toctree-l6"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#registering-an-adapter-callable">13.5.2.2. Registering an adapter callable</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#converting-sqlite-values-to-custom-python-types">13.5.3. Converting SQLite values to custom Python types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#default-adapters-and-converters">13.5.4. Default adapters and converters</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#controlling-transactions">13.6. Controlling Transactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#using-sqlite3-efficiently">13.7. Using <code class="docutils literal"><span class="pre">sqlite3</span></code> efficiently</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#using-shortcut-methods">13.7.1. Using shortcut methods</a></li>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#accessing-columns-by-name-instead-of-by-index">13.7.2. Accessing columns by name instead of by index</a></li>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#using-the-connection-as-a-context-manager">13.7.3. Using the connection as a context manager</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#common-issues">13.8. Common issues</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../11_data_persistence/11.13_sqlite.html#multithreading">13.8.1. Multithreading</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../12_archiving/12.html">12 Data Compression and Archiving</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../12_archiving/zlib.html">1. <code class="docutils literal"><span class="pre">zlib</span></code> &#8212; Compression compatible with <strong class="program">gzip</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../12_archiving/gzip.html">2. <code class="docutils literal"><span class="pre">gzip</span></code> &#8212; Support for <strong class="program">gzip</strong> files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/gzip.html#examples-of-usage">2.1. Examples of usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../12_archiving/bz2.html">3. <code class="docutils literal"><span class="pre">bz2</span></code> &#8212; Compression compatible with <strong class="program">bzip2</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/bz2.html#de-compression-of-files">3.1. (De)compression of files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/bz2.html#sequential-de-compression">3.2. Sequential (de)compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/bz2.html#one-shot-de-compression">3.3. One-shot (de)compression</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../12_archiving/zipfile.html">4. <code class="docutils literal"><span class="pre">zipfile</span></code> &#8212; Work with ZIP archives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/zipfile.html#zipfile-objects">4.1. ZipFile Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/zipfile.html#pyzipfile-objects">4.2. PyZipFile Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/zipfile.html#zipinfo-objects">4.3. ZipInfo Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../12_archiving/tarfile.html">5. <code class="docutils literal"><span class="pre">tarfile</span></code> &#8212; Read and write tar archive files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/tarfile.html#tarfile-objects">5.1. TarFile Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/tarfile.html#tarinfo-objects">5.2. TarInfo Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/tarfile.html#examples">5.3. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/tarfile.html#supported-tar-formats">5.4. Supported tar formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../12_archiving/tarfile.html#unicode-issues">5.5. Unicode issues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../13_fileformats/13.html">13 File Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../13_fileformats/csv.html"><code class="docutils literal"><span class="pre">csv</span></code> &#8212; CSV File Reading and Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/csv.html#module-contents">Module Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/csv.html#dialects-and-formatting-parameters">Dialects and Formatting Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/csv.html#reader-objects">Reader Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/csv.html#writer-objects">Writer Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/csv.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../13_fileformats/configparser.html"><code class="docutils literal"><span class="pre">ConfigParser</span></code> &#8212; Configuration file parser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/configparser.html#rawconfigparser-objects">RawConfigParser Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/configparser.html#configparser-objects">ConfigParser Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/configparser.html#safeconfigparser-objects">SafeConfigParser Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/configparser.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../13_fileformats/robotparser.html"><code class="docutils literal"><span class="pre">robotparser</span></code> &#8212;  Parser for robots.txt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../13_fileformats/netrc.html"><code class="docutils literal"><span class="pre">netrc</span></code> &#8212; netrc file processing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/netrc.html#netrc-objects">netrc Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../13_fileformats/xdrlib.html"><code class="docutils literal"><span class="pre">xdrlib</span></code> &#8212; Encode and decode XDR data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/xdrlib.html#packer-objects">Packer Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/xdrlib.html#unpacker-objects">Unpacker Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/xdrlib.html#exceptions">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../13_fileformats/plistlib.html"><code class="docutils literal"><span class="pre">plistlib</span></code> &#8212; Generate and parse Mac OS X <code class="docutils literal"><span class="pre">.plist</span></code> files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../13_fileformats/plistlib.html#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../14_crypto/14.html">14 Cryptographic Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../14_crypto/hashlib.html">1. <code class="docutils literal"><span class="pre">hashlib</span></code> &#8212; Secure hashes and message digests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../14_crypto/hashlib.html#key-derivation">1.1. Key derivation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../14_crypto/hmac.html">2. <code class="docutils literal"><span class="pre">hmac</span></code> &#8212; Keyed-Hashing for Message Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../14_crypto/md5.html">3. <code class="docutils literal"><span class="pre">md5</span></code> &#8212; MD5 message digest algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../14_crypto/sha.html">4. <code class="docutils literal"><span class="pre">sha</span></code> &#8212; SHA-1 message digest algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../15_allos/15.html">15 Generic Operating System Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/os.html">1. <code class="docutils literal"><span class="pre">os</span></code> &#8212; Miscellaneous operating system interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/os.html#process-parameters">1.1. Process Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/os.html#file-object-creation">1.2. File Object Creation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/os.html#file-descriptor-operations">1.3. File Descriptor Operations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/os.html#open-flag-constants">1.3.1. <code class="docutils literal"><span class="pre">open()</span></code> flag constants</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/os.html#files-and-directories">1.4. Files and Directories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/os.html#process-management">1.5. Process Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/os.html#miscellaneous-system-information">1.6. Miscellaneous System Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/os.html#miscellaneous-functions">1.7. Miscellaneous Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/io.html">2. <code class="docutils literal"><span class="pre">io</span></code> &#8212; Core tools for working with streams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/io.html#module-interface">2.1. Module Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/io.html#i-o-base-classes">2.2. I/O Base Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/io.html#raw-file-i-o">2.3. Raw File I/O</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/io.html#buffered-streams">2.4. Buffered Streams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/io.html#text-i-o">2.5. Text I/O</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/io.html#advanced-topics">2.6. Advanced topics</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/io.html#performance">2.6.1. Performance</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../15_allos/io.html#binary-i-o">2.6.1.1. Binary I/O</a></li>
<li class="toctree-l6"><a class="reference internal" href="../15_allos/io.html#id1">2.6.1.2. Text I/O</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/io.html#multi-threading">2.6.2. Multi-threading</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/io.html#reentrancy">2.6.3. Reentrancy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/argparse.html">3. <code class="docutils literal"><span class="pre">argparse</span></code> &#8212; Parser for command-line options, arguments and sub-commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/argparse.html#example">3.1. Example</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#creating-a-parser">3.1.1. Creating a parser</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#adding-arguments">3.1.2. Adding arguments</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#parsing-arguments">3.1.3. Parsing arguments</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/argparse.html#argumentparser-objects">3.2. ArgumentParser objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#prog">3.2.1. prog</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#usage">3.2.2. usage</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#description">3.2.3. description</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#epilog">3.2.4. epilog</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#parents">3.2.5. parents</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#formatter-class">3.2.6. formatter_class</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#prefix-chars">3.2.7. prefix_chars</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#fromfile-prefix-chars">3.2.8. fromfile_prefix_chars</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#argument-default">3.2.9. argument_default</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#conflict-handler">3.2.10. conflict_handler</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#add-help">3.2.11. add_help</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/argparse.html#the-add-argument-method">3.3. The add_argument() method</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#name-or-flags">3.3.1. name or flags</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#action">3.3.2. action</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#nargs">3.3.3. nargs</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#const">3.3.4. const</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#default">3.3.5. default</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#type">3.3.6. type</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#choices">3.3.7. choices</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#required">3.3.8. required</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#help">3.3.9. help</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#metavar">3.3.10. metavar</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#dest">3.3.11. dest</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#action-classes">3.3.12. Action classes</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/argparse.html#the-parse-args-method">3.4. The parse_args() method</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#option-value-syntax">3.4.1. Option value syntax</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#invalid-arguments">3.4.2. Invalid arguments</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#arguments-containing">3.4.3. Arguments containing <code class="docutils literal"><span class="pre">-</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#argument-abbreviations-prefix-matching">3.4.4. Argument abbreviations (prefix matching)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#beyond-sys-argv">3.4.5. Beyond <code class="docutils literal"><span class="pre">sys.argv</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#the-namespace-object">3.4.6. The Namespace object</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/argparse.html#other-utilities">3.5. Other utilities</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#sub-commands">3.5.1. Sub-commands</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#filetype-objects">3.5.2. FileType objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#argument-groups">3.5.3. Argument groups</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#mutual-exclusion">3.5.4. Mutual exclusion</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#parser-defaults">3.5.5. Parser defaults</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#printing-help">3.5.6. Printing help</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#partial-parsing">3.5.7. Partial parsing</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#customizing-file-parsing">3.5.8. Customizing file parsing</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/argparse.html#exiting-methods">3.5.9. Exiting methods</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/argparse.html#upgrading-optparse-code">3.6. Upgrading optparse code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/optparse.html">4. <code class="docutils literal"><span class="pre">optparse</span></code> &#8212; Parser for command line options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/optparse.html#background">4.1. Background</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#terminology">4.1.1. Terminology</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#what-are-options-for">4.1.2. What are options for?</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#what-are-positional-arguments-for">4.1.3. What are positional arguments for?</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/optparse.html#tutorial">4.2. Tutorial</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#understanding-option-actions">4.2.1. Understanding option actions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#the-store-action">4.2.2. The store action</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#handling-boolean-flag-options">4.2.3. Handling boolean (flag) options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#other-actions">4.2.4. Other actions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#default-values">4.2.5. Default values</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#generating-help">4.2.6. Generating help</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../15_allos/optparse.html#grouping-options">4.2.6.1. Grouping Options</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#printing-a-version-string">4.2.7. Printing a version string</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#how-optparse-handles-errors">4.2.8. How <code class="docutils literal"><span class="pre">optparse</span></code> handles errors</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#putting-it-all-together">4.2.9. Putting it all together</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/optparse.html#reference-guide">4.3. Reference Guide</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#creating-the-parser">4.3.1. Creating the parser</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#populating-the-parser">4.3.2. Populating the parser</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#defining-options">4.3.3. Defining options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#option-attributes">4.3.4. Option attributes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#standard-option-actions">4.3.5. Standard option actions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#standard-option-types">4.3.6. Standard option types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#parsing-arguments">4.3.7. Parsing arguments</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#querying-and-manipulating-your-option-parser">4.3.8. Querying and manipulating your option parser</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#conflicts-between-options">4.3.9. Conflicts between options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#cleanup">4.3.10. Cleanup</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#other-methods">4.3.11. Other methods</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/optparse.html#option-callbacks">4.4. Option Callbacks</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#defining-a-callback-option">4.4.1. Defining a callback option</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#how-callbacks-are-called">4.4.2. How callbacks are called</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#raising-errors-in-a-callback">4.4.3. Raising errors in a callback</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#callback-example-1-trivial-callback">4.4.4. Callback example 1: trivial callback</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#callback-example-2-check-option-order">4.4.5. Callback example 2: check option order</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#callback-example-3-check-option-order-generalized">4.4.6. Callback example 3: check option order (generalized)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#callback-example-4-check-arbitrary-condition">4.4.7. Callback example 4: check arbitrary condition</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#callback-example-5-fixed-arguments">4.4.8. Callback example 5: fixed arguments</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#callback-example-6-variable-arguments">4.4.9. Callback example 6: variable arguments</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/optparse.html#extending-optparse">4.5. Extending <code class="docutils literal"><span class="pre">optparse</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#adding-new-types">4.5.1. Adding new types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/optparse.html#adding-new-actions">4.5.2. Adding new actions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/getopt.html">5. <code class="docutils literal"><span class="pre">getopt</span></code> &#8212; C-style parser for command line options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/logging.html">6. <code class="docutils literal"><span class="pre">logging</span></code> &#8212; Logging facility for Python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#logger-objects">6.1. Logger Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#logging-levels">6.2. Logging Levels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#handler-objects">6.3. Handler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#formatter-objects">6.4. Formatter Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#filter-objects">6.5. Filter Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#logrecord-objects">6.6. LogRecord Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#logrecord-attributes">6.7. LogRecord attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#loggeradapter-objects">6.8. LoggerAdapter Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#thread-safety">6.9. Thread Safety</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#module-level-functions">6.10. Module-Level Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.html#integration-with-the-warnings-module">6.11. Integration with the warnings module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/logging.config.html">7. <code class="docutils literal"><span class="pre">logging.config</span></code> &#8212; Logging configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.config.html#configuration-functions">7.1. Configuration functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.config.html#configuration-dictionary-schema">7.2. Configuration dictionary schema</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/logging.config.html#dictionary-schema-details">7.2.1. Dictionary Schema Details</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/logging.config.html#incremental-configuration">7.2.2. Incremental Configuration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/logging.config.html#object-connections">7.2.3. Object connections</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/logging.config.html#user-defined-objects">7.2.4. User-defined objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/logging.config.html#access-to-external-objects">7.2.5. Access to external objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/logging.config.html#access-to-internal-objects">7.2.6. Access to internal objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/logging.config.html#import-resolution-and-custom-importers">7.2.7. Import resolution and custom importers</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.config.html#configuration-file-format">7.3. Configuration file format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/logging.handlers.html">8. <code class="docutils literal"><span class="pre">logging.handlers</span></code> &#8212; Logging handlers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#streamhandler">8.1. StreamHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#filehandler">8.2. FileHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#nullhandler">8.3. NullHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#watchedfilehandler">8.4. WatchedFileHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#rotatingfilehandler">8.5. RotatingFileHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#timedrotatingfilehandler">8.6. TimedRotatingFileHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#sockethandler">8.7. SocketHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#datagramhandler">8.8. DatagramHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#sysloghandler">8.9. SysLogHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#nteventloghandler">8.10. NTEventLogHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#smtphandler">8.11. SMTPHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#memoryhandler">8.12. MemoryHandler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/logging.handlers.html#httphandler">8.13. HTTPHandler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/getpass.html">9. <code class="docutils literal"><span class="pre">getpass</span></code> &#8212; Portable password input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/curses.html">10. <code class="docutils literal"><span class="pre">curses</span></code> &#8212; Terminal handling for character-cell displays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/curses.html#functions">10.1. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/curses.html#window-objects">10.2. Window Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/curses.html#constants">10.3. Constants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/curses.html#module-curses.textpad">11. <code class="docutils literal"><span class="pre">curses.textpad</span></code> &#8212; Text input widget for curses programs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/curses.html#textbox-objects">11.1. Textbox objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/curses.ascii.html">12. <code class="docutils literal"><span class="pre">curses.ascii</span></code> &#8212; Utilities for ASCII characters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/curses.panel.html">13. <code class="docutils literal"><span class="pre">curses.panel</span></code> &#8212; A panel stack extension for curses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/curses.panel.html#functions">13.1. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/curses.panel.html#panel-objects">13.2. Panel Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/platform.html">14. <code class="docutils literal"><span class="pre">platform</span></code> &#8212;  Access to underlying platform&#8217;s identifying data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/platform.html#cross-platform">14.1. Cross Platform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/platform.html#java-platform">14.2. Java Platform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/platform.html#windows-platform">14.3. Windows Platform</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/platform.html#win95-98-specific">14.3.1. Win95/98 specific</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/platform.html#mac-os-platform">14.4. Mac OS Platform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/platform.html#unix-platforms">14.5. Unix Platforms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/errno.html">15. <code class="docutils literal"><span class="pre">errno</span></code> &#8212; Standard errno system symbols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../15_allos/ctypes.html">16. <code class="docutils literal"><span class="pre">ctypes</span></code> &#8212; A foreign function library for Python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/ctypes.html#ctypes-tutorial">16.1. ctypes tutorial</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#loading-dynamic-link-libraries">16.1.1. Loading dynamic link libraries</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#accessing-functions-from-loaded-dlls">16.1.2. Accessing functions from loaded dlls</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#calling-functions">16.1.3. Calling functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#fundamental-data-types">16.1.4. Fundamental data types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#calling-functions-continued">16.1.5. Calling functions, continued</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#calling-functions-with-your-own-custom-data-types">16.1.6. Calling functions with your own custom data types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#specifying-the-required-argument-types-function-prototypes">16.1.7. Specifying the required argument types (function prototypes)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#return-types">16.1.8. Return types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#passing-pointers-or-passing-parameters-by-reference">16.1.9. Passing pointers (or: passing parameters by reference)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#structures-and-unions">16.1.10. Structures and unions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#structure-union-alignment-and-byte-order">16.1.11. Structure/union alignment and byte order</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#bit-fields-in-structures-and-unions">16.1.12. Bit fields in structures and unions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#arrays">16.1.13. Arrays</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#pointers">16.1.14. Pointers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#type-conversions">16.1.15. Type conversions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#incomplete-types">16.1.16. Incomplete Types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#callback-functions">16.1.17. Callback functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#accessing-values-exported-from-dlls">16.1.18. Accessing values exported from dlls</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#surprises">16.1.19. Surprises</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#variable-sized-data-types">16.1.20. Variable-sized data types</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../15_allos/ctypes.html#ctypes-reference">16.2. ctypes reference</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#finding-shared-libraries">16.2.1. Finding shared libraries</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#loading-shared-libraries">16.2.2. Loading shared libraries</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#foreign-functions">16.2.3. Foreign functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#function-prototypes">16.2.4. Function prototypes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#utility-functions">16.2.5. Utility functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#data-types">16.2.6. Data types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#ctypes-fundamental-data-types-2">16.2.7. Fundamental data types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#structured-data-types">16.2.8. Structured data types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../15_allos/ctypes.html#arrays-and-pointers">16.2.9. Arrays and pointers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../16to20.html">Ch 16 - 20</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../16_someos/16.html">16 Optional Operating System Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/select.html">1. <code class="docutils literal"><span class="pre">select</span></code> &#8212; Waiting for I/O completion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/select.html#edge-and-level-trigger-polling-epoll-objects">1.1. Edge and Level Trigger Polling (epoll) Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/select.html#polling-objects">1.2. Polling Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/select.html#kqueue-objects">1.3. Kqueue Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/select.html#kevent-objects">1.4. Kevent Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/threading.html">2. <code class="docutils literal"><span class="pre">threading</span></code> &#8212; Higher-level threading interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#thread-objects">2.1. Thread Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#lock-objects">2.2. Lock Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#rlock-objects">2.3. RLock Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#condition-objects">2.4. Condition Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#semaphore-objects">2.5. Semaphore Objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/threading.html#semaphore-example">2.5.1. <code class="docutils literal"><span class="pre">Semaphore</span></code> Example</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#event-objects">2.6. Event Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#timer-objects">2.7. Timer Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#using-locks-conditions-and-semaphores-in-the-with-statement">2.8. Using locks, conditions, and semaphores in the <code class="docutils literal"><span class="pre">with</span></code> statement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/threading.html#importing-in-threaded-code">2.9. Importing in threaded code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/thread.html">3. <code class="docutils literal"><span class="pre">thread</span></code> &#8212; Multiple threads of control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/dummy_threading.html">4. <code class="docutils literal"><span class="pre">dummy_threading</span></code> &#8212; Drop-in replacement for the <code class="docutils literal"><span class="pre">threading</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/dummy_thread.html">5. <code class="docutils literal"><span class="pre">dummy_thread</span></code> &#8212; Drop-in replacement for the <code class="docutils literal"><span class="pre">thread</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/multiprocessing.html">6. <code class="docutils literal"><span class="pre">multiprocessing</span></code> &#8212; Process-based &#8220;threading&#8221; interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/multiprocessing.html#introduction">6.1. Introduction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#the-process-class">6.1.1. The <code class="docutils literal"><span class="pre">Process</span></code> class</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#exchanging-objects-between-processes">6.1.2. Exchanging objects between processes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#synchronization-between-processes">6.1.3. Synchronization between processes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#sharing-state-between-processes">6.1.4. Sharing state between processes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#using-a-pool-of-workers">6.1.5. Using a pool of workers</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/multiprocessing.html#reference">6.2. Reference</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#process-and-exceptions">6.2.1. <code class="docutils literal"><span class="pre">Process</span></code> and exceptions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#pipes-and-queues">6.2.2. Pipes and Queues</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#miscellaneous">6.2.3. Miscellaneous</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#connection-objects">6.2.4. Connection Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#synchronization-primitives">6.2.5. Synchronization primitives</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#shared-ctypes-objects">6.2.6. Shared <code class="docutils literal"><span class="pre">ctypes</span></code> Objects</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../16_someos/multiprocessing.html#module-multiprocessing.sharedctypes">6.2.6.1. The <code class="docutils literal"><span class="pre">multiprocessing.sharedctypes</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#managers">6.2.7. Managers</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../16_someos/multiprocessing.html#customized-managers">6.2.7.1. Customized managers</a></li>
<li class="toctree-l6"><a class="reference internal" href="../16_someos/multiprocessing.html#using-a-remote-manager">6.2.7.2. Using a remote manager</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#proxy-objects">6.2.8. Proxy Objects</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../16_someos/multiprocessing.html#cleanup">6.2.8.1. Cleanup</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#module-multiprocessing.pool">6.2.9. Process Pools</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#module-multiprocessing.connection">6.2.10. Listeners and Clients</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../16_someos/multiprocessing.html#address-formats">6.2.10.1. Address Formats</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#authentication-keys">6.2.11. Authentication keys</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#logging">6.2.12. Logging</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#module-multiprocessing.dummy">6.2.13. The <code class="docutils literal"><span class="pre">multiprocessing.dummy</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/multiprocessing.html#programming-guidelines">6.3. Programming guidelines</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#all-platforms">6.3.1. All platforms</a></li>
<li class="toctree-l5"><a class="reference internal" href="../16_someos/multiprocessing.html#windows">6.3.2. Windows</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/multiprocessing.html#examples">6.4. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/mmap.html">7. <code class="docutils literal"><span class="pre">mmap</span></code> &#8212; Memory-mapped file support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/readline.html">8. <code class="docutils literal"><span class="pre">readline</span></code> &#8212; GNU readline interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/readline.html#init-file">8.1. Init file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/readline.html#line-buffer">8.2. Line buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/readline.html#history-file">8.3. History file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/readline.html#history-list">8.4. History list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/readline.html#startup-hooks">8.5. Startup hooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/readline.html#completion">8.6. Completion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/readline.html#example">8.7. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../16_someos/rlcompleter.html">9. <code class="docutils literal"><span class="pre">rlcompleter</span></code> &#8212; Completion function for GNU readline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../16_someos/rlcompleter.html#completer-objects">9.1. Completer Objects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../17_ipc/17.html">17 Interprocess Communication and Networking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../17_ipc/subprocess.html">1. <code class="docutils literal"><span class="pre">subprocess</span></code> &#8212; Subprocess management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/subprocess.html#using-the-subprocess-module">1.1. Using the <code class="docutils literal"><span class="pre">subprocess</span></code> Module</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#frequently-used-arguments">1.1.1. Frequently Used Arguments</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#popen-constructor">1.1.2. Popen Constructor</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#exceptions">1.1.3. Exceptions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#security">1.1.4. Security</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/subprocess.html#popen-objects">1.2. Popen Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/subprocess.html#windows-popen-helpers">1.3. Windows Popen Helpers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#constants">1.3.1. Constants</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/subprocess.html#replacing-older-functions-with-the-subprocess-module">1.4. Replacing Older Functions with the <code class="docutils literal"><span class="pre">subprocess</span></code> Module</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#replacing-bin-sh-shell-backquote">1.4.1. Replacing /bin/sh shell backquote</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#replacing-shell-pipeline">1.4.2. Replacing shell pipeline</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#replacing-os-system">1.4.3. Replacing <code class="docutils literal"><span class="pre">os.system()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#replacing-the-os-spawn-family">1.4.4. Replacing the <code class="docutils literal"><span class="pre">os.spawn</span></code> family</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#replacing-os-popen-os-popen2-os-popen3">1.4.5. Replacing <code class="docutils literal"><span class="pre">os.popen()</span></code>, <code class="docutils literal"><span class="pre">os.popen2()</span></code>, <code class="docutils literal"><span class="pre">os.popen3()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#replacing-functions-from-the-popen2-module">1.4.6. Replacing functions from the <code class="docutils literal"><span class="pre">popen2</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/subprocess.html#notes">1.5. Notes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/subprocess.html#converting-an-argument-sequence-to-a-string-on-windows">1.5.1. Converting an argument sequence to a string on Windows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../17_ipc/socket.html">2. <code class="docutils literal"><span class="pre">socket</span></code> &#8212; Low-level networking interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/socket.html#socket-objects">2.1. Socket Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/socket.html#example">2.2. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../17_ipc/ssl.html">3. <code class="docutils literal"><span class="pre">ssl</span></code> &#8212; TLS/SSL wrapper for socket objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/ssl.html#functions-constants-and-exceptions">3.1. Functions, Constants, and Exceptions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#socket-creation">3.1.1. Socket creation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#context-creation">3.1.2. Context creation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#random-generation">3.1.3. Random generation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#certificate-handling">3.1.4. Certificate handling</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#constants">3.1.5. Constants</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/ssl.html#ssl-sockets">3.2. SSL Sockets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/ssl.html#ssl-contexts">3.3. SSL Contexts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/ssl.html#certificates">3.4. Certificates</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#certificate-chains">3.4.1. Certificate chains</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#ca-certificates">3.4.2. CA certificates</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#combined-key-and-certificate">3.4.3. Combined key and certificate</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#self-signed-certificates">3.4.4. Self-signed certificates</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/ssl.html#examples">3.5. Examples</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#testing-for-ssl-support">3.5.1. Testing for SSL support</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#client-side-operation">3.5.2. Client-side operation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#server-side-operation">3.5.3. Server-side operation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/ssl.html#notes-on-non-blocking-sockets">3.6. Notes on non-blocking sockets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/ssl.html#security-considerations">3.7. Security considerations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#best-defaults">3.7.1. Best defaults</a></li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#manual-settings">3.7.2. Manual settings</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../17_ipc/ssl.html#verifying-certificates">3.7.2.1. Verifying certificates</a></li>
<li class="toctree-l6"><a class="reference internal" href="../17_ipc/ssl.html#protocol-versions">3.7.2.2. Protocol versions</a></li>
<li class="toctree-l6"><a class="reference internal" href="../17_ipc/ssl.html#cipher-selection">3.7.2.3. Cipher selection</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../17_ipc/ssl.html#multi-processing">3.7.3. Multi-processing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../17_ipc/signal.html">4. <code class="docutils literal"><span class="pre">signal</span></code> &#8212; Set handlers for asynchronous events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/signal.html#example">4.1. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../17_ipc/popen2.html">5. <code class="docutils literal"><span class="pre">popen2</span></code> &#8212; Subprocesses with accessible I/O streams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/popen2.html#popen3-and-popen4-objects">5.1. Popen3 and Popen4 Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/popen2.html#flow-control-issues">5.2. Flow Control Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../17_ipc/asyncore.html">6. <code class="docutils literal"><span class="pre">asyncore</span></code> &#8212; Asynchronous socket handler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/asyncore.html#asyncore-example-basic-http-client">6.1. asyncore Example basic HTTP client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/asyncore.html#asyncore-example-basic-echo-server">6.2. asyncore Example basic echo server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../17_ipc/asynchat.html">7. <code class="docutils literal"><span class="pre">asynchat</span></code> &#8212; Asynchronous socket command/response handler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/asynchat.html#asynchat-auxiliary-classes">7.1. asynchat - Auxiliary Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../17_ipc/asynchat.html#asynchat-example">7.2. asynchat Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../18_netdata/18.html">18 Internet Data Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/email.html">1. <code class="docutils literal"><span class="pre">email</span></code> &#8212; An email and MIME handling package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/email.html#package-history">1.1. Package History</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/email.html#differences-from-mimelib">1.2. Differences from <code class="docutils literal"><span class="pre">mimelib</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/json.html">2. <code class="docutils literal"><span class="pre">json</span></code> &#8212; JSON encoder and decoder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/json.html#basic-usage">2.1. Basic Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/json.html#encoders-and-decoders">2.2. Encoders and Decoders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/json.html#standard-compliance-and-interoperability">2.3. Standard Compliance and Interoperability</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/json.html#character-encodings">2.3.1. Character Encodings</a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/json.html#infinite-and-nan-number-values">2.3.2. Infinite and NaN Number Values</a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/json.html#repeated-names-within-an-object">2.3.3. Repeated Names Within an Object</a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/json.html#top-level-non-object-non-array-values">2.3.4. Top-level Non-Object, Non-Array Values</a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/json.html#implementation-limitations">2.3.5. Implementation Limitations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/mailcap.html">3. <code class="docutils literal"><span class="pre">mailcap</span></code> &#8212; Mailcap file handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/mailbox.html">4. <code class="docutils literal"><span class="pre">mailbox</span></code> &#8212; Manipulate mailboxes in various formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mailbox.html#mailbox-objects">4.1. <code class="docutils literal"><span class="pre">Mailbox</span></code> objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#maildir">4.1.1. <code class="docutils literal"><span class="pre">Maildir</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#mbox">4.1.2. <code class="docutils literal"><span class="pre">mbox</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#mh">4.1.3. <code class="docutils literal"><span class="pre">MH</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#babyl">4.1.4. <code class="docutils literal"><span class="pre">Babyl</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#mmdf">4.1.5. <code class="docutils literal"><span class="pre">MMDF</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mailbox.html#message-objects">4.2. <code class="docutils literal"><span class="pre">Message</span></code> objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#maildirmessage">4.2.1. <code class="docutils literal"><span class="pre">MaildirMessage</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#mboxmessage">4.2.2. <code class="docutils literal"><span class="pre">mboxMessage</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#mhmessage">4.2.3. <code class="docutils literal"><span class="pre">MHMessage</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#babylmessage">4.2.4. <code class="docutils literal"><span class="pre">BabylMessage</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../18_netdata/mailbox.html#mmdfmessage">4.2.5. <code class="docutils literal"><span class="pre">MMDFMessage</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mailbox.html#exceptions">4.3. Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mailbox.html#deprecated-classes-and-methods">4.4. Deprecated classes and methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mailbox.html#examples">4.5. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/mhlib.html">5. (depr) <code class="docutils literal"><span class="pre">mhlib</span></code> &#8212; Access to MH mailboxes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mhlib.html#mh-objects">5.1. MH Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mhlib.html#folder-objects">5.2. Folder Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mhlib.html#message-objects">5.3. Message Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/mimetools.html">6. (depr) <code class="docutils literal"><span class="pre">mimetools</span></code> &#8212; Tools for parsing MIME messages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mimetools.html#additional-methods-of-message-objects">6.1. Additional Methods of Message Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/mimetypes.html">7. <code class="docutils literal"><span class="pre">mimetypes</span></code> &#8212; Map filenames to MIME types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mimetypes.html#mimetypes-objects">7.1. MimeTypes Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/mimewriter.html">8. (depr) <code class="docutils literal"><span class="pre">MimeWriter</span></code> &#8212; Generic MIME file writer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/mimewriter.html#mimewriter-objects">8.1. MimeWriter Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/mimify.html">9. (depr) <code class="docutils literal"><span class="pre">mimify</span></code> &#8212; MIME processing of mail messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/multifile.html">10. (depr) <code class="docutils literal"><span class="pre">multifile</span></code> &#8212; Support for files containing distinct parts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/multifile.html#multifile-objects">10.1. MultiFile Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/multifile.html#multifile-example">10.2. <code class="docutils literal"><span class="pre">MultiFile</span></code> Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/rfc822.html">11. (depr) <code class="docutils literal"><span class="pre">rfc822</span></code> &#8212; Parse RFC 2822 mail headers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/rfc822.html#message-objects">11.1. Message Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/rfc822.html#addresslist-objects">11.2. AddressList Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/base64.html">12. <code class="docutils literal"><span class="pre">base64</span></code> &#8212; RFC 3548: Base16, Base32, Base64 Data Encodings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/binhex.html">13. <code class="docutils literal"><span class="pre">binhex</span></code> &#8212; Encode and decode binhex4 files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../18_netdata/binhex.html#notes">13.1. Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/binascii.html">14. <code class="docutils literal"><span class="pre">binascii</span></code> &#8212; Convert between binary and ASCII</a></li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/quopri.html">15. <code class="docutils literal"><span class="pre">quopri</span></code> &#8212; Encode and decode MIME quoted-printable data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../18_netdata/uu.html">16. <code class="docutils literal"><span class="pre">uu</span></code> &#8212; Encode and decode uuencode files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../19_markup/19.html">19 Structured Markup Processing Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/htmlparser.html">1. <code class="docutils literal"><span class="pre">HTMLParser</span></code> &#8212; Simple HTML and XHTML parser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/htmlparser.html#example-html-parser-application">1.1. Example HTML Parser Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/htmlparser.html#htmlparser-methods">1.2. <code class="docutils literal"><span class="pre">HTMLParser</span></code> Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/htmlparser.html#examples">1.3. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/sgmllib.html">2. (depr) <code class="docutils literal"><span class="pre">sgmllib</span></code> &#8212; Simple SGML parser</a></li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/htmllib.html">3. (depr) <code class="docutils literal"><span class="pre">htmllib</span></code> &#8212; A parser for HTML documents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/htmllib.html#htmlparser-objects">3.1. HTMLParser Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/htmllib.html#module-htmlentitydefs">4. <code class="docutils literal"><span class="pre">htmlentitydefs</span></code> &#8212; Definitions of HTML general entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.html">5. XML Processing Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.html#xml-vulnerabilities">6. XML vulnerabilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.html#defused-packages">6.1. defused packages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html">7. <code class="docutils literal"><span class="pre">xml.etree.ElementTree</span></code> &#8212; The ElementTree XML API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#tutorial">7.1. Tutorial</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#xml-tree-and-elements">7.1.1. XML tree and elements</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#parsing-xml">7.1.2. Parsing XML</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#finding-interesting-elements">7.1.3. Finding interesting elements</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#modifying-an-xml-file">7.1.4. Modifying an XML File</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#building-xml-documents">7.1.5. Building XML documents</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#parsing-xml-with-namespaces">7.1.6. Parsing XML with Namespaces</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#additional-resources">7.1.7. Additional resources</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#xpath-support">7.2. XPath support</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#example">7.2.1. Example</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#supported-xpath-syntax">7.2.2. Supported XPath syntax</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#reference">7.3. Reference</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#functions">7.3.1. Functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#element-objects">7.3.2. Element Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#elementtree-objects">7.3.3. ElementTree Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#qname-objects">7.3.4. QName Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#treebuilder-objects">7.3.5. TreeBuilder Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.etree.elementtree.html#xmlparser-objects">7.3.6. XMLParser Objects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.dom.html">8. <code class="docutils literal"><span class="pre">xml.dom</span></code> &#8212; The Document Object Model API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.dom.html#module-contents">8.1. Module Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.dom.html#objects-in-the-dom">8.2. Objects in the DOM</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#domimplementation-objects">8.2.1. DOMImplementation Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#node-objects">8.2.2. Node Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#nodelist-objects">8.2.3. NodeList Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#documenttype-objects">8.2.4. DocumentType Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#document-objects">8.2.5. Document Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#element-objects">8.2.6. Element Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#attr-objects">8.2.7. Attr Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#namednodemap-objects">8.2.8. NamedNodeMap Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#comment-objects">8.2.9. Comment Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#text-and-cdatasection-objects">8.2.10. Text and CDATASection Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#processinginstruction-objects">8.2.11. ProcessingInstruction Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#exceptions">8.2.12. Exceptions</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.dom.html#conformance">8.3. Conformance</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#type-mapping">8.3.1. Type Mapping</a></li>
<li class="toctree-l5"><a class="reference internal" href="../19_markup/xml.dom.html#accessor-methods">8.3.2. Accessor Methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.dom.minidom.html">9. <code class="docutils literal"><span class="pre">xml.dom.minidom</span></code> &#8212; Minimal DOM implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.dom.minidom.html#dom-objects">9.1. DOM Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.dom.minidom.html#dom-example">9.2. DOM Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.dom.minidom.html#minidom-and-the-dom-standard">9.3. minidom and the DOM standard</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.dom.pulldom.html">10. <code class="docutils literal"><span class="pre">xml.dom.pulldom</span></code> &#8212; Support for building partial DOM trees</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.dom.pulldom.html#domeventstream-objects">10.1. DOMEventStream Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.sax.html">11. <code class="docutils literal"><span class="pre">xml.sax</span></code> &#8212; Support for SAX2 parsers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.html#saxexception-objects">11.1. SAXException Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.sax.handler.html">12. <code class="docutils literal"><span class="pre">xml.sax.handler</span></code> &#8212; Base classes for SAX handlers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.handler.html#contenthandler-objects">12.1. ContentHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.handler.html#dtdhandler-objects">12.2. DTDHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.handler.html#entityresolver-objects">12.3. EntityResolver Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.handler.html#errorhandler-objects">12.4. ErrorHandler Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.sax.utils.html">13. <code class="docutils literal"><span class="pre">xml.sax.saxutils</span></code> &#8212; SAX Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/xml.sax.reader.html">14. <code class="docutils literal"><span class="pre">xml.sax.xmlreader</span></code> &#8212; Interface for XML parsers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.reader.html#xmlreader-objects">14.1. XMLReader Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.reader.html#incrementalparser-objects">14.2. IncrementalParser Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.reader.html#locator-objects">14.3. Locator Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.reader.html#inputsource-objects">14.4. InputSource Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.reader.html#the-attributes-interface">14.5. The <code class="docutils literal"><span class="pre">Attributes</span></code> Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/xml.sax.reader.html#the-attributesns-interface">14.6. The <code class="docutils literal"><span class="pre">AttributesNS</span></code> Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../19_markup/pyexpat.html">15. <code class="docutils literal"><span class="pre">xml.parsers.expat</span></code> &#8212; Fast XML parsing using Expat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/pyexpat.html#xmlparser-objects">15.1. XMLParser Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/pyexpat.html#expaterror-exceptions">15.2. ExpatError Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/pyexpat.html#example">15.3. Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/pyexpat.html#content-model-descriptions">15.4. Content Model Descriptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../19_markup/pyexpat.html#expat-error-constants">15.5. Expat error constants</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../20_internet/20_part1.html">20a Internet Protocols and Support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/webbrowser.html">1. <code class="docutils literal"><span class="pre">webbrowser</span></code> &#8212; Convenient Web-browser controller</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/webbrowser.html#browser-controller-objects">1.1. Browser Controller Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/cgi.html">2. <code class="docutils literal"><span class="pre">cgi</span></code> &#8212; Common Gateway Interface support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#introduction">2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#using-the-cgi-module">2.2. Using the cgi module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#higher-level-interface">2.3. Higher Level Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#old-classes">2.4. Old classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#functions">2.5. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#caring-about-security">2.6. Caring about security</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#installing-your-cgi-script-on-a-unix-system">2.7. Installing your CGI script on a Unix system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#testing-your-cgi-script">2.8. Testing your CGI script</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#debugging-cgi-scripts">2.9. Debugging CGI scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cgi.html#common-problems-and-solutions">2.10. Common problems and solutions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/cgitb.html">3. <code class="docutils literal"><span class="pre">cgitb</span></code> &#8212; Traceback manager for CGI scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/wsgiref.html">4. <code class="docutils literal"><span class="pre">wsgiref</span></code> &#8212; WSGI Utilities and Reference Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/wsgiref.html#module-wsgiref.util">4.1. <code class="docutils literal"><span class="pre">wsgiref.util</span></code> &#8211; WSGI environment utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/wsgiref.html#module-wsgiref.headers">4.2. <code class="docutils literal"><span class="pre">wsgiref.headers</span></code> &#8211; WSGI response header tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/wsgiref.html#module-wsgiref.simple_server">4.3. <code class="docutils literal"><span class="pre">wsgiref.simple_server</span></code> &#8211; a simple WSGI HTTP server</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/wsgiref.html#module-wsgiref.validate">4.4. <code class="docutils literal"><span class="pre">wsgiref.validate</span></code> &#8212; WSGI conformance checker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/wsgiref.html#module-wsgiref.handlers">4.5. <code class="docutils literal"><span class="pre">wsgiref.handlers</span></code> &#8211; server/gateway base classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/wsgiref.html#examples">4.6. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/urllib.html">5. <code class="docutils literal"><span class="pre">urllib</span></code> &#8212; Open arbitrary resources by URL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib.html#high-level-interface">5.1. High-level interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib.html#utility-functions">5.2. Utility functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib.html#url-opener-objects">5.3. URL Opener objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib.html#urllib-restrictions">5.4. <code class="docutils literal"><span class="pre">urllib</span></code> Restrictions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib.html#examples">5.5. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/urllib2.html">6. <code class="docutils literal"><span class="pre">urllib2</span></code> &#8212; extensible library for opening URLs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#request-objects">6.1. Request Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#openerdirector-objects">6.2. OpenerDirector Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#basehandler-objects">6.3. BaseHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#httpredirecthandler-objects">6.4. HTTPRedirectHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#httpcookieprocessor-objects">6.5. HTTPCookieProcessor Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#proxyhandler-objects">6.6. ProxyHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#httppasswordmgr-objects">6.7. HTTPPasswordMgr Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#abstractbasicauthhandler-objects">6.8. AbstractBasicAuthHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#httpbasicauthhandler-objects">6.9. HTTPBasicAuthHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#proxybasicauthhandler-objects">6.10. ProxyBasicAuthHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#abstractdigestauthhandler-objects">6.11. AbstractDigestAuthHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#httpdigestauthhandler-objects">6.12. HTTPDigestAuthHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#proxydigestauthhandler-objects">6.13. ProxyDigestAuthHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#httphandler-objects">6.14. HTTPHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#httpshandler-objects">6.15. HTTPSHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#filehandler-objects">6.16. FileHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#ftphandler-objects">6.17. FTPHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#cacheftphandler-objects">6.18. CacheFTPHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#unknownhandler-objects">6.19. UnknownHandler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#httperrorprocessor-objects">6.20. HTTPErrorProcessor Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urllib2.html#examples">6.21. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/httplib.html">7. <code class="docutils literal"><span class="pre">httplib</span></code> &#8212; HTTP protocol client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/httplib.html#httpconnection-objects">7.1. HTTPConnection Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/httplib.html#httpresponse-objects">7.2. HTTPResponse Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/httplib.html#examples">7.3. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/ftplib.html">8. <code class="docutils literal"><span class="pre">ftplib</span></code> &#8212; FTP protocol client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/ftplib.html#ftp-objects">8.1. FTP Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/ftplib.html#ftp-tls-objects">8.2. FTP_TLS Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/poplib.html">9. <code class="docutils literal"><span class="pre">poplib</span></code> &#8212; POP3 protocol client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/poplib.html#pop3-objects">9.1. POP3 Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/poplib.html#pop3-example">9.2. POP3 Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/imaplib.html">10. <code class="docutils literal"><span class="pre">imaplib</span></code> &#8212; IMAP4 protocol client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/imaplib.html#imap4-objects">10.1. IMAP4 Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/imaplib.html#imap4-example">10.2. IMAP4 Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/nntplib.html">11. <code class="docutils literal"><span class="pre">nntplib</span></code> &#8212; NNTP protocol client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/nntplib.html#nntp-objects">11.1. NNTP Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/smtplib.html">12. <code class="docutils literal"><span class="pre">smtplib</span></code> &#8212; SMTP protocol client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/smtplib.html#smtp-objects">12.1. SMTP Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/smtplib.html#smtp-example">12.2. SMTP Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/smtpd.html">13. <code class="docutils literal"><span class="pre">smtpd</span></code> &#8212; SMTP Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/smtpd.html#smtpserver-objects">13.1. SMTPServer Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/smtpd.html#debuggingserver-objects">13.2. DebuggingServer Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/smtpd.html#pureproxy-objects">13.3. PureProxy Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/smtpd.html#mailmanproxy-objects">13.4. MailmanProxy Objects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../20_internet/20_part2.html">20b Internet Protocols and Support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/telnetlib.html">1. <code class="docutils literal"><span class="pre">telnetlib</span></code> &#8212; Telnet client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/telnetlib.html#telnet-objects">1.1. Telnet Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/telnetlib.html#telnet-example">1.2. Telnet Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/uuid.html">2. <code class="docutils literal"><span class="pre">uuid</span></code> &#8212; UUID objects according to RFC 4122</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/uuid.html#example">2.1. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/urlparse.html">3. <code class="docutils literal"><span class="pre">urlparse</span></code> &#8212; Parse URLs into components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/urlparse.html#results-of-urlparse-and-urlsplit">3.1. Results of <code class="docutils literal"><span class="pre">urlparse()</span></code> and <code class="docutils literal"><span class="pre">urlsplit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/socketserver.html">4. <code class="docutils literal"><span class="pre">SocketServer</span></code> &#8212; A framework for network servers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/socketserver.html#server-creation-notes">4.1. Server Creation Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/socketserver.html#server-objects">4.2. Server Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/socketserver.html#request-handler-objects">4.3. Request Handler Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/socketserver.html#examples">4.4. Examples</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../20_internet/socketserver.html#socketserver-tcpserver-example">4.4.1. <code class="docutils literal"><span class="pre">SocketServer.TCPServer</span></code> Example</a></li>
<li class="toctree-l5"><a class="reference internal" href="../20_internet/socketserver.html#socketserver-udpserver-example">4.4.2. <code class="docutils literal"><span class="pre">SocketServer.UDPServer</span></code> Example</a></li>
<li class="toctree-l5"><a class="reference internal" href="../20_internet/socketserver.html#asynchronous-mixins">4.4.3. Asynchronous Mixins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/basehttpserver.html">5. <code class="docutils literal"><span class="pre">BaseHTTPServer</span></code> &#8212; Basic HTTP server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/basehttpserver.html#more-examples">5.1. More examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/simplehttpserver.html">6. <code class="docutils literal"><span class="pre">SimpleHTTPServer</span></code> &#8212; Simple HTTP request handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/cgihttpserver.html">7. <code class="docutils literal"><span class="pre">CGIHTTPServer</span></code> &#8212; CGI-capable HTTP request handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/cookielib.html">8. <code class="docutils literal"><span class="pre">cookielib</span></code> &#8212; Cookie handling for HTTP clients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookielib.html#cookiejar-and-filecookiejar-objects">8.1. CookieJar and FileCookieJar Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookielib.html#filecookiejar-subclasses-and-co-operation-with-web-browsers">8.2. FileCookieJar subclasses and co-operation with web browsers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookielib.html#cookiepolicy-objects">8.3. CookiePolicy Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookielib.html#defaultcookiepolicy-objects">8.4. DefaultCookiePolicy Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookielib.html#cookie-objects">8.5. Cookie Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookielib.html#examples">8.6. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/cookie.html">9. <code class="docutils literal"><span class="pre">Cookie</span></code> &#8212; HTTP state management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookie.html#cookie-objects">9.1. Cookie Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookie.html#morsel-objects">9.2. Morsel Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/cookie.html#example">9.3. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/xmlrpclib.html">10. <code class="docutils literal"><span class="pre">xmlrpclib</span></code> &#8212; XML-RPC client access</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#serverproxy-objects">10.1. ServerProxy Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#boolean-objects">10.2. Boolean Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#datetime-objects">10.3. DateTime Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#binary-objects">10.4. Binary Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#fault-objects">10.5. Fault Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#protocolerror-objects">10.6. ProtocolError Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#multicall-objects">10.7. MultiCall Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#convenience-functions">10.8. Convenience Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#example-of-client-usage">10.9. Example of Client Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/xmlrpclib.html#example-of-client-and-server-usage">10.10. Example of Client and Server Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/simplexmlrpcserver.html">11. <code class="docutils literal"><span class="pre">SimpleXMLRPCServer</span></code> &#8212; Basic XML-RPC server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/simplexmlrpcserver.html#simplexmlrpcserver-objects">11.1. SimpleXMLRPCServer Objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../20_internet/simplexmlrpcserver.html#simplexmlrpcserver-example">11.1.1. SimpleXMLRPCServer Example</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/simplexmlrpcserver.html#cgixmlrpcrequesthandler">11.2. CGIXMLRPCRequestHandler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../20_internet/docxmlrpcserver.html">12. <code class="docutils literal"><span class="pre">DocXMLRPCServer</span></code> &#8212; Self-documenting XML-RPC server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/docxmlrpcserver.html#docxmlrpcserver-objects">12.1. DocXMLRPCServer Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../20_internet/docxmlrpcserver.html#doccgixmlrpcrequesthandler">12.2. DocCGIXMLRPCRequestHandler</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../21to25.html">Ch 21 - 25</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../21_multimedia/21.html">21 Multimedia Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/audioop.html">1. <code class="docutils literal"><span class="pre">audioop</span></code> &#8212; Manipulate raw audio data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/imageop.html">2. <code class="docutils literal"><span class="pre">imageop</span></code> &#8212; Manipulate raw image data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/aifc.html">3. <code class="docutils literal"><span class="pre">aifc</span></code> &#8212; Read and write AIFF and AIFC files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/sunau.html">4. <code class="docutils literal"><span class="pre">sunau</span></code> &#8212; Read and write Sun AU files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../21_multimedia/sunau.html#au-read-objects">4.1. AU_read Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../21_multimedia/sunau.html#au-write-objects">4.2. AU_write Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/wave.html">5. <code class="docutils literal"><span class="pre">wave</span></code> &#8212; Read and write WAV files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../21_multimedia/wave.html#wave-read-objects">5.1. Wave_read Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../21_multimedia/wave.html#wave-write-objects">5.2. Wave_write Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/chunk.html">6. <code class="docutils literal"><span class="pre">chunk</span></code> &#8212; Read IFF chunked data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/colorsys.html">7. <code class="docutils literal"><span class="pre">colorsys</span></code> &#8212; Conversions between color systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/imghdr.html">8. <code class="docutils literal"><span class="pre">imghdr</span></code> &#8212; Determine the type of an image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/sndhdr.html">9. <code class="docutils literal"><span class="pre">sndhdr</span></code> &#8212; Determine type of sound file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../21_multimedia/ossaudiodev.html">10. <code class="docutils literal"><span class="pre">ossaudiodev</span></code> &#8212; Access to OSS-compatible audio devices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../21_multimedia/ossaudiodev.html#audio-device-objects">10.1. Audio Device Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../21_multimedia/ossaudiodev.html#mixer-device-objects">10.2. Mixer Device Objects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../22_i18n/22.html">22 Internationalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../22_i18n/gettext.html">1. <code class="docutils literal"><span class="pre">gettext</span></code> &#8212; Multilingual internationalization services</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../22_i18n/gettext.html#gnu-gettext-api">1.1. GNU <strong class="program">gettext</strong> API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../22_i18n/gettext.html#class-based-api">1.2. Class-based API</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#the-nulltranslations-class">1.2.1. The <code class="docutils literal"><span class="pre">NullTranslations</span></code> class</a></li>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#the-gnutranslations-class">1.2.2. The <code class="docutils literal"><span class="pre">GNUTranslations</span></code> class</a></li>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#solaris-message-catalog-support">1.2.3. Solaris message catalog support</a></li>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#the-catalog-constructor">1.2.4. The Catalog constructor</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../22_i18n/gettext.html#internationalizing-your-programs-and-modules">1.3. Internationalizing your programs and modules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#localizing-your-module">1.3.1. Localizing your module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#localizing-your-application">1.3.2. Localizing your application</a></li>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#changing-languages-on-the-fly">1.3.3. Changing languages on the fly</a></li>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#deferred-translations">1.3.4. Deferred translations</a></li>
<li class="toctree-l5"><a class="reference internal" href="../22_i18n/gettext.html#gettext-vs-lgettext">1.3.5. <code class="docutils literal"><span class="pre">gettext()</span></code> vs. <code class="docutils literal"><span class="pre">lgettext()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../22_i18n/gettext.html#acknowledgements">1.4. Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../22_i18n/locale.html">2. <code class="docutils literal"><span class="pre">locale</span></code> &#8212; Internationalization services</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../22_i18n/locale.html#background-details-hints-tips-and-caveats">2.1. Background, details, hints, tips and caveats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../22_i18n/locale.html#for-extension-writers-and-programs-that-embed-python">2.2. For extension writers and programs that embed Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../22_i18n/locale.html#access-to-message-catalogs">2.3. Access to message catalogs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../23_frameworkds/23.html">23 Program Frameworks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../23_frameworkds/cmd.html">1. <code class="docutils literal"><span class="pre">cmd</span></code> &#8212; Support for line-oriented command interpreters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../23_frameworkds/cmd.html#cmd-objects">1.1. Cmd Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../23_frameworkds/shlex.html">2. <code class="docutils literal"><span class="pre">shlex</span></code> &#8212; Simple lexical analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../23_frameworkds/shlex.html#shlex-objects">2.1. shlex Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../23_frameworkds/shlex.html#parsing-rules">2.2. Parsing Rules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../24_tk/24.html">24 Graphical User Interfaces with Tk</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../24_tk/tkinter.html">1. <code class="docutils literal"><span class="pre">Tkinter</span></code> &#8212; Python interface to Tcl/Tk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tkinter.html#tkinter-modules">1.1. Tkinter Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tkinter.html#tkinter-life-preserver">1.2. Tkinter Life Preserver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#how-to-use-this-section">1.2.1. How To Use This Section</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#a-simple-hello-world-program">1.2.2. A Simple Hello World Program</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tkinter.html#a-very-quick-look-at-tcl-tk">1.3. A (Very) Quick Look at Tcl/Tk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tkinter.html#mapping-basic-tk-into-tkinter">1.4. Mapping Basic Tk into Tkinter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tkinter.html#how-tk-and-tkinter-are-related">1.5. How Tk and Tkinter are Related</a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tkinter.html#handy-reference">1.6. Handy Reference</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#setting-options">1.6.1. Setting Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#the-packer">1.6.2. The Packer</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#packer-options">1.6.3. Packer Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#coupling-widget-variables">1.6.4. Coupling Widget Variables</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#the-window-manager">1.6.5. The Window Manager</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#tk-option-data-types">1.6.6. Tk Option Data Types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#bindings-and-events">1.6.7. Bindings and Events</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#the-index-parameter">1.6.8. The index Parameter</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tkinter.html#images">1.6.9. Images</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tkinter.html#file-handlers">1.7. File Handlers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../24_tk/ttk.html">2. <code class="docutils literal"><span class="pre">ttk</span></code> &#8212; Tk themed widgets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#using-ttk">2.1. Using Ttk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#ttk-widgets">2.2. Ttk Widgets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#widget">2.3. Widget</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#standard-options">2.3.1. Standard Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#scrollable-widget-options">2.3.2. Scrollable Widget Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#label-options">2.3.3. Label Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#compatibility-options">2.3.4. Compatibility Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#widget-states">2.3.5. Widget States</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#ttk-widget">2.3.6. ttk.Widget</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#combobox">2.4. Combobox</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#options">2.4.1. Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#virtual-events">2.4.2. Virtual events</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#ttk-combobox">2.4.3. ttk.Combobox</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#notebook">2.5. Notebook</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#id1">2.5.1. Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#tab-options">2.5.2. Tab Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#tab-identifiers">2.5.3. Tab Identifiers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#id2">2.5.4. Virtual Events</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#ttk-notebook">2.5.5. ttk.Notebook</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#progressbar">2.6. Progressbar</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#id3">2.6.1. Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#ttk-progressbar">2.6.2. ttk.Progressbar</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#separator">2.7. Separator</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#id4">2.7.1. Options</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#sizegrip">2.8. Sizegrip</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#platform-specific-notes">2.8.1. Platform-specific notes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#bugs">2.8.2. Bugs</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#treeview">2.9. Treeview</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#id5">2.9.1. Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#item-options">2.9.2. Item Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#tag-options">2.9.3. Tag Options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#column-identifiers">2.9.4. Column Identifiers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#id6">2.9.5. Virtual Events</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#ttk-treeview">2.9.6. ttk.Treeview</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/ttk.html#ttk-styling">2.10. Ttk Styling</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/ttk.html#layouts">2.10.1. Layouts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../24_tk/tix.html">3. <code class="docutils literal"><span class="pre">Tix</span></code> &#8212; Extension widgets for Tk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tix.html#using-tix">3.1. Using Tix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tix.html#tix-widgets">3.2. Tix Widgets</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tix.html#basic-widgets">3.2.1. Basic Widgets</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tix.html#file-selectors">3.2.2. File Selectors</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tix.html#hierarchical-listbox">3.2.3. Hierarchical ListBox</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tix.html#tabular-listbox">3.2.4. Tabular ListBox</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tix.html#manager-widgets">3.2.5. Manager Widgets</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tix.html#image-types">3.2.6. Image Types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tix.html#miscellaneous-widgets">3.2.7. Miscellaneous Widgets</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/tix.html#form-geometry-manager">3.2.8. Form Geometry Manager</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/tix.html#tix-commands">3.3. Tix Commands</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../24_tk/scrolledtext.html">4. <code class="docutils literal"><span class="pre">ScrolledText</span></code> &#8212; Scrolled Text Widget</a></li>
<li class="toctree-l3"><a class="reference internal" href="../24_tk/turtle.html">5. <code class="docutils literal"><span class="pre">turtle</span></code> &#8212; Turtle graphics for Tk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/turtle.html#introduction">5.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/turtle.html#overview-over-available-turtle-and-screen-methods">5.2. Overview over available Turtle and Screen methods</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#turtle-methods">5.2.1. Turtle methods</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#methods-of-turtlescreen-screen">5.2.2. Methods of TurtleScreen/Screen</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/turtle.html#methods-of-rawturtle-turtle-and-corresponding-functions">5.3. Methods of RawTurtle/Turtle and corresponding functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#turtle-motion">5.3.1. Turtle motion</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#tell-turtle-s-state">5.3.2. Tell Turtle&#8217;s state</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#settings-for-measurement">5.3.3. Settings for measurement</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#pen-control">5.3.4. Pen control</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../24_tk/turtle.html#drawing-state">5.3.4.1. Drawing state</a></li>
<li class="toctree-l6"><a class="reference internal" href="../24_tk/turtle.html#color-control">5.3.4.2. Color control</a></li>
<li class="toctree-l6"><a class="reference internal" href="../24_tk/turtle.html#filling">5.3.4.3. Filling</a></li>
<li class="toctree-l6"><a class="reference internal" href="../24_tk/turtle.html#more-drawing-control">5.3.4.4. More drawing control</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#turtle-state">5.3.5. Turtle state</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../24_tk/turtle.html#visibility">5.3.5.1. Visibility</a></li>
<li class="toctree-l6"><a class="reference internal" href="../24_tk/turtle.html#appearance">5.3.5.2. Appearance</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#using-events">5.3.6. Using events</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#special-turtle-methods">5.3.7. Special Turtle methods</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#excursus-about-the-use-of-compound-shapes">5.3.8. Excursus about the use of compound shapes</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/turtle.html#methods-of-turtlescreen-screen-and-corresponding-functions">5.4. Methods of TurtleScreen/Screen and corresponding functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#window-control">5.4.1. Window control</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#animation-control">5.4.2. Animation control</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#using-screen-events">5.4.3. Using screen events</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#settings-and-special-methods">5.4.4. Settings and special methods</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#methods-specific-to-screen-not-inherited-from-turtlescreen">5.4.5. Methods specific to Screen, not inherited from TurtleScreen</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/turtle.html#the-public-classes-of-the-module-turtle">5.5. The public classes of the module <code class="docutils literal"><span class="pre">turtle</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/turtle.html#help-and-configuration">5.6. Help and configuration</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#how-to-use-help">5.6.1. How to use help</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#translation-of-docstrings-into-different-languages">5.6.2. Translation of docstrings into different languages</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/turtle.html#how-to-configure-screen-and-turtles">5.6.3. How to configure Screen and Turtles</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/turtle.html#demo-scripts">5.7. Demo scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../24_tk/idle.html">6. IDLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/idle.html#menus">6.1. Menus</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#file-menu-shell-and-editor">6.1.1. File menu (Shell and Editor)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#edit-menu-shell-and-editor">6.1.2. Edit menu (Shell and Editor)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#format-menu-editor-window-only">6.1.3. Format menu (Editor window only)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#run-menu-editor-window-only">6.1.4. Run menu (Editor window only)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#shell-menu-shell-window-only">6.1.5. Shell menu (Shell window only)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#debug-menu-shell-window-only">6.1.6. Debug menu (Shell window only)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#options-menu-shell-and-editor">6.1.7. Options menu (Shell and Editor)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#window-menu-shell-and-editor">6.1.8. Window menu (Shell and Editor)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#help-menu-shell-and-editor">6.1.9. Help menu (Shell and Editor)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#context-menus">6.1.10. Context Menus</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/idle.html#editing-and-navigation">6.2. Editing and navigation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#automatic-indentation">6.2.1. Automatic indentation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#completions">6.2.2. Completions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#calltips">6.2.3. Calltips</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#python-shell-window">6.2.4. Python Shell window</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#text-colors">6.2.5. Text colors</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/idle.html#startup-and-code-execution">6.3. Startup and code execution</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#command-line-usage">6.3.1. Command line usage</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#idle-console-differences">6.3.2. IDLE-console differences</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#running-without-a-subprocess">6.3.3. Running without a subprocess</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../24_tk/idle.html#help-and-preferences">6.4. Help and preferences</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#additional-help-sources">6.4.1. Additional help sources</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#setting-preferences">6.4.2. Setting preferences</a></li>
<li class="toctree-l5"><a class="reference internal" href="../24_tk/idle.html#extensions">6.4.3. Extensions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../24_tk/othergui.html">7. Other Graphical User Interface Packages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../25_devtools/25.html">25 Development Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../25_devtools/pydoc.html">1. <code class="docutils literal"><span class="pre">pydoc</span></code> &#8212; Documentation generator and online help system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../25_devtools/doctest.html">2. <code class="docutils literal"><span class="pre">doctest</span></code> &#8212; Test interactive Python examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/doctest.html#simple-usage-checking-examples-in-docstrings">2.1. Simple Usage: Checking Examples in Docstrings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/doctest.html#simple-usage-checking-examples-in-a-text-file">2.2. Simple Usage: Checking Examples in a Text File</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/doctest.html#how-it-works">2.3. How It Works</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#which-docstrings-are-examined">2.3.1. Which Docstrings Are Examined?</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#how-are-docstring-examples-recognized">2.3.2. How are Docstring Examples Recognized?</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#what-s-the-execution-context">2.3.3. What&#8217;s the Execution Context?</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#what-about-exceptions">2.3.4. What About Exceptions?</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#option-flags">2.3.5. Option Flags</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#directives">2.3.6. Directives</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#warnings">2.3.7. Warnings</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/doctest.html#basic-api">2.4. Basic API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/doctest.html#unittest-api">2.5. Unittest API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/doctest.html#advanced-api">2.6. Advanced API</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#doctest-objects">2.6.1. DocTest Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#example-objects">2.6.2. Example Objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#doctestfinder-objects">2.6.3. DocTestFinder objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#doctestparser-objects">2.6.4. DocTestParser objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#doctestrunner-objects">2.6.5. DocTestRunner objects</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/doctest.html#outputchecker-objects">2.6.6. OutputChecker objects</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/doctest.html#debugging">2.7. Debugging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/doctest.html#soapbox">2.8. Soapbox</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../25_devtools/unittest.html">3. <code class="docutils literal"><span class="pre">unittest</span></code> &#8212; Unit testing framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#basic-example">3.1. Basic example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#command-line-interface">3.2. Command-Line Interface</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/unittest.html#command-line-options">3.2.1. Command-line options</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#test-discovery">3.3. Test Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#organizing-test-code">3.4. Organizing test code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#re-using-old-test-code">3.5. Re-using old test code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#skipping-tests-and-expected-failures">3.6. Skipping tests and expected failures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#classes-and-functions">3.7. Classes and functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/unittest.html#test-cases">3.7.1. Test cases</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../25_devtools/unittest.html#deprecated-aliases">3.7.1.1. Deprecated aliases</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/unittest.html#grouping-tests">3.7.2. Grouping tests</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/unittest.html#loading-and-running-tests">3.7.3. Loading and running tests</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../25_devtools/unittest.html#load-tests-protocol">3.7.3.1. load_tests Protocol</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#class-and-module-fixtures">3.8. Class and Module Fixtures</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/unittest.html#setupclass-and-teardownclass">3.8.1. setUpClass and tearDownClass</a></li>
<li class="toctree-l5"><a class="reference internal" href="../25_devtools/unittest.html#setupmodule-and-teardownmodule">3.8.2. setUpModule and tearDownModule</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/unittest.html#signal-handling">3.9. Signal Handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../25_devtools/2to3.html">4. 2to3 - Automated Python 2 to 3 code translation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/2to3.html#using-2to3">4.1. Using 2to3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/2to3.html#fixers">4.2. Fixers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/2to3.html#module-lib2to3">4.3. <code class="docutils literal"><span class="pre">lib2to3</span></code> - 2to3&#8217;s library</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../25_devtools/test.html">5. <code class="docutils literal"><span class="pre">test</span></code> &#8212; Regression tests package for Python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/test.html#writing-unit-tests-for-the-test-package">5.1. Writing Unit Tests for the <code class="docutils literal"><span class="pre">test</span></code> package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../25_devtools/test.html#running-tests-using-the-command-line-interface">5.2. Running tests using the command-line interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../25_devtools/test.html#module-test.test_support">6. <code class="docutils literal"><span class="pre">test.test_support</span></code> &#8212; Utility functions for tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../26to30.html">Ch 26 - 30</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../26_debugging_and_profiling/26.html">26. Debugging and Profiling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../26_debugging_and_profiling/26.1_bdb.html">1. <code class="docutils literal"><span class="pre">bdb</span></code> &#8212; Debugger framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../26_debugging_and_profiling/26.23_pdb.html">2. <code class="docutils literal"><span class="pre">pdb</span></code> &#8212; The Python Debugger</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.23_pdb.html#debugger-commands">2.1. Debugger Commands</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html">3. <code class="docutils literal"><span class="pre">cProfile</span></code>, <code class="docutils literal"><span class="pre">profile</span></code> &#8212; The Python Profilers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html#introduction-to-the-profilers">3.1. Introduction to the profilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html#instant-user-s-manual">3.2. Instant User&#8217;s Manual</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html#module-cProfile">3.3. <code class="docutils literal"><span class="pre">profile</span></code> and <code class="docutils literal"><span class="pre">cProfile</span></code> Module Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html#the-stats-class">3.4. The <code class="docutils literal"><span class="pre">Stats</span></code> Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html#what-is-deterministic-profiling">3.5. What Is Deterministic Profiling?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html#limitations">3.6. Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html#calibration">3.7. Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.4.python_profiler.html#using-a-custom-timer">3.8. Using a custom timer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../26_debugging_and_profiling/26.5_hotshot.html">4. <code class="docutils literal"><span class="pre">hotshot</span></code> &#8212; High performance logging profiler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.5_hotshot.html#profile-objects">4.1. Profile Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.5_hotshot.html#module-hotshot.stats">4.2. Using hotshot data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.5_hotshot.html#example-usage">4.3. Example Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../26_debugging_and_profiling/26.6_timeit.html">5. <code class="docutils literal"><span class="pre">timeit</span></code> &#8212; Measure execution time of small code snippets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.6_timeit.html#basic-examples">5.1. Basic Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.6_timeit.html#python-interface">5.2. Python Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.6_timeit.html#command-line-interface">5.3. Command-Line Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.6_timeit.html#examples">5.4. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../26_debugging_and_profiling/26.7_trace.html">6. <code class="docutils literal"><span class="pre">trace</span></code> &#8212; Trace or track Python statement execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.7_trace.html#command-line-usage">6.1. Command-Line Usage</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../26_debugging_and_profiling/26.7_trace.html#main-options">6.1.1. Main options</a></li>
<li class="toctree-l5"><a class="reference internal" href="../26_debugging_and_profiling/26.7_trace.html#modifiers">6.1.2. Modifiers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../26_debugging_and_profiling/26.7_trace.html#filters">6.1.3. Filters</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../26_debugging_and_profiling/26.7_trace.html#programmatic-interface">6.2. Programmatic Interface</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../27_distribution/27.html">27 Software Packaging and Distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../27_distribution/distutils.html">1. <code class="docutils literal"><span class="pre">distutils</span></code> &#8212; Building and installing Python modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../27_distribution/ensurepip.html">2. <code class="docutils literal"><span class="pre">ensurepip</span></code> &#8212; Bootstrapping the <code class="docutils literal"><span class="pre">pip</span></code> installer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../27_distribution/ensurepip.html#command-line-interface">2.1. Command line interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../27_distribution/ensurepip.html#module-api">2.2. Module API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../28_runtime_service/28.html">28 Python Runtime Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/sys.html">1. <code class="docutils literal"><span class="pre">sys</span></code> &#8212; System-specific parameters and functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/sysconfig.html">2. <code class="docutils literal"><span class="pre">sysconfig</span></code> &#8212; Provide access to Python&#8217;s configuration information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/sysconfig.html#configuration-variables">2.1. Configuration variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/sysconfig.html#installation-paths">2.2. Installation paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/sysconfig.html#other-functions">2.3. Other functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/__builtin__.html">3. <code class="docutils literal"><span class="pre">__builtin__</span></code> &#8212; Built-in objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/future_builtins.html">4. <code class="docutils literal"><span class="pre">future_builtins</span></code> &#8212; Python 3 builtins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/__main__.html">5. <code class="docutils literal"><span class="pre">__main__</span></code> &#8212; Top-level script environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/warnings.html">6. <code class="docutils literal"><span class="pre">warnings</span></code> &#8212; Warning control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/warnings.html#warning-categories">6.1. Warning Categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/warnings.html#the-warnings-filter">6.2. The Warnings Filter</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../28_runtime_service/warnings.html#default-warning-filters">6.2.1. Default Warning Filters</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/warnings.html#temporarily-suppressing-warnings">6.3. Temporarily Suppressing Warnings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/warnings.html#testing-warnings">6.4. Testing Warnings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/warnings.html#updating-code-for-new-versions-of-python">6.5. Updating Code For New Versions of Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/warnings.html#available-functions">6.6. Available Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/warnings.html#available-context-managers">6.7. Available Context Managers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/contextlib.html">7. <code class="docutils literal"><span class="pre">contextlib</span></code> &#8212; Utilities for <code class="docutils literal"><span class="pre">with</span></code>-statement contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/abc.html">8. <code class="docutils literal"><span class="pre">abc</span></code> &#8212; Abstract Base Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/atexit.html">9. <code class="docutils literal"><span class="pre">atexit</span></code> &#8212; Exit handlers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/atexit.html#atexit-example">9.1. <code class="docutils literal"><span class="pre">atexit</span></code> Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/traceback.html">10. <code class="docutils literal"><span class="pre">traceback</span></code> &#8212; Print or retrieve a stack traceback</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/traceback.html#traceback-examples">10.1. Traceback Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/__future__.html">11. <code class="docutils literal"><span class="pre">__future__</span></code> &#8212; Future statement definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/gc.html">12. <code class="docutils literal"><span class="pre">gc</span></code> &#8212; Garbage Collector interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/inspect.html">13. <code class="docutils literal"><span class="pre">inspect</span></code> &#8212; Inspect live objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/inspect.html#types-and-members">13.1. Types and members</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/inspect.html#retrieving-source-code">13.2. Retrieving source code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/inspect.html#classes-and-functions">13.3. Classes and functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/inspect.html#the-interpreter-stack">13.4. The interpreter stack</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/site.html">14. <code class="docutils literal"><span class="pre">site</span></code> &#8212; Site-specific configuration hook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/user.html">15. <code class="docutils literal"><span class="pre">user</span></code> &#8212; User-specific configuration hook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../28_runtime_service/fpectl.html">16. <code class="docutils literal"><span class="pre">fpectl</span></code> &#8212; Floating point exception control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/fpectl.html#example">16.1. Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../28_runtime_service/fpectl.html#limitations-and-other-considerations">16.2. Limitations and other considerations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../29_custom_interpreter/29.html">29 Custom Python Interpreters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../29_custom_interpreter/code.html">1. <code class="docutils literal"><span class="pre">code</span></code> &#8212; Interpreter base classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../29_custom_interpreter/code.html#interactive-interpreter-objects">1.1. Interactive Interpreter Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../29_custom_interpreter/code.html#interactive-console-objects">1.2. Interactive Console Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../29_custom_interpreter/codeop.html">2. <code class="docutils literal"><span class="pre">codeop</span></code> &#8212; Compile Python code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../30_restricted_exec/30.html">30 Restricted Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../30_restricted_exec/rexec.html">1. <code class="docutils literal"><span class="pre">rexec</span></code> &#8212; Restricted execution framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../30_restricted_exec/rexec.html#rexec-objects">1.1. RExec Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../30_restricted_exec/rexec.html#defining-restricted-environments">1.2. Defining restricted environments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../30_restricted_exec/rexec.html#an-example">1.3. An example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../30_restricted_exec/bastion.html">2. <code class="docutils literal"><span class="pre">Bastion</span></code> &#8212; Restricting access to objects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../31to37.html">Ch 31 - 37</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../31_modules/31.html">31 Importing Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../31_modules/imp.html">1. <code class="docutils literal"><span class="pre">imp</span></code> &#8212; Access the <code class="docutils literal"><span class="pre">import</span></code> internals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../31_modules/imp.html#examples">1.1. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../31_modules/importlib.html">2. <code class="docutils literal"><span class="pre">importlib</span></code> &#8211; Convenience wrappers for <code class="docutils literal"><span class="pre">__import__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../31_modules/imputil.html">3. (depr) <code class="docutils literal"><span class="pre">imputil</span></code> &#8212; Import utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../31_modules/imputil.html#examples">3.1. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../31_modules/zipimport.html">4. <code class="docutils literal"><span class="pre">zipimport</span></code> &#8212; Import modules from Zip archives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../31_modules/zipimport.html#zipimporter-objects">4.1. zipimporter Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../31_modules/zipimport.html#examples">4.2. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../31_modules/pkgutil.html">5. <code class="docutils literal"><span class="pre">pkgutil</span></code> &#8212; Package extension utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../31_modules/modulefinder.html">6. <code class="docutils literal"><span class="pre">modulefinder</span></code> &#8212; Find modules used by a script</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../31_modules/modulefinder.html#example-usage-of-modulefinder">6.1. Example usage of <code class="docutils literal"><span class="pre">ModuleFinder</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../31_modules/runpy.html">7. <code class="docutils literal"><span class="pre">runpy</span></code> &#8212; Locating and executing Python modules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../32_python_lang_serv/32.html">32 Python Language Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/parser.html">1. <code class="docutils literal"><span class="pre">parser</span></code> &#8212; Access Python parse trees</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/parser.html#creating-st-objects">1.1. Creating ST Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/parser.html#converting-st-objects">1.2. Converting ST Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/parser.html#queries-on-st-objects">1.3. Queries on ST Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/parser.html#exceptions-and-error-handling">1.4. Exceptions and Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/parser.html#st-objects">1.5. ST Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/parser.html#example-emulation-of-compile">1.6. Example: Emulation of <code class="docutils literal"><span class="pre">compile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/ast.html">2. <code class="docutils literal"><span class="pre">ast</span></code> &#8212; Abstract Syntax Trees</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/ast.html#node-classes">2.1. Node classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/ast.html#abstract-grammar">2.2. Abstract Grammar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/ast.html#ast-helpers">2.3. <code class="docutils literal"><span class="pre">ast</span></code> Helpers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/symtable.html">3. <code class="docutils literal"><span class="pre">symtable</span></code> &#8212; Access to the compiler&#8217;s symbol tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/symtable.html#generating-symbol-tables">3.1. Generating Symbol Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/symtable.html#examining-symbol-tables">3.2. Examining Symbol Tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/symbol.html">4. <code class="docutils literal"><span class="pre">symbol</span></code> &#8212; Constants used with Python parse trees</a></li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/token.html">5. <code class="docutils literal"><span class="pre">token</span></code> &#8212; Constants used with Python parse trees</a></li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/keyword.html">6. <code class="docutils literal"><span class="pre">keyword</span></code> &#8212; Testing for Python keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/tokenize.html">7. <code class="docutils literal"><span class="pre">tokenize</span></code> &#8212; Tokenizer for Python source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/tabnanny.html">8. <code class="docutils literal"><span class="pre">tabnanny</span></code> &#8212; Detection of ambiguous indentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/pyclbr.html">9. <code class="docutils literal"><span class="pre">pyclbr</span></code> &#8212; Python class browser support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/pyclbr.html#class-objects">9.1. Class Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/pyclbr.html#function-objects">9.2. Function Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/py_compile.html">10. <code class="docutils literal"><span class="pre">py_compile</span></code> &#8212; Compile Python source files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/compileall.html">11. <code class="docutils literal"><span class="pre">compileall</span></code> &#8212; Byte-compile Python libraries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/compileall.html#command-line-use">11.1. Command-line use</a></li>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/compileall.html#public-functions">11.2. Public functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/dis.html">12. <code class="docutils literal"><span class="pre">dis</span></code> &#8212; Disassembler for Python bytecode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../32_python_lang_serv/dis.html#python-bytecode-instructions">12.1. Python Bytecode Instructions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../32_python_lang_serv/pickletools.html">13. <code class="docutils literal"><span class="pre">pickletools</span></code> &#8212; Tools for pickle developers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../33_compiler/33.html">33 (depr) Python compiler package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../33_compiler/33.html#module-compiler">The basic interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../33_compiler/33.html#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../33_compiler/33.html#python-abstract-syntax">Python Abstract Syntax</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../33_compiler/33.html#module-compiler.ast">AST Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../33_compiler/33.html#assignment-nodes">Assignment nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../33_compiler/33.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../33_compiler/33.html#module-compiler.visitor">Using Visitors to Walk ASTs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../33_compiler/33.html#bytecode-generation">Bytecode Generation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../34_formatter/34.html">34. Miscellaneous Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../34_formatter/34.1.formatter.html">1. <code class="docutils literal"><span class="pre">formatter</span></code> &#8212; Generic output formatting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../34_formatter/34.1.formatter.html#the-formatter-interface">1.1. The Formatter Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../34_formatter/34.1.formatter.html#formatter-implementations">1.2. Formatter Implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../34_formatter/34.1.formatter.html#the-writer-interface">1.3. The Writer Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../34_formatter/34.1.formatter.html#writer-implementations">1.4. Writer Implementations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../35_windows_service/35.html">35 MS Windows Specific Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../35_windows_service/msilib.html">1. <code class="docutils literal"><span class="pre">msilib</span></code> &#8212; Read and write Microsoft Installer files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#database-objects">1.1. Database Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#view-objects">1.2. View Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#summary-information-objects">1.3. Summary Information Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#record-objects">1.4. Record Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#errors">1.5. Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#cab-objects">1.6. CAB Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#directory-objects">1.7. Directory Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#features">1.8. Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#gui-classes">1.9. GUI classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msilib.html#precomputed-tables">1.10. Precomputed tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../35_windows_service/msvcrt.html">2. <code class="docutils literal"><span class="pre">msvcrt</span></code> &#8211; Useful routines from the MS VC++ runtime</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msvcrt.html#file-operations">2.1. File Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msvcrt.html#console-i-o">2.2. Console I/O</a></li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/msvcrt.html#other-functions">2.3. Other Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../35_windows_service/_winreg.html">3. <code class="docutils literal"><span class="pre">_winreg</span></code> &#8211; Windows registry access</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/_winreg.html#constants">3.1. Constants</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../35_windows_service/_winreg.html#hkey-constants">3.1.1. HKEY_* Constants</a></li>
<li class="toctree-l5"><a class="reference internal" href="../35_windows_service/_winreg.html#access-rights">3.1.2. Access Rights</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../35_windows_service/_winreg.html#bit-specific">3.1.2.1. 64-bit Specific</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../35_windows_service/_winreg.html#value-types">3.1.3. Value Types</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../35_windows_service/_winreg.html#registry-handle-objects">3.2. Registry Handle Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../35_windows_service/winsound.html">4. <code class="docutils literal"><span class="pre">winsound</span></code> &#8212; Sound-playing interface for Windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../36_unix_specific_services/36.html">36. Unix Specific Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.1.posix.html">1. <code class="docutils literal"><span class="pre">posix</span></code> &#8212; The most common POSIX system calls</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../36_unix_specific_services/36.1.posix.html#large-file-support">1.1. Large File Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../36_unix_specific_services/36.1.posix.html#notable-module-contents">1.2. Notable Module Contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.2.pwd.html">2. <code class="docutils literal"><span class="pre">pwd</span></code> &#8212; The password database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.3.spwd.html">3. <code class="docutils literal"><span class="pre">spwd</span></code> &#8212; The shadow password database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.4.grp.html">4. <code class="docutils literal"><span class="pre">grp</span></code> &#8212; The group database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.5.crypt.html">5. <code class="docutils literal"><span class="pre">crypt</span></code> &#8212; Function to check Unix passwords</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.6.dl.html">6. (deprecated) <code class="docutils literal"><span class="pre">dl</span></code> &#8212; Call C functions in shared objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../36_unix_specific_services/36.6.dl.html#dl-objects">6.1. Dl Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.7.termios.html">7. <code class="docutils literal"><span class="pre">termios</span></code> &#8212; POSIX style tty control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../36_unix_specific_services/36.7.termios.html#example">7.1. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.8.tty.html">8. <code class="docutils literal"><span class="pre">tty</span></code> &#8212; Terminal control functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.9.pty.html">9. <code class="docutils literal"><span class="pre">pty</span></code> &#8212; Pseudo-terminal utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.10.fcntl.html">10. <code class="docutils literal"><span class="pre">fcntl</span></code> &#8212; The <code class="docutils literal"><span class="pre">fcntl</span></code> and <code class="docutils literal"><span class="pre">ioctl</span></code> system calls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.11.pipes.html">11. <code class="docutils literal"><span class="pre">pipes</span></code> &#8212; Interface to shell pipelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../36_unix_specific_services/36.11.pipes.html#template-objects">11.1. Template Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.12.posixfile.html">12. <code class="docutils literal"><span class="pre">posixfile</span></code> &#8212; File-like objects with locking support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.13.resource.html">13. <code class="docutils literal"><span class="pre">resource</span></code> &#8212; Resource usage information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../36_unix_specific_services/36.13.resource.html#resource-limits">13.1. Resource Limits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../36_unix_specific_services/36.13.resource.html#resource-usage">13.2. Resource Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.14.nis.html">14. <code class="docutils literal"><span class="pre">nis</span></code> &#8212; Interface to Sun&#8217;s NIS (Yellow Pages)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.15.syslog.html">15. <code class="docutils literal"><span class="pre">syslog</span></code> &#8212; Unix syslog library routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../36_unix_specific_services/36.15.syslog.html#examples">15.1. Examples</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../36_unix_specific_services/36.15.syslog.html#simple-example">15.1.1. Simple example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../36_unix_specific_services/36.16.commands.html">16. (deprecated) <code class="docutils literal"><span class="pre">commands</span></code> &#8212; Utilities for running commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../37_mac_services/37.html">37 Mac OS X specific services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/ic.html">1. <code class="docutils literal"><span class="pre">ic</span></code> &#8212; Access to the Mac OS X Internet Config</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/ic.html#ic-objects">1.1. IC Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/macos.html">2. <code class="docutils literal"><span class="pre">MacOS</span></code> &#8212; Access to Mac OS interpreter features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/macostools.html">3. <code class="docutils literal"><span class="pre">macostools</span></code> &#8212; Convenience routines for file manipulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/macostools.html#module-findertools">4. <code class="docutils literal"><span class="pre">findertools</span></code> &#8212; The <strong class="program">finder</strong>&#8216;s Apple Events interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/easydialogs.html">5. <code class="docutils literal"><span class="pre">EasyDialogs</span></code> &#8212; Basic Macintosh dialogs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/easydialogs.html#progressbar-objects">5.1. ProgressBar Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/framework.html">6. <code class="docutils literal"><span class="pre">FrameWork</span></code> &#8212; Interactive application framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/framework.html#application-objects">6.1. Application Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/framework.html#window-objects">6.2. Window Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/framework.html#controlswindow-object">6.3. ControlsWindow Object</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/framework.html#scrolledwindow-object">6.4. ScrolledWindow Object</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/framework.html#dialogwindow-objects">6.5. DialogWindow Objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/autogil.html">7. <code class="docutils literal"><span class="pre">autoGIL</span></code> &#8212; Global Interpreter Lock handling in event loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/carbon.html">8. Mac OS Toolbox Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.AE">8.1. <code class="docutils literal"><span class="pre">Carbon.AE</span></code> &#8212; Apple Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.AH">8.2. <code class="docutils literal"><span class="pre">Carbon.AH</span></code> &#8212; Apple Help</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.App">8.3. <code class="docutils literal"><span class="pre">Carbon.App</span></code> &#8212; Appearance Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Appearance">8.4. <code class="docutils literal"><span class="pre">Carbon.Appearance</span></code> &#8212; Appearance Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.CF">8.5. <code class="docutils literal"><span class="pre">Carbon.CF</span></code> &#8212; Core Foundation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.CG">8.6. <code class="docutils literal"><span class="pre">Carbon.CG</span></code> &#8212; Core Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.CarbonEvt">8.7. <code class="docutils literal"><span class="pre">Carbon.CarbonEvt</span></code> &#8212; Carbon Event Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.CarbonEvents">8.8. <code class="docutils literal"><span class="pre">Carbon.CarbonEvents</span></code> &#8212; Carbon Event Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Cm">8.9. <code class="docutils literal"><span class="pre">Carbon.Cm</span></code> &#8212; Component Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Components">8.10. <code class="docutils literal"><span class="pre">Carbon.Components</span></code> &#8212; Component Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.ControlAccessor">8.11. <code class="docutils literal"><span class="pre">Carbon.ControlAccessor</span></code> &#8212; Control Manager accssors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Controls">8.12. <code class="docutils literal"><span class="pre">Carbon.Controls</span></code> &#8212; Control Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.CoreFounation">8.13. <code class="docutils literal"><span class="pre">Carbon.CoreFounation</span></code> &#8212; CoreFounation constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.CoreGraphics">8.14. <code class="docutils literal"><span class="pre">Carbon.CoreGraphics</span></code> &#8212; CoreGraphics constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Ctl">8.15. <code class="docutils literal"><span class="pre">Carbon.Ctl</span></code> &#8212; Control Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Dialogs">8.16. <code class="docutils literal"><span class="pre">Carbon.Dialogs</span></code> &#8212; Dialog Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Dlg">8.17. <code class="docutils literal"><span class="pre">Carbon.Dlg</span></code> &#8212; Dialog Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Drag">8.18. <code class="docutils literal"><span class="pre">Carbon.Drag</span></code> &#8212; Drag and Drop Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Dragconst">8.19. <code class="docutils literal"><span class="pre">Carbon.Dragconst</span></code> &#8212; Drag and Drop Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Events">8.20. <code class="docutils literal"><span class="pre">Carbon.Events</span></code> &#8212; Event Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Evt">8.21. <code class="docutils literal"><span class="pre">Carbon.Evt</span></code> &#8212; Event Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.File">8.22. <code class="docutils literal"><span class="pre">Carbon.File</span></code> &#8212; File Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Files">8.23. <code class="docutils literal"><span class="pre">Carbon.Files</span></code> &#8212; File Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Fm">8.24. <code class="docutils literal"><span class="pre">Carbon.Fm</span></code> &#8212; Font Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Folder">8.25. <code class="docutils literal"><span class="pre">Carbon.Folder</span></code> &#8212; Folder Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Folders">8.26. <code class="docutils literal"><span class="pre">Carbon.Folders</span></code> &#8212; Folder Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Fonts">8.27. <code class="docutils literal"><span class="pre">Carbon.Fonts</span></code> &#8212; Font Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Help">8.28. <code class="docutils literal"><span class="pre">Carbon.Help</span></code> &#8212; Help Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.IBCarbon">8.29. <code class="docutils literal"><span class="pre">Carbon.IBCarbon</span></code> &#8212; Carbon InterfaceBuilder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.IBCarbonRuntime">8.30. <code class="docutils literal"><span class="pre">Carbon.IBCarbonRuntime</span></code> &#8212; Carbon InterfaceBuilder constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Icns">8.31. <code class="docutils literal"><span class="pre">Carbon.Icn</span></code> &#8212; Carbon Icon Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Icons">8.32. <code class="docutils literal"><span class="pre">Carbon.Icons</span></code> &#8212; Carbon Icon Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Launch">8.33. <code class="docutils literal"><span class="pre">Carbon.Launch</span></code> &#8212; Carbon Launch Services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.LaunchServices">8.34. <code class="docutils literal"><span class="pre">Carbon.LaunchServices</span></code> &#8212; Carbon Launch Services constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.List">8.35. <code class="docutils literal"><span class="pre">Carbon.List</span></code> &#8212; List Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Lists">8.36. <code class="docutils literal"><span class="pre">Carbon.Lists</span></code> &#8212; List Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.MacHelp">8.37. <code class="docutils literal"><span class="pre">Carbon.MacHelp</span></code> &#8212; Help Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.MediaDescr">8.38. <code class="docutils literal"><span class="pre">Carbon.MediaDescr</span></code> &#8212; Parsers and generators for Quicktime Media descriptors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Menu">8.39. <code class="docutils literal"><span class="pre">Carbon.Menu</span></code> &#8212; Menu Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Menus">8.40. <code class="docutils literal"><span class="pre">Carbon.Menus</span></code> &#8212; Menu Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Mlte">8.41. <code class="docutils literal"><span class="pre">Carbon.Mlte</span></code> &#8212; MultiLingual Text Editor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.OSA">8.42. <code class="docutils literal"><span class="pre">Carbon.OSA</span></code> &#8212; Carbon OSA Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.OSAconst">8.43. <code class="docutils literal"><span class="pre">Carbon.OSAconst</span></code> &#8212; Carbon OSA Interface constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.QDOffscreen">8.44. <code class="docutils literal"><span class="pre">Carbon.QDOffscreen</span></code> &#8212; QuickDraw Offscreen constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Qd">8.45. <code class="docutils literal"><span class="pre">Carbon.Qd</span></code> &#8212; QuickDraw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Qdoffs">8.46. <code class="docutils literal"><span class="pre">Carbon.Qdoffs</span></code> &#8212; QuickDraw Offscreen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Qt">8.47. <code class="docutils literal"><span class="pre">Carbon.Qt</span></code> &#8212; QuickTime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.QuickDraw">8.48. <code class="docutils literal"><span class="pre">Carbon.QuickDraw</span></code> &#8212; QuickDraw constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.QuickTime">8.49. <code class="docutils literal"><span class="pre">Carbon.QuickTime</span></code> &#8212; QuickTime constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Res">8.50. <code class="docutils literal"><span class="pre">Carbon.Res</span></code> &#8212; Resource Manager and Handles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Resources">8.51. <code class="docutils literal"><span class="pre">Carbon.Resources</span></code> &#8212; Resource Manager and Handles constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Scrap">8.52. <code class="docutils literal"><span class="pre">Carbon.Scrap</span></code> &#8212; Scrap Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Snd">8.53. <code class="docutils literal"><span class="pre">Carbon.Snd</span></code> &#8212; Sound Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Sound">8.54. <code class="docutils literal"><span class="pre">Carbon.Sound</span></code> &#8212; Sound Manager constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.TE">8.55. <code class="docutils literal"><span class="pre">Carbon.TE</span></code> &#8212; TextEdit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.TextEdit">8.56. <code class="docutils literal"><span class="pre">Carbon.TextEdit</span></code> &#8212; TextEdit constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Win">8.57. <code class="docutils literal"><span class="pre">Carbon.Win</span></code> &#8212; Window Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../37_mac_services/carbon.html#module-Carbon.Windows">8.58. <code class="docutils literal"><span class="pre">Carbon.Windows</span></code> &#8212; Window Manager constants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../37_mac_services/colorpicker.html">9. <code class="docutils literal"><span class="pre">ColorPicker</span></code> &#8212; Color selection dialog</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python Standard Library Doc</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>decimal</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for decimal</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) 2004 Python Software Foundation.</span>
<span class="c1"># All rights reserved.</span>

<span class="c1"># Written by Eric Price &lt;eprice at tjhsst.edu&gt;</span>
<span class="c1">#    and Facundo Batista &lt;facundo at taniquetil.com.ar&gt;</span>
<span class="c1">#    and Raymond Hettinger &lt;python at rcn.com&gt;</span>
<span class="c1">#    and Aahz &lt;aahz at pobox.com&gt;</span>
<span class="c1">#    and Tim Peters</span>

<span class="c1"># This module is currently Py2.3 compatible and should be kept that way</span>
<span class="c1"># unless a major compelling advantage arises.  IOW, 2.3 compatibility is</span>
<span class="c1"># strongly preferred, but not guaranteed.</span>

<span class="c1"># Also, this module should be kept in sync with the latest updates of</span>
<span class="c1"># the IBM specification as it evolves.  Those updates will be treated</span>
<span class="c1"># as bug fixes (deviation from the spec is a compatibility, usability</span>
<span class="c1"># bug) and will be backported.  At this point the spec is stabilizing</span>
<span class="c1"># and the updates are becoming fewer, smaller, and less significant.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This is a Py2.3 implementation of decimal floating point arithmetic based on</span>
<span class="sd">the General Decimal Arithmetic Specification:</span>

<span class="sd">    http://speleotrove.com/decimal/decarith.html</span>

<span class="sd">and IEEE standard 854-1987:</span>

<span class="sd">    http://en.wikipedia.org/wiki/IEEE_854-1987</span>

<span class="sd">Decimal floating point has finite precision with arbitrarily large bounds.</span>

<span class="sd">The purpose of this module is to support arithmetic using familiar</span>
<span class="sd">&quot;schoolhouse&quot; rules and to avoid some of the tricky representation</span>
<span class="sd">issues associated with binary floating point.  The package is especially</span>
<span class="sd">useful for financial applications or for contexts where users have</span>
<span class="sd">expectations that are at odds with binary floating point (for instance,</span>
<span class="sd">in binary floating point, 1.00 % 0.1 gives 0.09999999999999995 instead</span>
<span class="sd">of the expected Decimal(&#39;0.00&#39;) returned by decimal floating point).</span>

<span class="sd">Here are some examples of using the decimal module:</span>

<span class="sd">&gt;&gt;&gt; from decimal import *</span>
<span class="sd">&gt;&gt;&gt; setcontext(ExtendedContext)</span>
<span class="sd">&gt;&gt;&gt; Decimal(0)</span>
<span class="sd">Decimal(&#39;0&#39;)</span>
<span class="sd">&gt;&gt;&gt; Decimal(&#39;1&#39;)</span>
<span class="sd">Decimal(&#39;1&#39;)</span>
<span class="sd">&gt;&gt;&gt; Decimal(&#39;-.0123&#39;)</span>
<span class="sd">Decimal(&#39;-0.0123&#39;)</span>
<span class="sd">&gt;&gt;&gt; Decimal(123456)</span>
<span class="sd">Decimal(&#39;123456&#39;)</span>
<span class="sd">&gt;&gt;&gt; Decimal(&#39;123.45e12345678901234567890&#39;)</span>
<span class="sd">Decimal(&#39;1.2345E+12345678901234567892&#39;)</span>
<span class="sd">&gt;&gt;&gt; Decimal(&#39;1.33&#39;) + Decimal(&#39;1.27&#39;)</span>
<span class="sd">Decimal(&#39;2.60&#39;)</span>
<span class="sd">&gt;&gt;&gt; Decimal(&#39;12.34&#39;) + Decimal(&#39;3.87&#39;) - Decimal(&#39;18.41&#39;)</span>
<span class="sd">Decimal(&#39;-2.20&#39;)</span>
<span class="sd">&gt;&gt;&gt; dig = Decimal(1)</span>
<span class="sd">&gt;&gt;&gt; print dig / Decimal(3)</span>
<span class="sd">0.333333333</span>
<span class="sd">&gt;&gt;&gt; getcontext().prec = 18</span>
<span class="sd">&gt;&gt;&gt; print dig / Decimal(3)</span>
<span class="sd">0.333333333333333333</span>
<span class="sd">&gt;&gt;&gt; print dig.sqrt()</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt; print Decimal(3).sqrt()</span>
<span class="sd">1.73205080756887729</span>
<span class="sd">&gt;&gt;&gt; print Decimal(3) ** 123</span>
<span class="sd">4.85192780976896427E+58</span>
<span class="sd">&gt;&gt;&gt; inf = Decimal(1) / Decimal(0)</span>
<span class="sd">&gt;&gt;&gt; print inf</span>
<span class="sd">Infinity</span>
<span class="sd">&gt;&gt;&gt; neginf = Decimal(-1) / Decimal(0)</span>
<span class="sd">&gt;&gt;&gt; print neginf</span>
<span class="sd">-Infinity</span>
<span class="sd">&gt;&gt;&gt; print neginf + inf</span>
<span class="sd">NaN</span>
<span class="sd">&gt;&gt;&gt; print neginf * inf</span>
<span class="sd">-Infinity</span>
<span class="sd">&gt;&gt;&gt; print dig / 0</span>
<span class="sd">Infinity</span>
<span class="sd">&gt;&gt;&gt; getcontext().traps[DivisionByZero] = 1</span>
<span class="sd">&gt;&gt;&gt; print dig / 0</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">  ...</span>
<span class="sd">  ...</span>
<span class="sd">  ...</span>
<span class="sd">DivisionByZero: x / 0</span>
<span class="sd">&gt;&gt;&gt; c = Context()</span>
<span class="sd">&gt;&gt;&gt; c.traps[InvalidOperation] = 0</span>
<span class="sd">&gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">0</span>
<span class="sd">&gt;&gt;&gt; c.divide(Decimal(0), Decimal(0))</span>
<span class="sd">Decimal(&#39;NaN&#39;)</span>
<span class="sd">&gt;&gt;&gt; c.traps[InvalidOperation] = 1</span>
<span class="sd">&gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt; c.flags[InvalidOperation] = 0</span>
<span class="sd">&gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">0</span>
<span class="sd">&gt;&gt;&gt; print c.divide(Decimal(0), Decimal(0))</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">  ...</span>
<span class="sd">  ...</span>
<span class="sd">  ...</span>
<span class="sd">InvalidOperation: 0 / 0</span>
<span class="sd">&gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt; c.flags[InvalidOperation] = 0</span>
<span class="sd">&gt;&gt;&gt; c.traps[InvalidOperation] = 0</span>
<span class="sd">&gt;&gt;&gt; print c.divide(Decimal(0), Decimal(0))</span>
<span class="sd">NaN</span>
<span class="sd">&gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Two major classes</span>
    <span class="s1">&#39;Decimal&#39;</span><span class="p">,</span> <span class="s1">&#39;Context&#39;</span><span class="p">,</span>

    <span class="c1"># Contexts</span>
    <span class="s1">&#39;DefaultContext&#39;</span><span class="p">,</span> <span class="s1">&#39;BasicContext&#39;</span><span class="p">,</span> <span class="s1">&#39;ExtendedContext&#39;</span><span class="p">,</span>

    <span class="c1"># Exceptions</span>
    <span class="s1">&#39;DecimalException&#39;</span><span class="p">,</span> <span class="s1">&#39;Clamped&#39;</span><span class="p">,</span> <span class="s1">&#39;InvalidOperation&#39;</span><span class="p">,</span> <span class="s1">&#39;DivisionByZero&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Inexact&#39;</span><span class="p">,</span> <span class="s1">&#39;Rounded&#39;</span><span class="p">,</span> <span class="s1">&#39;Subnormal&#39;</span><span class="p">,</span> <span class="s1">&#39;Overflow&#39;</span><span class="p">,</span> <span class="s1">&#39;Underflow&#39;</span><span class="p">,</span>

    <span class="c1"># Constants for use in setting up contexts</span>
    <span class="s1">&#39;ROUND_DOWN&#39;</span><span class="p">,</span> <span class="s1">&#39;ROUND_HALF_UP&#39;</span><span class="p">,</span> <span class="s1">&#39;ROUND_HALF_EVEN&#39;</span><span class="p">,</span> <span class="s1">&#39;ROUND_CEILING&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ROUND_FLOOR&#39;</span><span class="p">,</span> <span class="s1">&#39;ROUND_UP&#39;</span><span class="p">,</span> <span class="s1">&#39;ROUND_HALF_DOWN&#39;</span><span class="p">,</span> <span class="s1">&#39;ROUND_05UP&#39;</span><span class="p">,</span>

    <span class="c1"># Functions for manipulating contexts</span>
    <span class="s1">&#39;setcontext&#39;</span><span class="p">,</span> <span class="s1">&#39;getcontext&#39;</span><span class="p">,</span> <span class="s1">&#39;localcontext&#39;</span>
<span class="p">]</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;1.70&#39;</span>    <span class="c1"># Highest version of the spec this complies with</span>

<span class="kn">import</span> <span class="nn">math</span> <span class="kn">as</span> <span class="nn">_math</span>
<span class="kn">import</span> <span class="nn">numbers</span> <span class="kn">as</span> <span class="nn">_numbers</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span> <span class="k">as</span> <span class="n">_namedtuple</span>
    <span class="n">DecimalTuple</span> <span class="o">=</span> <span class="n">_namedtuple</span><span class="p">(</span><span class="s1">&#39;DecimalTuple&#39;</span><span class="p">,</span> <span class="s1">&#39;sign digits exponent&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">DecimalTuple</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">args</span>

<span class="c1"># Rounding</span>
<span class="n">ROUND_DOWN</span> <span class="o">=</span> <span class="s1">&#39;ROUND_DOWN&#39;</span>
<span class="n">ROUND_HALF_UP</span> <span class="o">=</span> <span class="s1">&#39;ROUND_HALF_UP&#39;</span>
<span class="n">ROUND_HALF_EVEN</span> <span class="o">=</span> <span class="s1">&#39;ROUND_HALF_EVEN&#39;</span>
<span class="n">ROUND_CEILING</span> <span class="o">=</span> <span class="s1">&#39;ROUND_CEILING&#39;</span>
<span class="n">ROUND_FLOOR</span> <span class="o">=</span> <span class="s1">&#39;ROUND_FLOOR&#39;</span>
<span class="n">ROUND_UP</span> <span class="o">=</span> <span class="s1">&#39;ROUND_UP&#39;</span>
<span class="n">ROUND_HALF_DOWN</span> <span class="o">=</span> <span class="s1">&#39;ROUND_HALF_DOWN&#39;</span>
<span class="n">ROUND_05UP</span> <span class="o">=</span> <span class="s1">&#39;ROUND_05UP&#39;</span>

<span class="c1"># Errors</span>

<div class="viewcode-block" id="DecimalException"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.DecimalException">[docs]</a><span class="k">class</span> <span class="nc">DecimalException</span><span class="p">(</span><span class="ne">ArithmeticError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base exception class.</span>

<span class="sd">    Used exceptions derive from this.</span>
<span class="sd">    If an exception derives from another exception besides this (such as</span>
<span class="sd">    Underflow (Inexact, Rounded, Subnormal) that indicates that it is only</span>
<span class="sd">    called if the others are present.  This isn&#39;t actually used for</span>
<span class="sd">    anything, though.</span>

<span class="sd">    handle  -- Called when context._raise_error is called and the</span>
<span class="sd">               trap_enabler is not set.  First argument is self, second is the</span>
<span class="sd">               context.  More arguments can be given, those being after</span>
<span class="sd">               the explanation in _raise_error (For example,</span>
<span class="sd">               context._raise_error(NewError, &#39;(-x)!&#39;, self._sign) would</span>
<span class="sd">               call NewError().handle(context, self._sign).)</span>

<span class="sd">    To define a new exception, it should be sufficient to have it derive</span>
<span class="sd">    from DecimalException.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Clamped"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Clamped">[docs]</a><span class="k">class</span> <span class="nc">Clamped</span><span class="p">(</span><span class="n">DecimalException</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Exponent of a 0 changed to fit bounds.</span>

<span class="sd">    This occurs and signals clamped if the exponent of a result has been</span>
<span class="sd">    altered in order to fit the constraints of a specific concrete</span>
<span class="sd">    representation.  This may occur when the exponent of a zero result would</span>
<span class="sd">    be outside the bounds of a representation, or when a large normal</span>
<span class="sd">    number would have an encoded exponent that cannot be represented.  In</span>
<span class="sd">    this latter case, the exponent is reduced to fit and the corresponding</span>
<span class="sd">    number of zero digits are appended to the coefficient (&quot;fold-down&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="InvalidOperation"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.InvalidOperation">[docs]</a><span class="k">class</span> <span class="nc">InvalidOperation</span><span class="p">(</span><span class="n">DecimalException</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An invalid operation was performed.</span>

<span class="sd">    Various bad things cause this:</span>

<span class="sd">    Something creates a signaling NaN</span>
<span class="sd">    -INF + INF</span>
<span class="sd">    0 * (+-)INF</span>
<span class="sd">    (+-)INF / (+-)INF</span>
<span class="sd">    x % 0</span>
<span class="sd">    (+-)INF % x</span>
<span class="sd">    x._rescale( non-integer )</span>
<span class="sd">    sqrt(-x) , x &gt; 0</span>
<span class="sd">    0 ** 0</span>
<span class="sd">    x ** (non-integer)</span>
<span class="sd">    x ** (+-)INF</span>
<span class="sd">    An operand is invalid</span>

<span class="sd">    The result of the operation after these is a quiet positive NaN,</span>
<span class="sd">    except when the cause is a signaling NaN, in which case the result is</span>
<span class="sd">    also a quiet NaN, but with the original sign, and an optional</span>
<span class="sd">    diagnostic information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix_nan</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_NaN</span></div>

<span class="k">class</span> <span class="nc">ConversionSyntax</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Trying to convert badly formed string.</span>

<span class="sd">    This occurs and signals invalid-operation if a string is being</span>
<span class="sd">    converted to a number and it does not conform to the numeric string</span>
<span class="sd">    syntax.  The result is [0,qNaN].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_NaN</span>

<div class="viewcode-block" id="DivisionByZero"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.DivisionByZero">[docs]</a><span class="k">class</span> <span class="nc">DivisionByZero</span><span class="p">(</span><span class="n">DecimalException</span><span class="p">,</span> <span class="ne">ZeroDivisionError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Division by 0.</span>

<span class="sd">    This occurs and signals division-by-zero if division of a finite number</span>
<span class="sd">    by zero was attempted (during a divide-integer or divide operation, or a</span>
<span class="sd">    power operation with negative right-hand operand), and the dividend was</span>
<span class="sd">    not zero.</span>

<span class="sd">    The result of the operation is [sign,inf], where sign is the exclusive</span>
<span class="sd">    or of the signs of the operands for divide, or is 1 for an odd power of</span>
<span class="sd">    -0, for power.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">sign</span><span class="p">]</span></div>

<span class="k">class</span> <span class="nc">DivisionImpossible</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cannot perform the division adequately.</span>

<span class="sd">    This occurs and signals invalid-operation if the integer result of a</span>
<span class="sd">    divide-integer or remainder operation had too many digits (would be</span>
<span class="sd">    longer than precision).  The result is [0,qNaN].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_NaN</span>

<span class="k">class</span> <span class="nc">DivisionUndefined</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="ne">ZeroDivisionError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Undefined result of division.</span>

<span class="sd">    This occurs and signals invalid-operation if division by zero was</span>
<span class="sd">    attempted (during a divide-integer, divide, or remainder operation), and</span>
<span class="sd">    the dividend is also zero.  The result is [0,qNaN].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_NaN</span>

<div class="viewcode-block" id="Inexact"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Inexact">[docs]</a><span class="k">class</span> <span class="nc">Inexact</span><span class="p">(</span><span class="n">DecimalException</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Had to round, losing information.</span>

<span class="sd">    This occurs and signals inexact whenever the result of an operation is</span>
<span class="sd">    not exact (that is, it needed to be rounded and any discarded digits</span>
<span class="sd">    were non-zero), or if an overflow or underflow condition occurs.  The</span>
<span class="sd">    result in all cases is unchanged.</span>

<span class="sd">    The inexact signal may be tested (or trapped) to determine if a given</span>
<span class="sd">    operation (or sequence of operations) was inexact.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

<span class="k">class</span> <span class="nc">InvalidContext</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Invalid context.  Unknown rounding, for example.</span>

<span class="sd">    This occurs and signals invalid-operation if an invalid context was</span>
<span class="sd">    detected during an operation.  This can occur if contexts are not checked</span>
<span class="sd">    on creation and either the precision exceeds the capability of the</span>
<span class="sd">    underlying concrete representation or an unknown or unsupported rounding</span>
<span class="sd">    was specified.  These aspects of the context need only be checked when</span>
<span class="sd">    the values are required to be used.  The result is [0,qNaN].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_NaN</span>

<div class="viewcode-block" id="Rounded"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Rounded">[docs]</a><span class="k">class</span> <span class="nc">Rounded</span><span class="p">(</span><span class="n">DecimalException</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Number got rounded (not  necessarily changed during rounding).</span>

<span class="sd">    This occurs and signals rounded whenever the result of an operation is</span>
<span class="sd">    rounded (that is, some zero or non-zero digits were discarded from the</span>
<span class="sd">    coefficient), or if an overflow or underflow condition occurs.  The</span>
<span class="sd">    result in all cases is unchanged.</span>

<span class="sd">    The rounded signal may be tested (or trapped) to determine if a given</span>
<span class="sd">    operation (or sequence of operations) caused a loss of precision.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Subnormal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Subnormal">[docs]</a><span class="k">class</span> <span class="nc">Subnormal</span><span class="p">(</span><span class="n">DecimalException</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Exponent &lt; Emin before rounding.</span>

<span class="sd">    This occurs and signals subnormal whenever the result of a conversion or</span>
<span class="sd">    operation is subnormal (that is, its adjusted exponent is less than</span>
<span class="sd">    Emin, before any rounding).  The result in all cases is unchanged.</span>

<span class="sd">    The subnormal signal may be tested (or trapped) to determine if a given</span>
<span class="sd">    or operation (or sequence of operations) yielded a subnormal result.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Overflow"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Overflow">[docs]</a><span class="k">class</span> <span class="nc">Overflow</span><span class="p">(</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Numerical overflow.</span>

<span class="sd">    This occurs and signals overflow if the adjusted exponent of a result</span>
<span class="sd">    (from a conversion or from an operation that is not an attempt to divide</span>
<span class="sd">    by zero), after rounding, would be greater than the largest value that</span>
<span class="sd">    can be handled by the implementation (the value Emax).</span>

<span class="sd">    The result depends on the rounding mode:</span>

<span class="sd">    For round-half-up and round-half-even (and for round-half-down and</span>
<span class="sd">    round-up, if implemented), the result of the operation is [sign,inf],</span>
<span class="sd">    where sign is the sign of the intermediate result.  For round-down, the</span>
<span class="sd">    result is the largest finite number that can be represented in the</span>
<span class="sd">    current precision, with the sign of the intermediate result.  For</span>
<span class="sd">    round-ceiling, the result is the same as for round-down if the sign of</span>
<span class="sd">    the intermediate result is 1, or is [0,inf] otherwise.  For round-floor,</span>
<span class="sd">    the result is the same as for round-down if the sign of the intermediate</span>
<span class="sd">    result is 0, or is [1,inf] otherwise.  In all cases, Inexact and Rounded</span>
<span class="sd">    will also be raised.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ROUND_HALF_UP</span><span class="p">,</span> <span class="n">ROUND_HALF_EVEN</span><span class="p">,</span>
                                <span class="n">ROUND_HALF_DOWN</span><span class="p">,</span> <span class="n">ROUND_UP</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">sign</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">==</span> <span class="n">ROUND_CEILING</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">sign</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="o">*</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span>
                            <span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">==</span> <span class="n">ROUND_FLOOR</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">sign</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="o">*</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span>
                             <span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Underflow"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Underflow">[docs]</a><span class="k">class</span> <span class="nc">Underflow</span><span class="p">(</span><span class="n">Inexact</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">,</span> <span class="n">Subnormal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Numerical underflow with result rounded to 0.</span>

<span class="sd">    This occurs and signals underflow if a result is inexact and the</span>
<span class="sd">    adjusted exponent of the result would be smaller (more negative) than</span>
<span class="sd">    the smallest value that can be handled by the implementation (the value</span>
<span class="sd">    Emin).  That is, the result is both inexact and subnormal.</span>

<span class="sd">    The result after an underflow will be a subnormal number rounded, if</span>
<span class="sd">    necessary, so that its exponent is not less than Etiny.  This may result</span>
<span class="sd">    in 0 with the sign of the intermediate result and an exponent of Etiny.</span>

<span class="sd">    In all cases, Inexact, Rounded, and Subnormal will also be raised.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

<span class="c1"># List of public traps and flags</span>
<span class="n">_signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clamped</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">Inexact</span><span class="p">,</span> <span class="n">Overflow</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">,</span>
           <span class="n">Underflow</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Subnormal</span><span class="p">]</span>

<span class="c1"># Map conditions (per the spec) to signals</span>
<span class="n">_condition_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">ConversionSyntax</span><span class="p">:</span><span class="n">InvalidOperation</span><span class="p">,</span>
                  <span class="n">DivisionImpossible</span><span class="p">:</span><span class="n">InvalidOperation</span><span class="p">,</span>
                  <span class="n">DivisionUndefined</span><span class="p">:</span><span class="n">InvalidOperation</span><span class="p">,</span>
                  <span class="n">InvalidContext</span><span class="p">:</span><span class="n">InvalidOperation</span><span class="p">}</span>

<span class="c1">##### Context Functions ##################################################</span>

<span class="c1"># The getcontext() and setcontext() function manage access to a thread-local</span>
<span class="c1"># current context.  Py2.4 offers direct support for thread locals.  If that</span>
<span class="c1"># is not available, use threading.currentThread() which is slower but will</span>
<span class="c1"># work for older Pythons.  If threads are not part of the build, create a</span>
<span class="c1"># mock threading object with threading.local() returning the module namespace.</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">threading</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c1"># Python was compiled without threads; create a mock object instead</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="k">class</span> <span class="nc">MockThreading</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sys</span><span class="o">=</span><span class="n">sys</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">]</span>
    <span class="n">threading</span> <span class="o">=</span> <span class="n">MockThreading</span><span class="p">()</span>
    <span class="k">del</span> <span class="n">sys</span><span class="p">,</span> <span class="n">MockThreading</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">threading</span><span class="o">.</span><span class="n">local</span>

<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>

    <span class="c1"># To fix reloading, force it to create a new context</span>
    <span class="c1"># Old contexts have different exceptions in their dicts, making problems.</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">currentThread</span><span class="p">(),</span> <span class="s1">&#39;__decimal_context__&#39;</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">threading</span><span class="o">.</span><span class="n">currentThread</span><span class="p">()</span><span class="o">.</span><span class="n">__decimal_context__</span>

    <span class="k">def</span> <span class="nf">setcontext</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set this thread&#39;s context to context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">in</span> <span class="p">(</span><span class="n">DefaultContext</span><span class="p">,</span> <span class="n">BasicContext</span><span class="p">,</span> <span class="n">ExtendedContext</span><span class="p">):</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">context</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">currentThread</span><span class="p">()</span><span class="o">.</span><span class="n">__decimal_context__</span> <span class="o">=</span> <span class="n">context</span>

    <span class="k">def</span> <span class="nf">getcontext</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Returns this thread&#39;s context.</span>

<span class="sd">        If this thread does not yet have a context, returns</span>
<span class="sd">        a new context and sets this thread&#39;s context.</span>
<span class="sd">        New contexts are copies of DefaultContext.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">threading</span><span class="o">.</span><span class="n">currentThread</span><span class="p">()</span><span class="o">.</span><span class="n">__decimal_context__</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
            <span class="n">threading</span><span class="o">.</span><span class="n">currentThread</span><span class="p">()</span><span class="o">.</span><span class="n">__decimal_context__</span> <span class="o">=</span> <span class="n">context</span>
            <span class="k">return</span> <span class="n">context</span>

<span class="k">else</span><span class="p">:</span>

    <span class="n">local</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">local</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="s1">&#39;__decimal_context__&#39;</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">local</span><span class="o">.</span><span class="n">__decimal_context__</span>

<div class="viewcode-block" id="getcontext"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.getcontext">[docs]</a>    <span class="k">def</span> <span class="nf">getcontext</span><span class="p">(</span><span class="n">_local</span><span class="o">=</span><span class="n">local</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns this thread&#39;s context.</span>

<span class="sd">        If this thread does not yet have a context, returns</span>
<span class="sd">        a new context and sets this thread&#39;s context.</span>
<span class="sd">        New contexts are copies of DefaultContext.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_local</span><span class="o">.</span><span class="n">__decimal_context__</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
            <span class="n">_local</span><span class="o">.</span><span class="n">__decimal_context__</span> <span class="o">=</span> <span class="n">context</span>
            <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="setcontext"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.setcontext">[docs]</a>    <span class="k">def</span> <span class="nf">setcontext</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">_local</span><span class="o">=</span><span class="n">local</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set this thread&#39;s context to context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">in</span> <span class="p">(</span><span class="n">DefaultContext</span><span class="p">,</span> <span class="n">BasicContext</span><span class="p">,</span> <span class="n">ExtendedContext</span><span class="p">):</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">context</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
        <span class="n">_local</span><span class="o">.</span><span class="n">__decimal_context__</span> <span class="o">=</span> <span class="n">context</span></div>

    <span class="k">del</span> <span class="n">threading</span><span class="p">,</span> <span class="n">local</span>        <span class="c1"># Don&#39;t contaminate the namespace</span>

<div class="viewcode-block" id="localcontext"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.localcontext">[docs]</a><span class="k">def</span> <span class="nf">localcontext</span><span class="p">(</span><span class="n">ctx</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a context manager for a copy of the supplied context</span>

<span class="sd">    Uses a copy of the current context if no context is specified</span>
<span class="sd">    The returned context manager creates a local decimal context</span>
<span class="sd">    in a with statement:</span>
<span class="sd">        def sin(x):</span>
<span class="sd">             with localcontext() as ctx:</span>
<span class="sd">                 ctx.prec += 2</span>
<span class="sd">                 # Rest of sin calculation algorithm</span>
<span class="sd">                 # uses a precision 2 greater than normal</span>
<span class="sd">             return +s  # Convert result to normal precision</span>

<span class="sd">         def sin(x):</span>
<span class="sd">             with localcontext(ExtendedContext):</span>
<span class="sd">                 # Rest of sin calculation algorithm</span>
<span class="sd">                 # uses the Extended Context from the</span>
<span class="sd">                 # General Decimal Arithmetic Specification</span>
<span class="sd">             return +s  # Convert result to normal context</span>

<span class="sd">    &gt;&gt;&gt; setcontext(DefaultContext)</span>
<span class="sd">    &gt;&gt;&gt; print getcontext().prec</span>
<span class="sd">    28</span>
<span class="sd">    &gt;&gt;&gt; with localcontext():</span>
<span class="sd">    ...     ctx = getcontext()</span>
<span class="sd">    ...     ctx.prec += 2</span>
<span class="sd">    ...     print ctx.prec</span>
<span class="sd">    ...</span>
<span class="sd">    30</span>
<span class="sd">    &gt;&gt;&gt; with localcontext(ExtendedContext):</span>
<span class="sd">    ...     print getcontext().prec</span>
<span class="sd">    ...</span>
<span class="sd">    9</span>
<span class="sd">    &gt;&gt;&gt; print getcontext().prec</span>
<span class="sd">    28</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">ctx</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">_ContextManager</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></div>


<span class="c1">##### Decimal class #######################################################</span>

<div class="viewcode-block" id="Decimal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal">[docs]</a><span class="k">class</span> <span class="nc">Decimal</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Floating point class for decimal arithmetic.&quot;&quot;&quot;</span>

    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_exp&#39;</span><span class="p">,</span><span class="s1">&#39;_int&#39;</span><span class="p">,</span><span class="s1">&#39;_sign&#39;</span><span class="p">,</span> <span class="s1">&#39;_is_special&#39;</span><span class="p">)</span>
    <span class="c1"># Generally, the value of the Decimal instance is given by</span>
    <span class="c1">#  (-1)**_sign * _int * 10**_exp</span>
    <span class="c1"># Special values are signified by _is_special == True</span>

    <span class="c1"># We&#39;re immutable, so use __new__ not __init__</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a decimal point instance.</span>

<span class="sd">        &gt;&gt;&gt; Decimal(&#39;3.14&#39;)              # string input</span>
<span class="sd">        Decimal(&#39;3.14&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Decimal((0, (3, 1, 4), -2))  # tuple (sign, digit_tuple, exponent)</span>
<span class="sd">        Decimal(&#39;3.14&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Decimal(314)                 # int or long</span>
<span class="sd">        Decimal(&#39;314&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Decimal(Decimal(314))        # another decimal instance</span>
<span class="sd">        Decimal(&#39;314&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Decimal(&#39;  3.14  \\n&#39;)        # leading and trailing whitespace okay</span>
<span class="sd">        Decimal(&#39;3.14&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Note that the coefficient, self._int, is actually stored as</span>
        <span class="c1"># a string rather than as a tuple of digits.  This speeds up</span>
        <span class="c1"># the &quot;digits to integer&quot; and &quot;integer to digits&quot; conversions</span>
        <span class="c1"># that are used in almost every arithmetic operation on</span>
        <span class="c1"># Decimals.  This is an internal detail: the as_tuple function</span>
        <span class="c1"># and the Decimal constructor still deal with tuples of</span>
        <span class="c1"># digits.</span>

        <span class="bp">self</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>

        <span class="c1"># From a string</span>
        <span class="c1"># REs insist on real strings, so we can too.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">_parser</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">ConversionSyntax</span><span class="p">,</span>
                                <span class="s2">&quot;Invalid literal for Decimal: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;sign&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">intpart</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">intpart</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># finite number</span>
                <span class="n">fracpart</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;frac&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span>
                <span class="n">exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">intpart</span><span class="o">+</span><span class="n">fracpart</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="n">exp</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">fracpart</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">diag</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;diag&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">diag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="c1"># NaN</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">diag</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;signal&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># infinity</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="s1">&#39;F&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># From an integer</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">long</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># From another decimal</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span>  <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_exp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_sign</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>  <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_int</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span>  <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_is_special</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># From an internal working value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_WorkRep</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">sign</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># tuple/list conversion (possibly from as_tuple())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid tuple size in creation of Decimal &#39;</span>
                                 <span class="s1">&#39;from list or tuple.  The list or tuple &#39;</span>
                                 <span class="s1">&#39;should have exactly three elements.&#39;</span><span class="p">)</span>
            <span class="c1"># process sign.  The isinstance test rejects floats</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">long</span><span class="p">))</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid sign.  The first value in the tuple &quot;</span>
                                 <span class="s2">&quot;should be an integer; either 0 for a &quot;</span>
                                 <span class="s2">&quot;positive number or 1 for a negative number.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
                <span class="c1"># infinity: value[1] is ignored</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># process and validate the digits in value[1]</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">digit</span> <span class="ow">in</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">long</span><span class="p">))</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">digit</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
                        <span class="c1"># skip leading zeros</span>
                        <span class="k">if</span> <span class="n">digits</span> <span class="ow">or</span> <span class="n">digit</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">digits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">digit</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The second value in the tuple must &quot;</span>
                                         <span class="s2">&quot;be composed of integers in the range &quot;</span>
                                         <span class="s2">&quot;0 through 9.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">):</span>
                    <span class="c1"># NaN: digits form the diagnostic</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">digits</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">long</span><span class="p">)):</span>
                    <span class="c1"># finite number: digits give the coefficient</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">digits</span> <span class="ow">or</span> <span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The third value in the tuple must &quot;</span>
                                     <span class="s2">&quot;be an integer, or one of the &quot;</span>
                                     <span class="s2">&quot;strings &#39;F&#39;, &#39;n&#39;, &#39;N&#39;.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">Decimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span>  <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_exp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_sign</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>  <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_int</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span>  <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_is_special</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert </span><span class="si">%r</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1"># @classmethod, but @decorator is not valid Python 2.3 syntax, so</span>
    <span class="c1"># don&#39;t use it (see notes on Py2.3 compatibility at top of file)</span>
<div class="viewcode-block" id="Decimal.from_float"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.from_float">[docs]</a>    <span class="k">def</span> <span class="nf">from_float</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Converts a float to a decimal number, exactly.</span>

<span class="sd">        Note that Decimal.from_float(0.1) is not the same as Decimal(&#39;0.1&#39;).</span>
<span class="sd">        Since 0.1 is not exactly representable in binary floating point, the</span>
<span class="sd">        value is stored as the nearest representable value which is</span>
<span class="sd">        0x1.999999999999ap-4.  The exact equivalent of the value in decimal</span>
<span class="sd">        is 0.1000000000000000055511151231257827021181583404541015625.</span>

<span class="sd">        &gt;&gt;&gt; Decimal.from_float(0.1)</span>
<span class="sd">        Decimal(&#39;0.1000000000000000055511151231257827021181583404541015625&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Decimal.from_float(float(&#39;nan&#39;))</span>
<span class="sd">        Decimal(&#39;NaN&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Decimal.from_float(float(&#39;inf&#39;))</span>
<span class="sd">        Decimal(&#39;Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Decimal.from_float(-float(&#39;inf&#39;))</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Decimal.from_float(-0.0)</span>
<span class="sd">        Decimal(&#39;-0&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">long</span><span class="p">)):</span>        <span class="c1"># handle integer inputs</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_math</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="n">_math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>  <span class="c1"># raises TypeError if not a float</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">_math</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="n">k</span><span class="p">),</span> <span class="o">-</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cls</span> <span class="ow">is</span> <span class="n">Decimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
    <span class="n">from_float</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">from_float</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isnan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns whether the number is not actually one.</span>

<span class="sd">        0 if a number</span>
<span class="sd">        1 if NaN</span>
<span class="sd">        2 if sNaN</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span>
            <span class="k">if</span> <span class="n">exp</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">exp</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_isinfinity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns whether the number is infinite</span>

<span class="sd">        0 if finite or not a number</span>
<span class="sd">        1 if +INF</span>
<span class="sd">        -1 if -INF</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_check_nans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns whether the number is not actually one.</span>

<span class="sd">        if self, other are sNaN, signal</span>
<span class="sd">        if self, other are NaN return nan</span>
<span class="sd">        return 0</span>

<span class="sd">        Done before operations.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">self_is_nan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">other_is_nan</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">other_is_nan</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">self_is_nan</span> <span class="ow">or</span> <span class="n">other_is_nan</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">self_is_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;sNaN&#39;</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other_is_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;sNaN&#39;</span><span class="p">,</span>
                                        <span class="n">other</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">self_is_nan</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_nan</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_fix_nan</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_compare_check_nans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Version of _check_nans used for the signaling comparisons</span>
<span class="sd">        compare_signal, __le__, __lt__, __ge__, __gt__.</span>

<span class="sd">        Signal InvalidOperation if either self or other is a (quiet</span>
<span class="sd">        or signaling) NaN.  Signaling NaNs take precedence over quiet</span>
<span class="sd">        NaNs.</span>

<span class="sd">        Return 0 if neither operand is a NaN.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_snan</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                            <span class="s1">&#39;comparison involving sNaN&#39;</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">other</span><span class="o">.</span><span class="n">is_snan</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                            <span class="s1">&#39;comparison involving sNaN&#39;</span><span class="p">,</span>
                                            <span class="n">other</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                            <span class="s1">&#39;comparison involving NaN&#39;</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">other</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                            <span class="s1">&#39;comparison involving NaN&#39;</span><span class="p">,</span>
                                            <span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is nonzero; otherwise return False.</span>

<span class="sd">        NaNs and infinities are considered nonzero.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span>

    <span class="k">def</span> <span class="nf">_cmp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare the two non-NaN decimal instances self and other.</span>

<span class="sd">        Returns -1 if self &lt; other, 0 if self == other and 1</span>
<span class="sd">        if self &gt; other.  This routine is for internal use only.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">self_inf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span>
            <span class="n">other_inf</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">self_inf</span> <span class="o">==</span> <span class="n">other_inf</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">self_inf</span> <span class="o">&lt;</span> <span class="n">other_inf</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>

        <span class="c1"># check for zeros;  Decimal(&#39;0&#39;) == Decimal(&#39;-0&#39;)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>

        <span class="c1"># If different signs, neg one is less</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>

        <span class="n">self_adjusted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span>
        <span class="n">other_adjusted</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">self_adjusted</span> <span class="o">==</span> <span class="n">other_adjusted</span><span class="p">:</span>
            <span class="n">self_padded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>
            <span class="n">other_padded</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_int</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">self_padded</span> <span class="o">==</span> <span class="n">other_padded</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">self_padded</span> <span class="o">&lt;</span> <span class="n">other_padded</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>
        <span class="k">elif</span> <span class="n">self_adjusted</span> <span class="o">&gt;</span> <span class="n">other_adjusted</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># self_adjusted &lt; other_adjusted</span>
            <span class="k">return</span> <span class="o">-</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>

    <span class="c1"># Note: The Decimal standard doesn&#39;t cover rich comparisons for</span>
    <span class="c1"># Decimals.  In particular, the specification is silent on the</span>
    <span class="c1"># subject of what should happen for a comparison involving a NaN.</span>
    <span class="c1"># We take the following approach:</span>
    <span class="c1">#</span>
    <span class="c1">#   == comparisons involving a quiet NaN always return False</span>
    <span class="c1">#   != comparisons involving a quiet NaN always return True</span>
    <span class="c1">#   == or != comparisons involving a signaling NaN signal</span>
    <span class="c1">#      InvalidOperation, and return False or True as above if the</span>
    <span class="c1">#      InvalidOperation is not trapped.</span>
    <span class="c1">#   &lt;, &gt;, &lt;= and &gt;= comparisons involving a (quiet or signaling)</span>
    <span class="c1">#      NaN signal InvalidOperation, and return False if the</span>
    <span class="c1">#      InvalidOperation is not trapped.</span>
    <span class="c1">#</span>
    <span class="c1"># This behavior is designed to conform as closely as possible to</span>
    <span class="c1"># that specified by IEEE 754.</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">allow_float</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">allow_float</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">allow_float</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">allow_float</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">allow_float</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">allow_float</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>

<div class="viewcode-block" id="Decimal.compare"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.compare">[docs]</a>    <span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares one to another.</span>

<span class="sd">        -1 =&gt; a &lt; b</span>
<span class="sd">        0  =&gt; a = b</span>
<span class="sd">        1  =&gt; a &gt; b</span>
<span class="sd">        NaN =&gt; one is NaN</span>
<span class="sd">        Like __cmp__, but returns Decimal instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># Compare(NaN, NaN) = NaN</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">):</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;x.__hash__() &lt;==&gt; hash(x)&quot;&quot;&quot;</span>
        <span class="c1"># Decimal integers must hash the same as the ints</span>
        <span class="c1">#</span>
        <span class="c1"># The hash of a nonspecial noninteger Decimal must depend only</span>
        <span class="c1"># on the value of that Decimal, and not on its representation.</span>
        <span class="c1"># For example: hash(Decimal(&#39;100E-1&#39;)) == hash(Decimal(&#39;10&#39;)).</span>

        <span class="c1"># Equality comparisons involving signaling nans can raise an</span>
        <span class="c1"># exception; since equality checks are implicitly and</span>
        <span class="c1"># unpredictably used when checking set and dict membership, we</span>
        <span class="c1"># prevent signaling nans from being used as set elements or</span>
        <span class="c1"># dict keys by making __hash__ raise an exception.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_snan</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Cannot hash a signaling NaN value.&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_nan</span><span class="p">():</span>
                <span class="c1"># 0 to match hash(float(&#39;nan&#39;))</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># values chosen to match hash(float(&#39;inf&#39;)) and</span>
                <span class="c1"># hash(float(&#39;-inf&#39;)).</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
                    <span class="k">return</span> <span class="o">-</span><span class="mi">271828</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="mi">314159</span>

        <span class="c1"># In Python 2.7, we&#39;re allowing comparisons (but not</span>
        <span class="c1"># arithmetic operations) between floats and Decimals;  so if</span>
        <span class="c1"># a Decimal instance is exactly representable as a float then</span>
        <span class="c1"># its hash should match that of the float.</span>
        <span class="n">self_as_float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="n">self_as_float</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="n">self_as_float</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">():</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">())</span>
            <span class="c1"># to make computation feasible for Decimals with large</span>
            <span class="c1"># exponent, we use the fact that hash(n) == hash(m) for</span>
            <span class="c1"># any two nonzero integers n and m such that (i) n and m</span>
            <span class="c1"># have the same sign, and (ii) n is congruent to m modulo</span>
            <span class="c1"># 2**64-1.  So we can replace hash((-1)**s*c*10**e) with</span>
            <span class="c1"># hash((-1)**s*c*pow(10, e, 2**64-1).</span>
            <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">op</span><span class="o">.</span><span class="n">sign</span><span class="o">*</span><span class="n">op</span><span class="o">.</span><span class="n">int</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">64</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="c1"># The value of a nonzero nonspecial Decimal instance is</span>
        <span class="c1"># faithfully represented by the triple consisting of its sign,</span>
        <span class="c1"># its adjusted exponent, and its coefficient with trailing</span>
        <span class="c1"># zeros removed.</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">),</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)))</span>

<div class="viewcode-block" id="Decimal.as_tuple"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.as_tuple">[docs]</a>    <span class="k">def</span> <span class="nf">as_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Represents the number as a triple tuple.</span>

<span class="sd">        To show the internals exactly as they are.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DecimalTuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Represents the number as an instance of Decimal.&quot;&quot;&quot;</span>
        <span class="c1"># Invariant:  eval(repr(d)) == d</span>
        <span class="k">return</span> <span class="s2">&quot;Decimal(&#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eng</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return string representation of the number in scientific notation.</span>

<span class="sd">        Captures all of the information in the underlying representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sign</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sign</span> <span class="o">+</span> <span class="s1">&#39;Infinity&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sign</span> <span class="o">+</span> <span class="s1">&#39;NaN&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># self._exp == &#39;N&#39;</span>
                <span class="k">return</span> <span class="n">sign</span> <span class="o">+</span> <span class="s1">&#39;sNaN&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>

        <span class="c1"># number of digits of self._int to left of decimal point</span>
        <span class="n">leftdigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>

        <span class="c1"># dotplace is number of digits of self._int to the left of the</span>
        <span class="c1"># decimal point in the mantissa of the output string (that is,</span>
        <span class="c1"># after adjusting the exponent)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">leftdigits</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">6</span><span class="p">:</span>
            <span class="c1"># no exponent required</span>
            <span class="n">dotplace</span> <span class="o">=</span> <span class="n">leftdigits</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">eng</span><span class="p">:</span>
            <span class="c1"># usual scientific notation: 1 digit on left of the point</span>
            <span class="n">dotplace</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
            <span class="c1"># engineering notation, zero</span>
            <span class="n">dotplace</span> <span class="o">=</span> <span class="p">(</span><span class="n">leftdigits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># engineering notation, nonzero</span>
            <span class="n">dotplace</span> <span class="o">=</span> <span class="p">(</span><span class="n">leftdigits</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">dotplace</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">intpart</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
            <span class="n">fracpart</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dotplace</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>
        <span class="k">elif</span> <span class="n">dotplace</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">):</span>
            <span class="n">intpart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="o">+</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">dotplace</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">))</span>
            <span class="n">fracpart</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">intpart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[:</span><span class="n">dotplace</span><span class="p">]</span>
            <span class="n">fracpart</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="n">dotplace</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">leftdigits</span> <span class="o">==</span> <span class="n">dotplace</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="n">context</span><span class="o">.</span><span class="n">capitals</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%+d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">leftdigits</span><span class="o">-</span><span class="n">dotplace</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sign</span> <span class="o">+</span> <span class="n">intpart</span> <span class="o">+</span> <span class="n">fracpart</span> <span class="o">+</span> <span class="n">exp</span>

<div class="viewcode-block" id="Decimal.to_eng_string"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.to_eng_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_eng_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert to engineering-type string.</span>

<span class="sd">        Engineering notation has an exponent which is a multiple of 3, so there</span>
<span class="sd">        are up to 3 digits left of the decimal place.</span>

<span class="sd">        Same rules for when in exponential and when as a value as in __str__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__str__</span><span class="p">(</span><span class="n">eng</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy with the sign switched.</span>

<span class="sd">        Rounds, if it has reason.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">!=</span> <span class="n">ROUND_FLOOR</span><span class="p">:</span>
            <span class="c1"># -Decimal(&#39;0&#39;) is Decimal(&#39;0&#39;), not Decimal(&#39;-0&#39;), except</span>
            <span class="c1"># in ROUND_FLOOR rounding mode.</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy, unless it is a sNaN.</span>

<span class="sd">        Rounds the number (if more than precision digits)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">!=</span> <span class="n">ROUND_FLOOR</span><span class="p">:</span>
            <span class="c1"># + (-0) = 0, except in ROUND_FLOOR rounding mode.</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">round</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the absolute value of self.</span>

<span class="sd">        If the keyword argument &#39;round&#39; is false, do not round.  The</span>
<span class="sd">        expression self.__abs__(round=False) is equivalent to</span>
<span class="sd">        self.copy_abs().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">round</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__neg__</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pos__</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns self + other.</span>

<span class="sd">        -INF + INF (or the reverse) cause InvalidOperation errors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="c1"># If both INF, same sign =&gt; same as both, opposite =&gt; error.</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                    <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;-INF + INF&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>  <span class="c1"># Can&#39;t both be infinity here</span>

        <span class="n">exp</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>
        <span class="n">negativezero</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">==</span> <span class="n">ROUND_FLOOR</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="c1"># If the answer is 0, the sign should be negative, in this case.</span>
            <span class="n">negativezero</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">negativezero</span><span class="p">:</span>
                <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="n">op1</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">op2</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">op1</span><span class="p">,</span> <span class="n">op2</span> <span class="o">=</span> <span class="n">_normalize</span><span class="p">(</span><span class="n">op1</span><span class="p">,</span> <span class="n">op2</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">op1</span><span class="o">.</span><span class="n">sign</span> <span class="o">!=</span> <span class="n">op2</span><span class="o">.</span><span class="n">sign</span><span class="p">:</span>
            <span class="c1"># Equal and opposite</span>
            <span class="k">if</span> <span class="n">op1</span><span class="o">.</span><span class="n">int</span> <span class="o">==</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span><span class="p">:</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">negativezero</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ans</span>
            <span class="k">if</span> <span class="n">op1</span><span class="o">.</span><span class="n">int</span> <span class="o">&lt;</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span><span class="p">:</span>
                <span class="n">op1</span><span class="p">,</span> <span class="n">op2</span> <span class="o">=</span> <span class="n">op2</span><span class="p">,</span> <span class="n">op1</span>
                <span class="c1"># OK, now abs(op1) &gt; abs(op2)</span>
            <span class="k">if</span> <span class="n">op1</span><span class="o">.</span><span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">op1</span><span class="o">.</span><span class="n">sign</span><span class="p">,</span> <span class="n">op2</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="n">op2</span><span class="o">.</span><span class="n">sign</span><span class="p">,</span> <span class="n">op1</span><span class="o">.</span><span class="n">sign</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="c1"># So we know the sign, and op1 &gt; 0.</span>
        <span class="k">elif</span> <span class="n">op1</span><span class="o">.</span><span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">op1</span><span class="o">.</span><span class="n">sign</span><span class="p">,</span> <span class="n">op2</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Now, op1 &gt; abs(op2) &gt; 0</span>

        <span class="k">if</span> <span class="n">op2</span><span class="o">.</span><span class="n">sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">int</span> <span class="o">=</span> <span class="n">op1</span><span class="o">.</span><span class="n">int</span> <span class="o">+</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">int</span> <span class="o">=</span> <span class="n">op1</span><span class="o">.</span><span class="n">int</span> <span class="o">-</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span>

        <span class="n">result</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">op1</span><span class="o">.</span><span class="n">exp</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span>

    <span class="n">__radd__</span> <span class="o">=</span> <span class="n">__add__</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return self - other&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

        <span class="c1"># self - other is computed as self + other.copy_negate()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">(),</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return other - self&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return self * other.</span>

<span class="sd">        (+-) INF * 0 (or its reverse) raise InvalidOperation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">resultsign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;(+-)INF * 0&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">resultsign</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;0 * (+-)INF&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">resultsign</span><span class="p">]</span>

        <span class="n">resultexp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span>

        <span class="c1"># Special case for multiplying by zero</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">resultsign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">resultexp</span><span class="p">)</span>
            <span class="c1"># Fixing in case the exponent is out of bounds</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="c1"># Special case for multiplying by power of 10</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">resultsign</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">resultexp</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_int</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">resultsign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">resultexp</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="n">op1</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">op2</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">resultsign</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">op1</span><span class="o">.</span><span class="n">int</span> <span class="o">*</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span><span class="p">),</span> <span class="n">resultexp</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ans</span>
    <span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return self / other.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">sign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;(+-)INF/(+-)INF&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">sign</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Clamped</span><span class="p">,</span> <span class="s1">&#39;Division by infinity&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Etiny</span><span class="p">())</span>

        <span class="c1"># Special cases for zeroes</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionUndefined</span><span class="p">,</span> <span class="s1">&#39;0 / 0&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="s1">&#39;x / 0&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># OK, so neither = 0, INF or NaN</span>
            <span class="n">shift</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">+</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">shift</span>
            <span class="n">op1</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">op2</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shift</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">coeff</span><span class="p">,</span> <span class="n">remainder</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">op1</span><span class="o">.</span><span class="n">int</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">shift</span><span class="p">,</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coeff</span><span class="p">,</span> <span class="n">remainder</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">op1</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**-</span><span class="n">shift</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">remainder</span><span class="p">:</span>
                <span class="c1"># result is not exact; adjust to ensure correct rounding</span>
                <span class="k">if</span> <span class="n">coeff</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">coeff</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># result is exact; get as close to ideal exponent as possible</span>
                <span class="n">ideal_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span>
                <span class="k">while</span> <span class="n">exp</span> <span class="o">&lt;</span> <span class="n">ideal_exp</span> <span class="ow">and</span> <span class="n">coeff</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">coeff</span> <span class="o">//=</span> <span class="mi">10</span>
                    <span class="n">exp</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coeff</span><span class="p">),</span> <span class="n">exp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_divide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return (self // other, self % other), to context.prec precision.</span>

<span class="sd">        Assumes that neither self nor other is a NaN, that self is not</span>
<span class="sd">        infinite and that other is nonzero.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="n">ideal_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ideal_exp</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>

        <span class="n">expdiff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="ow">or</span> <span class="n">expdiff</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="n">ideal_exp</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">expdiff</span> <span class="o">&lt;=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
            <span class="n">op1</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">op2</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">op1</span><span class="o">.</span><span class="n">exp</span> <span class="o">&gt;=</span> <span class="n">op2</span><span class="o">.</span><span class="n">exp</span><span class="p">:</span>
                <span class="n">op1</span><span class="o">.</span><span class="n">int</span> <span class="o">*=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">op1</span><span class="o">.</span><span class="n">exp</span> <span class="o">-</span> <span class="n">op2</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">op2</span><span class="o">.</span><span class="n">int</span> <span class="o">*=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">op2</span><span class="o">.</span><span class="n">exp</span> <span class="o">-</span> <span class="n">op1</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">op1</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">q</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">**</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">ideal_exp</span><span class="p">))</span>

        <span class="c1"># Here the quotient is too large to be representable</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionImpossible</span><span class="p">,</span>
                                   <span class="s1">&#39;quotient too large in //, </span><span class="si">% o</span><span class="s1">r divmod&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">,</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="nf">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Swaps self/other and returns __truediv__.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

    <span class="n">__div__</span> <span class="o">=</span> <span class="n">__truediv__</span>
    <span class="n">__rdiv__</span> <span class="o">=</span> <span class="n">__rtruediv__</span>

    <span class="k">def</span> <span class="nf">__divmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return (self // other, self % other)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">ans</span><span class="p">)</span>

        <span class="n">sign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;divmod(INF, INF)&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ans</span><span class="p">,</span> <span class="n">ans</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">sign</span><span class="p">],</span>
                        <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;INF </span><span class="si">% x</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionUndefined</span><span class="p">,</span> <span class="s1">&#39;divmod(0, 0)&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ans</span><span class="p">,</span> <span class="n">ans</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="s1">&#39;x // 0&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="p">),</span>
                        <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;x % 0&#39;</span><span class="p">))</span>

        <span class="n">quotient</span><span class="p">,</span> <span class="n">remainder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divide</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="n">remainder</span> <span class="o">=</span> <span class="n">remainder</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">quotient</span><span class="p">,</span> <span class="n">remainder</span>

    <span class="k">def</span> <span class="nf">__rdivmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Swaps self/other and returns __divmod__.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">__divmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        self % other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;INF </span><span class="si">% x</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;x % 0&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionUndefined</span><span class="p">,</span> <span class="s1">&#39;0 % 0&#39;</span><span class="p">)</span>

        <span class="n">remainder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divide</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">remainder</span> <span class="o">=</span> <span class="n">remainder</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">remainder</span>

    <span class="k">def</span> <span class="nf">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Swaps self/other and returns __mod__.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

<div class="viewcode-block" id="Decimal.remainder_near"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.remainder_near">[docs]</a>    <span class="k">def</span> <span class="nf">remainder_near</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remainder nearest to 0-  abs(remainder-near) &lt;= other/2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="c1"># self == +/-infinity -&gt; InvalidOperation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;remainder_near(infinity, x)&#39;</span><span class="p">)</span>

        <span class="c1"># other == 0 -&gt; either InvalidOperation or DivisionUndefined</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                            <span class="s1">&#39;remainder_near(x, 0)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionUndefined</span><span class="p">,</span>
                                            <span class="s1">&#39;remainder_near(0, 0)&#39;</span><span class="p">)</span>

        <span class="c1"># other = +/-infinity -&gt; remainder = self</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="c1"># self = 0 -&gt; remainder = self, with ideal exponent</span>
        <span class="n">ideal_exponent</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">ideal_exponent</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="c1"># catch most cases of large or small quotient</span>
        <span class="n">expdiff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">expdiff</span> <span class="o">&gt;=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># expdiff &gt;= prec+1 =&gt; abs(self/other) &gt; 10**prec</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionImpossible</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expdiff</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="c1"># expdiff &lt;= -2 =&gt; abs(self/other) &lt; 0.1</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="n">ideal_exponent</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="c1"># adjust both arguments to have the same exponent, then divide</span>
        <span class="n">op1</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">op2</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">op1</span><span class="o">.</span><span class="n">exp</span> <span class="o">&gt;=</span> <span class="n">op2</span><span class="o">.</span><span class="n">exp</span><span class="p">:</span>
            <span class="n">op1</span><span class="o">.</span><span class="n">int</span> <span class="o">*=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">op1</span><span class="o">.</span><span class="n">exp</span> <span class="o">-</span> <span class="n">op2</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">op2</span><span class="o">.</span><span class="n">int</span> <span class="o">*=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">op2</span><span class="o">.</span><span class="n">exp</span> <span class="o">-</span> <span class="n">op1</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
        <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">op1</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
        <span class="c1"># remainder is r*10**ideal_exponent; other is +/-op2.int *</span>
        <span class="c1"># 10**ideal_exponent.   Apply correction to ensure that</span>
        <span class="c1"># abs(remainder) &lt;= abs(other)/2</span>
        <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span> <span class="o">+</span> <span class="p">(</span><span class="n">q</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">-=</span> <span class="n">op2</span><span class="o">.</span><span class="n">int</span>
            <span class="n">q</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">q</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="o">**</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionImpossible</span><span class="p">)</span>

        <span class="c1"># result has same sign as self unless r is negative</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">sign</span>
            <span class="n">r</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">ideal_exponent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;self // other&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;INF // INF&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="s1">&#39;x // 0&#39;</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionUndefined</span><span class="p">,</span> <span class="s1">&#39;0 // 0&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divide</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Swaps self/other and returns __floordiv__.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Float representation.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_snan</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot convert signaling NaN to float&quot;</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;-nan&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="k">else</span> <span class="s2">&quot;nan&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Converts self to an int, truncating if necessary.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot convert NaN to integer&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">OverflowError</span><span class="p">(</span><span class="s2">&quot;Cannot convert infinity to integer&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>

    <span class="n">__trunc__</span> <span class="o">=</span> <span class="n">__int__</span>

    <span class="k">def</span> <span class="nf">real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="n">real</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">real</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">imag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">imag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">imag</span><span class="p">)</span>

<div class="viewcode-block" id="Decimal.conjugate"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.conjugate">[docs]</a>    <span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">complex</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__long__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Converts to a long.</span>

<span class="sd">        Equivalent to long(int(self))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">long</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__int__</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_fix_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Decapitate the payload of a NaN to fit the context&quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>

        <span class="c1"># maximum length of payload is precision if _clamp=0,</span>
        <span class="c1"># precision-1 if _clamp=1.</span>
        <span class="n">max_payload_len</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">-</span> <span class="n">context</span><span class="o">.</span><span class="n">_clamp</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_payload_len</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="o">-</span><span class="n">max_payload_len</span><span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_fix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Round if it is necessary to keep self within prec precision.</span>

<span class="sd">        Rounds and fixes the exponent.  Does not raise on a sNaN.</span>

<span class="sd">        Arguments:</span>
<span class="sd">        self - Decimal instance</span>
<span class="sd">        context - context used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">():</span>
                <span class="c1"># decapitate payload if necessary</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_nan</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># self is +/-Infinity; return unaltered</span>
                <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># if self is zero then exponent should be between Etiny and</span>
        <span class="c1"># Emax if _clamp==0, and between Etiny and Etop if _clamp==1.</span>
        <span class="n">Etiny</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">Etiny</span><span class="p">()</span>
        <span class="n">Etop</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">Etop</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">exp_max</span> <span class="o">=</span> <span class="p">[</span><span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="n">Etop</span><span class="p">][</span><span class="n">context</span><span class="o">.</span><span class="n">_clamp</span><span class="p">]</span>
            <span class="n">new_exp</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">Etiny</span><span class="p">),</span> <span class="n">exp_max</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_exp</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Clamped</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">new_exp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># exp_min is the smallest allowable exponent of the result,</span>
        <span class="c1"># equal to max(self.adjusted()-context.prec+1, Etiny)</span>
        <span class="n">exp_min</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span>
        <span class="k">if</span> <span class="n">exp_min</span> <span class="o">&gt;</span> <span class="n">Etop</span><span class="p">:</span>
            <span class="c1"># overflow: exp_min &gt; Etop iff self.adjusted() &gt; Emax</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="s1">&#39;above Emax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="n">self_is_subnormal</span> <span class="o">=</span> <span class="n">exp_min</span> <span class="o">&lt;</span> <span class="n">Etiny</span>
        <span class="k">if</span> <span class="n">self_is_subnormal</span><span class="p">:</span>
            <span class="n">exp_min</span> <span class="o">=</span> <span class="n">Etiny</span>

        <span class="c1"># round if self has too many digits</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&lt;</span> <span class="n">exp_min</span><span class="p">:</span>
            <span class="n">digits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">exp_min</span>
            <span class="k">if</span> <span class="n">digits</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">exp_min</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">rounding_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pick_rounding_function</span><span class="p">[</span><span class="n">context</span><span class="o">.</span><span class="n">rounding</span><span class="p">]</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="n">rounding_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[:</span><span class="n">digits</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span>
            <span class="k">if</span> <span class="n">changed</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">coeff</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
                    <span class="n">coeff</span> <span class="o">=</span> <span class="n">coeff</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">exp_min</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># check whether the rounding pushed the exponent out of range</span>
            <span class="k">if</span> <span class="n">exp_min</span> <span class="o">&gt;</span> <span class="n">Etop</span><span class="p">:</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="s1">&#39;above Emax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">exp_min</span><span class="p">)</span>

            <span class="c1"># raise the appropriate signals, taking care to respect</span>
            <span class="c1"># the precedence described in the specification</span>
            <span class="k">if</span> <span class="n">changed</span> <span class="ow">and</span> <span class="n">self_is_subnormal</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Underflow</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">self_is_subnormal</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Subnormal</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ans</span><span class="p">:</span>
                <span class="c1"># raise Clamped on underflow to 0</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Clamped</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="n">self_is_subnormal</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Subnormal</span><span class="p">)</span>

        <span class="c1"># fold down if _clamp == 1 and self has too few digits</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">_clamp</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;</span> <span class="n">Etop</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Clamped</span><span class="p">)</span>
            <span class="n">self_padded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">Etop</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">self_padded</span><span class="p">,</span> <span class="n">Etop</span><span class="p">)</span>

        <span class="c1"># here self was representable to begin with; return unchanged</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># for each of the rounding functions below:</span>
    <span class="c1">#   self is a finite, nonzero Decimal</span>
    <span class="c1">#   prec is an integer satisfying 0 &lt;= prec &lt; len(self._int)</span>
    <span class="c1">#</span>
    <span class="c1"># each function returns either -1, 0, or 1, as follows:</span>
    <span class="c1">#   1 indicates that self should be rounded up (away from zero)</span>
    <span class="c1">#   0 indicates that self should be truncated, and that all the</span>
    <span class="c1">#     digits to be truncated are zeros (so the value is unchanged)</span>
    <span class="c1">#  -1 indicates that there are nonzero digits to be truncated</span>

    <span class="k">def</span> <span class="nf">_round_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Also known as round-towards-0, truncate.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_all_zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_round_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rounds away from 0.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_round_down</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_round_half_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rounds 5 up (away from 0)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="n">prec</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;56789&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">_all_zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_round_half_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Round 5 down&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_exact_half</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_half_up</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_round_half_even</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Round 5 to even, rest to nearest.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_exact_half</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="p">(</span><span class="n">prec</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="n">prec</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;02468&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_half_up</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_round_ceiling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rounds up (not away from 0 if negative.)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_down</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_round_down</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_round_floor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rounds down (not towards 0 if negative)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_down</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_round_down</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_round_05up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Round down unless digit prec-1 is 0 or 5.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prec</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="n">prec</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;05&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_down</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_round_down</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

    <span class="n">_pick_rounding_function</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">ROUND_DOWN</span> <span class="o">=</span> <span class="n">_round_down</span><span class="p">,</span>
        <span class="n">ROUND_UP</span> <span class="o">=</span> <span class="n">_round_up</span><span class="p">,</span>
        <span class="n">ROUND_HALF_UP</span> <span class="o">=</span> <span class="n">_round_half_up</span><span class="p">,</span>
        <span class="n">ROUND_HALF_DOWN</span> <span class="o">=</span> <span class="n">_round_half_down</span><span class="p">,</span>
        <span class="n">ROUND_HALF_EVEN</span> <span class="o">=</span> <span class="n">_round_half_even</span><span class="p">,</span>
        <span class="n">ROUND_CEILING</span> <span class="o">=</span> <span class="n">_round_ceiling</span><span class="p">,</span>
        <span class="n">ROUND_FLOOR</span> <span class="o">=</span> <span class="n">_round_floor</span><span class="p">,</span>
        <span class="n">ROUND_05UP</span> <span class="o">=</span> <span class="n">_round_05up</span><span class="p">,</span>
    <span class="p">)</span>

<div class="viewcode-block" id="Decimal.fma"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.fma">[docs]</a>    <span class="k">def</span> <span class="nf">fma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">third</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fused multiply-add.</span>

<span class="sd">        Returns self*other+third with no rounding of the intermediate</span>
<span class="sd">        product self*other.</span>

<span class="sd">        self and other are multiplied together, with no rounding of</span>
<span class="sd">        the result.  The third operand is then added to the result,</span>
<span class="sd">        and a single final rounding is performed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># compute product; raise InvalidOperation if either operand is</span>
        <span class="c1"># a signaling NaN or if the product is zero times infinity.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;sNaN&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;sNaN&#39;</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                <span class="n">product</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">elif</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                <span class="n">product</span> <span class="o">=</span> <span class="n">other</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                                <span class="s1">&#39;INF * 0 in fma&#39;</span><span class="p">)</span>
                <span class="n">product</span> <span class="o">=</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                                <span class="s1">&#39;0 * INF in fma&#39;</span><span class="p">)</span>
                <span class="n">product</span> <span class="o">=</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">product</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span>
                                       <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_int</span><span class="p">)),</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>

        <span class="n">third</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">third</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">product</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">third</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_power_modulo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">modulo</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Three argument version of __pow__&quot;&quot;&quot;</span>

        <span class="c1"># if can&#39;t convert other and modulo to Decimal, raise</span>
        <span class="c1"># TypeError; there&#39;s no point returning NotImplemented (no</span>
        <span class="c1"># equivalent of __rpow__ for three argument pow)</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">modulo</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">modulo</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="c1"># deal with NaNs: if there are any sNaNs then first one wins,</span>
        <span class="c1"># (i.e. behaviour for NaNs is identical to that of fma)</span>
        <span class="n">self_is_nan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
        <span class="n">other_is_nan</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
        <span class="n">modulo_is_nan</span> <span class="o">=</span> <span class="n">modulo</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">self_is_nan</span> <span class="ow">or</span> <span class="n">other_is_nan</span> <span class="ow">or</span> <span class="n">modulo_is_nan</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">self_is_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;sNaN&#39;</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other_is_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;sNaN&#39;</span><span class="p">,</span>
                                        <span class="n">other</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">modulo_is_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;sNaN&#39;</span><span class="p">,</span>
                                        <span class="n">modulo</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">self_is_nan</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_nan</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other_is_nan</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_fix_nan</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">modulo</span><span class="o">.</span><span class="n">_fix_nan</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="c1"># check inputs: we apply same restrictions as Python&#39;s pow()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">()</span> <span class="ow">and</span>
                <span class="n">other</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">()</span> <span class="ow">and</span>
                <span class="n">modulo</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">()):</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;pow() 3rd argument not allowed &#39;</span>
                                        <span class="s1">&#39;unless all arguments are integers&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;pow() 2nd argument cannot be &#39;</span>
                                        <span class="s1">&#39;negative when 3rd argument specified&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modulo</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;pow() 3rd argument cannot be 0&#39;</span><span class="p">)</span>

        <span class="c1"># additional restriction for decimal: the modulus must be less</span>
        <span class="c1"># than 10**prec in absolute value</span>
        <span class="k">if</span> <span class="n">modulo</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;insufficient precision: pow() 3rd &#39;</span>
                                        <span class="s1">&#39;argument must not have more than &#39;</span>
                                        <span class="s1">&#39;precision digits&#39;</span><span class="p">)</span>

        <span class="c1"># define 0**0 == NaN, for consistency with two-argument pow</span>
        <span class="c1"># (even though it hurts!)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;at least one of pow() 1st argument &#39;</span>
                                        <span class="s1">&#39;and 2nd argument must be nonzero ;&#39;</span>
                                        <span class="s1">&#39;0**0 is not defined&#39;</span><span class="p">)</span>

        <span class="c1"># compute sign of result</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_iseven</span><span class="p">():</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>

        <span class="c1"># convert modulo to a Python integer, and self and other to</span>
        <span class="c1"># Decimal integers (i.e. force their exponents to be &gt;= 0)</span>
        <span class="n">modulo</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">modulo</span><span class="p">))</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">())</span>
        <span class="n">exponent</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">())</span>

        <span class="c1"># compute result using integer pow()</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">int</span> <span class="o">%</span> <span class="n">modulo</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">modulo</span><span class="p">))</span> <span class="o">%</span> <span class="n">modulo</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">exponent</span><span class="o">.</span><span class="n">exp</span><span class="p">):</span>
            <span class="n">base</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">modulo</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">exponent</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">modulo</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">base</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_power_exact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attempt to compute self**other exactly.</span>

<span class="sd">        Given Decimals self and other and an integer p, attempt to</span>
<span class="sd">        compute an exact result for the power self**other, with p</span>
<span class="sd">        digits of precision.  Return None if self**other is not</span>
<span class="sd">        exactly representable in p digits.</span>

<span class="sd">        Assumes that elimination of special cases has already been</span>
<span class="sd">        performed: self and other must both be nonspecial; self must</span>
<span class="sd">        be positive and not numerically equal to 1; other must be</span>
<span class="sd">        nonzero.  For efficiency, other._exp should not be too large,</span>
<span class="sd">        so that 10**abs(other._exp) is a feasible calculation.&quot;&quot;&quot;</span>

        <span class="c1"># In the comments below, we write x for the value of self and y for the</span>
        <span class="c1"># value of other.  Write x = xc*10**xe and abs(y) = yc*10**ye, with xc</span>
        <span class="c1"># and yc positive integers not divisible by 10.</span>

        <span class="c1"># The main purpose of this method is to identify the *failure*</span>
        <span class="c1"># of x**y to be exactly representable with as little effort as</span>
        <span class="c1"># possible.  So we look for cheap and easy tests that</span>
        <span class="c1"># eliminate the possibility of x**y being exact.  Only if all</span>
        <span class="c1"># these tests are passed do we go on to actually compute x**y.</span>

        <span class="c1"># Here&#39;s the main idea.  Express y as a rational number m/n, with m and</span>
        <span class="c1"># n relatively prime and n&gt;0.  Then for x**y to be exactly</span>
        <span class="c1"># representable (at *any* precision), xc must be the nth power of a</span>
        <span class="c1"># positive integer and xe must be divisible by n.  If y is negative</span>
        <span class="c1"># then additionally xc must be a power of either 2 or 5, hence a power</span>
        <span class="c1"># of 2**n or 5**n.</span>
        <span class="c1">#</span>
        <span class="c1"># There&#39;s a limit to how small |y| can be: if y=m/n as above</span>
        <span class="c1"># then:</span>
        <span class="c1">#</span>
        <span class="c1">#  (1) if xc != 1 then for the result to be representable we</span>
        <span class="c1">#      need xc**(1/n) &gt;= 2, and hence also xc**|y| &gt;= 2.  So</span>
        <span class="c1">#      if |y| &lt;= 1/nbits(xc) then xc &lt; 2**nbits(xc) &lt;=</span>
        <span class="c1">#      2**(1/|y|), hence xc**|y| &lt; 2 and the result is not</span>
        <span class="c1">#      representable.</span>
        <span class="c1">#</span>
        <span class="c1">#  (2) if xe != 0, |xe|*(1/n) &gt;= 1, so |xe|*|y| &gt;= 1.  Hence if</span>
        <span class="c1">#      |y| &lt; 1/|xe| then the result is not representable.</span>
        <span class="c1">#</span>
        <span class="c1"># Note that since x is not equal to 1, at least one of (1) and</span>
        <span class="c1"># (2) must apply.  Now |y| &lt; 1/nbits(xc) iff |yc|*nbits(xc) &lt;</span>
        <span class="c1"># 10**-ye iff len(str(|yc|*nbits(xc)) &lt;= -ye.</span>
        <span class="c1">#</span>
        <span class="c1"># There&#39;s also a limit to how large y can be, at least if it&#39;s</span>
        <span class="c1"># positive: the normalized result will have coefficient xc**y,</span>
        <span class="c1"># so if it&#39;s representable then xc**y &lt; 10**p, and y &lt;</span>
        <span class="c1"># p/log10(xc).  Hence if y*log10(xc) &gt;= p then the result is</span>
        <span class="c1"># not exactly representable.</span>

        <span class="c1"># if len(str(abs(yc*xe)) &lt;= -ye then abs(yc*xe) &lt; 10**-ye,</span>
        <span class="c1"># so |y| &lt; 1/xe and the result is not representable.</span>
        <span class="c1"># Similarly, len(str(abs(yc)*xc_bits)) &lt;= -ye implies |y|</span>
        <span class="c1"># &lt; 1/nbits(xc).</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">xc</span><span class="p">,</span> <span class="n">xe</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">exp</span>
        <span class="k">while</span> <span class="n">xc</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">xc</span> <span class="o">//=</span> <span class="mi">10</span>
            <span class="n">xe</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">yc</span><span class="p">,</span> <span class="n">ye</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">exp</span>
        <span class="k">while</span> <span class="n">yc</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">yc</span> <span class="o">//=</span> <span class="mi">10</span>
            <span class="n">ye</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># case where xc == 1: result is 10**(xe*y), with xe*y</span>
        <span class="c1"># required to be an integer</span>
        <span class="k">if</span> <span class="n">xc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">xe</span> <span class="o">*=</span> <span class="n">yc</span>
            <span class="c1"># result is now 10**(xe * 10**ye);  xe * 10**ye must be integral</span>
            <span class="k">while</span> <span class="n">xe</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xe</span> <span class="o">//=</span> <span class="mi">10</span>
                <span class="n">ye</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">ye</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="n">exponent</span> <span class="o">=</span> <span class="n">xe</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">ye</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">exponent</span> <span class="o">=</span> <span class="o">-</span><span class="n">exponent</span>
            <span class="c1"># if other is a nonnegative integer, use ideal exponent</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">()</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ideal_exponent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
                <span class="n">zeros</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">exponent</span><span class="o">-</span><span class="n">ideal_exponent</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">zeros</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">zeros</span><span class="p">,</span> <span class="n">exponent</span><span class="o">-</span><span class="n">zeros</span><span class="p">)</span>

        <span class="c1"># case where y is negative: xc must be either a power</span>
        <span class="c1"># of 2 or a power of 5.</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">last_digit</span> <span class="o">=</span> <span class="n">xc</span> <span class="o">%</span> <span class="mi">10</span>
            <span class="k">if</span> <span class="n">last_digit</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span>
                <span class="c1"># quick test for power of 2</span>
                <span class="k">if</span> <span class="n">xc</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">xc</span> <span class="o">!=</span> <span class="n">xc</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
                <span class="c1"># now xc is a power of 2; e is its exponent</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">_nbits</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

                <span class="c1"># We now have:</span>
                <span class="c1">#</span>
                <span class="c1">#   x = 2**e * 10**xe, e &gt; 0, and y &lt; 0.</span>
                <span class="c1">#</span>
                <span class="c1"># The exact result is:</span>
                <span class="c1">#</span>
                <span class="c1">#   x**y = 5**(-e*y) * 10**(e*y + xe*y)</span>
                <span class="c1">#</span>
                <span class="c1"># provided that both e*y and xe*y are integers.  Note that if</span>
                <span class="c1"># 5**(-e*y) &gt;= 10**p, then the result can&#39;t be expressed</span>
                <span class="c1"># exactly with p digits of precision.</span>
                <span class="c1">#</span>
                <span class="c1"># Using the above, we can guard against large values of ye.</span>
                <span class="c1"># 93/65 is an upper bound for log(10)/log(5), so if</span>
                <span class="c1">#</span>
                <span class="c1">#   ye &gt;= len(str(93*p//65))</span>
                <span class="c1">#</span>
                <span class="c1"># then</span>
                <span class="c1">#</span>
                <span class="c1">#   -e*y &gt;= -y &gt;= 10**ye &gt; 93*p/65 &gt; p*log(10)/log(5),</span>
                <span class="c1">#</span>
                <span class="c1"># so 5**(-e*y) &gt;= 10**p, and the coefficient of the result</span>
                <span class="c1"># can&#39;t be expressed in p digits.</span>

                <span class="c1"># emax &gt;= largest e such that 5**e &lt; 10**p.</span>
                <span class="n">emax</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="mi">93</span><span class="o">//</span><span class="mi">65</span>
                <span class="k">if</span> <span class="n">ye</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">emax</span><span class="p">)):</span>
                    <span class="k">return</span> <span class="bp">None</span>

                <span class="c1"># Find -e*y and -xe*y; both must be integers</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">_decimal_lshift_exact</span><span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">yc</span><span class="p">,</span> <span class="n">ye</span><span class="p">)</span>
                <span class="n">xe</span> <span class="o">=</span> <span class="n">_decimal_lshift_exact</span><span class="p">(</span><span class="n">xe</span> <span class="o">*</span> <span class="n">yc</span><span class="p">,</span> <span class="n">ye</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">xe</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>

                <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;</span> <span class="n">emax</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="mi">5</span><span class="o">**</span><span class="n">e</span>

            <span class="k">elif</span> <span class="n">last_digit</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="c1"># e &gt;= log_5(xc) if xc is a power of 5; we have</span>
                <span class="c1"># equality all the way up to xc=5**2658</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">_nbits</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span><span class="o">*</span><span class="mi">28</span><span class="o">//</span><span class="mi">65</span>
                <span class="n">xc</span><span class="p">,</span> <span class="n">remainder</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="n">e</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">remainder</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
                <span class="k">while</span> <span class="n">xc</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">xc</span> <span class="o">//=</span> <span class="mi">5</span>
                    <span class="n">e</span> <span class="o">-=</span> <span class="mi">1</span>

                <span class="c1"># Guard against large values of ye, using the same logic as in</span>
                <span class="c1"># the &#39;xc is a power of 2&#39; branch.  10/3 is an upper bound for</span>
                <span class="c1"># log(10)/log(2).</span>
                <span class="n">emax</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="mi">10</span><span class="o">//</span><span class="mi">3</span>
                <span class="k">if</span> <span class="n">ye</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">emax</span><span class="p">)):</span>
                    <span class="k">return</span> <span class="bp">None</span>

                <span class="n">e</span> <span class="o">=</span> <span class="n">_decimal_lshift_exact</span><span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">yc</span><span class="p">,</span> <span class="n">ye</span><span class="p">)</span>
                <span class="n">xe</span> <span class="o">=</span> <span class="n">_decimal_lshift_exact</span><span class="p">(</span><span class="n">xe</span> <span class="o">*</span> <span class="n">yc</span><span class="p">,</span> <span class="n">ye</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">xe</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>

                <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;</span> <span class="n">emax</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">e</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>

            <span class="k">if</span> <span class="n">xc</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="o">**</span><span class="n">p</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="n">xe</span> <span class="o">=</span> <span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">xe</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">xc</span><span class="p">),</span> <span class="n">xe</span><span class="p">)</span>

        <span class="c1"># now y is positive; find m and n such that y = m/n</span>
        <span class="k">if</span> <span class="n">ye</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">yc</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">ye</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xe</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">yc</span><span class="o">*</span><span class="n">xe</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">ye</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="n">xc_bits</span> <span class="o">=</span> <span class="n">_nbits</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xc</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="n">xc_bits</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">ye</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">yc</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">ye</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">m</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">//=</span> <span class="mi">2</span>
                <span class="n">n</span> <span class="o">//=</span> <span class="mi">2</span>
            <span class="k">while</span> <span class="n">m</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">//=</span> <span class="mi">5</span>
                <span class="n">n</span> <span class="o">//=</span> <span class="mi">5</span>

        <span class="c1"># compute nth root of xc*10**xe</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># if 1 &lt; xc &lt; 2**n then xc isn&#39;t an nth power</span>
            <span class="k">if</span> <span class="n">xc</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">xc_bits</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>

            <span class="n">xe</span><span class="p">,</span> <span class="n">rem</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">xe</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rem</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>

            <span class="c1"># compute nth root of xc using Newton&#39;s method</span>
            <span class="n">a</span> <span class="o">=</span> <span class="il">1L</span> <span class="o">&lt;&lt;</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">_nbits</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span><span class="o">//</span><span class="n">n</span><span class="p">)</span> <span class="c1"># initial estimate</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">a</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span><span class="o">//</span><span class="n">n</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">q</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="n">xc</span> <span class="o">=</span> <span class="n">a</span>

        <span class="c1"># now xc*10**xe is the nth root of the original xc*10**xe</span>
        <span class="c1"># compute mth power of xc*10**xe</span>

        <span class="c1"># if m &gt; p*100//_log10_lb(xc) then m &gt; p/log10(xc), hence xc**m &gt;</span>
        <span class="c1"># 10**p and the result is not representable.</span>
        <span class="k">if</span> <span class="n">xc</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="o">//</span><span class="n">_log10_lb</span><span class="p">(</span><span class="n">xc</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span><span class="o">**</span><span class="n">m</span>
        <span class="n">xe</span> <span class="o">*=</span> <span class="n">m</span>
        <span class="k">if</span> <span class="n">xc</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="n">p</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="c1"># by this point the result *is* exactly representable</span>
        <span class="c1"># adjust the exponent to get as close as possible to the ideal</span>
        <span class="c1"># exponent, if necessary</span>
        <span class="n">str_xc</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">()</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ideal_exponent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="n">zeros</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xe</span><span class="o">-</span><span class="n">ideal_exponent</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">str_xc</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zeros</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">str_xc</span><span class="o">+</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">zeros</span><span class="p">,</span> <span class="n">xe</span><span class="o">-</span><span class="n">zeros</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">modulo</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return self ** other [ % modulo].</span>

<span class="sd">        With two arguments, compute self**other.</span>

<span class="sd">        With three arguments, compute (self**other) % modulo.  For the</span>
<span class="sd">        three argument form, the following restrictions on the</span>
<span class="sd">        arguments hold:</span>

<span class="sd">         - all three arguments must be integral</span>
<span class="sd">         - other must be nonnegative</span>
<span class="sd">         - either self or other (or both) must be nonzero</span>
<span class="sd">         - modulo must be nonzero and must have at most p digits,</span>
<span class="sd">           where p is the context precision.</span>

<span class="sd">        If any of these restrictions is violated the InvalidOperation</span>
<span class="sd">        flag is raised.</span>

<span class="sd">        The result of pow(self, other, modulo) is identical to the</span>
<span class="sd">        result that would be obtained by computing (self**other) %</span>
<span class="sd">        modulo with unbounded precision, but is computed more</span>
<span class="sd">        efficiently.  It is always exact.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">modulo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_power_modulo</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">modulo</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="c1"># either argument is a NaN =&gt; result is NaN</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="c1"># 0**0 = NaN (!), x**0 = 1 for nonzero x (including +/-Infinity)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;0 ** 0&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_One</span>

        <span class="c1"># result has sign 1 iff self._sign is 1 and other is an odd integer</span>
        <span class="n">result_sign</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">other</span><span class="o">.</span><span class="n">_iseven</span><span class="p">():</span>
                    <span class="n">result_sign</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># -ve**noninteger = NaN</span>
                <span class="c1"># (-0)**noninteger = 0**noninteger</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                        <span class="s1">&#39;x ** y with x negative and y not an integer&#39;</span><span class="p">)</span>
            <span class="c1"># negate self, without doing any unwanted rounding</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">()</span>

        <span class="c1"># 0**(+ve or Inf)= 0; 0**(-ve or -Inf) = Infinity</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">result_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">result_sign</span><span class="p">]</span>

        <span class="c1"># Inf**(+ve or Inf) = Inf; Inf**(-ve or -Inf) = 0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">result_sign</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">result_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># 1**other = 1, but the choice of exponent and the flags</span>
        <span class="c1"># depend on the exponent of self, and on whether other is a</span>
        <span class="c1"># positive integer, a negative integer, or neither</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">_One</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">():</span>
                <span class="c1"># exp = max(self._exp*max(int(other), 0),</span>
                <span class="c1"># 1-context.prec) but evaluating int(other) directly</span>
                <span class="c1"># is dangerous until we know other is small (other</span>
                <span class="c1"># could be 1e999999999)</span>
                <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">multiplier</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">elif</span> <span class="n">other</span> <span class="o">&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
                    <span class="n">multiplier</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">multiplier</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

                <span class="n">exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">*</span> <span class="n">multiplier</span>
                <span class="k">if</span> <span class="n">exp</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
                    <span class="n">exp</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>
                <span class="n">exp</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span>

            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">result_sign</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="o">+</span><span class="s1">&#39;0&#39;</span><span class="o">*-</span><span class="n">exp</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>

        <span class="c1"># compute adjusted exponent of self</span>
        <span class="n">self_adj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span>

        <span class="c1"># self ** infinity is infinity if self &gt; 1, 0 if self &lt; 1</span>
        <span class="c1"># self ** -infinity is infinity if self &lt; 1, 0 if self &gt; 1</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">self_adj</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">result_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_SignedInfinity</span><span class="p">[</span><span class="n">result_sign</span><span class="p">]</span>

        <span class="c1"># from here on, the result always goes through the call</span>
        <span class="c1"># to _fix at the end of this function.</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">exact</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c1"># crude test to catch cases of extreme overflow/underflow.  If</span>
        <span class="c1"># log10(self)*other &gt;= 10**bound and bound &gt;= len(str(Emax))</span>
        <span class="c1"># then 10**bound &gt;= 10**len(str(Emax)) &gt;= Emax+1 and hence</span>
        <span class="c1"># self**other &gt;= 10**(Emax+1), so overflow occurs.  The test</span>
        <span class="c1"># for underflow is similar.</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log10_exp_bound</span><span class="p">()</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">self_adj</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># self &gt; 1 and other +ve, or self &lt; 1 and other -ve</span>
            <span class="c1"># possibility of overflow</span>
            <span class="k">if</span> <span class="n">bound</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="p">)):</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">result_sign</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># self &gt; 1 and other -ve, or self &lt; 1 and other +ve</span>
            <span class="c1"># possibility of underflow to 0</span>
            <span class="n">Etiny</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">Etiny</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">bound</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">Etiny</span><span class="p">)):</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">result_sign</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">Etiny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># try for an exact result with precision +1</span>
        <span class="k">if</span> <span class="n">ans</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_power_exact</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">result_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ans</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">ans</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>
                <span class="n">exact</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1"># usual case: inexact result, x**y computed directly as exp(y*log(x))</span>
        <span class="k">if</span> <span class="n">ans</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">xc</span><span class="p">,</span> <span class="n">xe</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">exp</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="n">yc</span><span class="p">,</span> <span class="n">ye</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">exp</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">yc</span> <span class="o">=</span> <span class="o">-</span><span class="n">yc</span>

            <span class="c1"># compute correctly rounded result:  start with precision +3,</span>
            <span class="c1"># then increase precision until result is unambiguously roundable</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">coeff</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">_dpower</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">ye</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="n">extra</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">coeff</span> <span class="o">%</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coeff</span><span class="p">))</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="k">break</span>
                <span class="n">extra</span> <span class="o">+=</span> <span class="mi">3</span>

            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">result_sign</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coeff</span><span class="p">),</span> <span class="n">exp</span><span class="p">)</span>

        <span class="c1"># unlike exp, ln and log10, the power function respects the</span>
        <span class="c1"># rounding mode; no need to switch to ROUND_HALF_EVEN here</span>

        <span class="c1"># There&#39;s a difficulty here when &#39;other&#39; is not an integer and</span>
        <span class="c1"># the result is exact.  In this case, the specification</span>
        <span class="c1"># requires that the Inexact flag be raised (in spite of</span>
        <span class="c1"># exactness), but since the result is exact _fix won&#39;t do this</span>
        <span class="c1"># for us.  (Correspondingly, the Underflow signal should also</span>
        <span class="c1"># be raised for subnormal results.)  We can&#39;t directly raise</span>
        <span class="c1"># these signals either before or after calling _fix, since</span>
        <span class="c1"># that would violate the precedence for signals.  So we wrap</span>
        <span class="c1"># the ._fix call in a temporary context, and reraise</span>
        <span class="c1"># afterwards.</span>
        <span class="k">if</span> <span class="n">exact</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">other</span><span class="o">.</span><span class="n">_isinteger</span><span class="p">():</span>
            <span class="c1"># pad with zeros up to length context.prec+1 if necessary; this</span>
            <span class="c1"># ensures that the Rounded signal will be raised.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ans</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
                <span class="n">expdiff</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">ans</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">ans</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">ans</span><span class="o">.</span><span class="n">_int</span><span class="o">+</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">expdiff</span><span class="p">,</span>
                                       <span class="n">ans</span><span class="o">.</span><span class="n">_exp</span><span class="o">-</span><span class="n">expdiff</span><span class="p">)</span>

            <span class="c1"># create a copy of the current context, with cleared flags/traps</span>
            <span class="n">newcontext</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">newcontext</span><span class="o">.</span><span class="n">clear_flags</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">exception</span> <span class="ow">in</span> <span class="n">_signals</span><span class="p">:</span>
                <span class="n">newcontext</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">exception</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># round in the new context</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">newcontext</span><span class="p">)</span>

            <span class="c1"># raise Inexact, and if necessary, Underflow</span>
            <span class="n">newcontext</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">newcontext</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Subnormal</span><span class="p">]:</span>
                <span class="n">newcontext</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Underflow</span><span class="p">)</span>

            <span class="c1"># propagate signals to the original context; _fix could</span>
            <span class="c1"># have raised any of Overflow, Underflow, Subnormal,</span>
            <span class="c1"># Inexact, Rounded, Clamped.  Overflow needs the correct</span>
            <span class="c1"># arguments.  Note that the order of the exceptions is</span>
            <span class="c1"># important here.</span>
            <span class="k">if</span> <span class="n">newcontext</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">Overflow</span><span class="p">]:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span> <span class="s1">&#39;above Emax&#39;</span><span class="p">,</span> <span class="n">ans</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">exception</span> <span class="ow">in</span> <span class="n">Underflow</span><span class="p">,</span> <span class="n">Subnormal</span><span class="p">,</span> <span class="n">Inexact</span><span class="p">,</span> <span class="n">Rounded</span><span class="p">,</span> <span class="n">Clamped</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">newcontext</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">exception</span><span class="p">]:</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Swaps self/other and returns __pow__.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span>
        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

<div class="viewcode-block" id="Decimal.normalize"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.normalize">[docs]</a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalize- strip trailing 0s, change anything equal to 0 to 0e0&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

        <span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dup</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">dup</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">dup</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">dup</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">exp_max</span> <span class="o">=</span> <span class="p">[</span><span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Etop</span><span class="p">()][</span><span class="n">context</span><span class="o">.</span><span class="n">_clamp</span><span class="p">]</span>
        <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dup</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">dup</span><span class="o">.</span><span class="n">_exp</span>
        <span class="k">while</span> <span class="n">dup</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="n">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span> <span class="ow">and</span> <span class="n">exp</span> <span class="o">&lt;</span> <span class="n">exp_max</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">end</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">dup</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">dup</span><span class="o">.</span><span class="n">_int</span><span class="p">[:</span><span class="n">end</span><span class="p">],</span> <span class="n">exp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.quantize"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.quantize">[docs]</a>    <span class="k">def</span> <span class="nf">quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">watchexp</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Quantize self so its exponent is the same as that of exp.</span>

<span class="sd">        Similar to self._rescale(exp._exp) but with error checking.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rounding</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rounding</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">exp</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
                    <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># if both are inf, it is OK</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;quantize with one INF&#39;</span><span class="p">)</span>

        <span class="c1"># if we&#39;re not watching exponents, do a simple rescale</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">watchexp</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>
            <span class="c1"># raise Inexact and Rounded where appropriate</span>
            <span class="k">if</span> <span class="n">ans</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="c1"># exp._exp should be between Etiny and Emax</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Etiny</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">exp</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&lt;=</span> <span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                   <span class="s1">&#39;target exponent out of bounds in quantize&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="n">self_adjusted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">self_adjusted</span> <span class="o">&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;exponent of quantize result too large for current context&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">self_adjusted</span> <span class="o">-</span> <span class="n">exp</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;quantize result has too many digits for current context&#39;</span><span class="p">)</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;exponent of quantize result too large for current context&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ans</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;quantize result has too many digits for current context&#39;</span><span class="p">)</span>

        <span class="c1"># raise appropriate flags</span>
        <span class="k">if</span> <span class="n">ans</span> <span class="ow">and</span> <span class="n">ans</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">context</span><span class="o">.</span><span class="n">Emin</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Subnormal</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>

        <span class="c1"># call to fix takes care of any necessary folddown, and</span>
        <span class="c1"># signals Clamped if necessary</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="Decimal.same_quantum"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.same_quantum">[docs]</a>    <span class="k">def</span> <span class="nf">same_quantum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self and other have the same exponent; otherwise</span>
<span class="sd">        return False.</span>

<span class="sd">        If either operand is a special value, the following rules are used:</span>
<span class="sd">           * return True if both operands are infinities</span>
<span class="sd">           * return True if both operands are NaNs</span>
<span class="sd">           * otherwise, return False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_nan</span><span class="p">()</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">is_nan</span><span class="p">()</span> <span class="ow">or</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">()</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span></div>

    <span class="k">def</span> <span class="nf">_rescale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">rounding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rescale self so that the exponent is exp, either by padding with zeros</span>
<span class="sd">        or by truncating digits, using the given rounding mode.</span>

<span class="sd">        Specials are returned without change.  This operation is</span>
<span class="sd">        quiet: it raises no flags, and uses no information from the</span>
<span class="sd">        context.</span>

<span class="sd">        exp = exp to scale to (an integer)</span>
<span class="sd">        rounding = rounding mode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;=</span> <span class="n">exp</span><span class="p">:</span>
            <span class="c1"># pad answer with zeros if necessary</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">exp</span><span class="p">),</span> <span class="n">exp</span><span class="p">)</span>

        <span class="c1"># too many digits; round and lose data.  If self.adjusted() &lt;</span>
        <span class="c1"># exp-1, replace self by 10**(exp-1) before rounding</span>
        <span class="n">digits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">-</span> <span class="n">exp</span>
        <span class="k">if</span> <span class="n">digits</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">digits</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">this_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pick_rounding_function</span><span class="p">[</span><span class="n">rounding</span><span class="p">]</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="n">this_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span>
        <span class="n">coeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[:</span><span class="n">digits</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span>
        <span class="k">if</span> <span class="n">changed</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">places</span><span class="p">,</span> <span class="n">rounding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Round a nonzero, nonspecial Decimal to a fixed number of</span>
<span class="sd">        significant figures, using the given rounding mode.</span>

<span class="sd">        Infinities, NaNs and zeros are returned unaltered.</span>

<span class="sd">        This operation is quiet: it raises no flags, and uses no</span>
<span class="sd">        information from the context.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">places</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;argument should be at least 1 in _round&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">places</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>
        <span class="c1"># it can happen that the rescale alters the adjusted exponent;</span>
        <span class="c1"># for example when rounding 99.97 to 3 significant figures.</span>
        <span class="c1"># When this happens we end up with an extra 0 at the end of</span>
        <span class="c1"># the number; a second rescale fixes this.</span>
        <span class="k">if</span> <span class="n">ans</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">():</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="n">ans</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">places</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span>

<div class="viewcode-block" id="Decimal.to_integral_exact"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.to_integral_exact">[docs]</a>    <span class="k">def</span> <span class="nf">to_integral_exact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rounds to a nearby integer.</span>

<span class="sd">        If no rounding mode is specified, take the rounding mode from</span>
<span class="sd">        the context.  This method raises the Rounded and Inexact flags</span>
<span class="sd">        when appropriate.</span>

<span class="sd">        See also: to_integral_value, which does exactly the same as</span>
<span class="sd">        this method except that it doesn&#39;t raise Inexact or Rounded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rounding</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rounding</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="Decimal.to_integral_value"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.to_integral_value">[docs]</a>    <span class="k">def</span> <span class="nf">to_integral_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rounds to the nearest integer, without raising inexact, rounded.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rounding</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rounding</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span></div>

    <span class="c1"># the method name changed, but we provide also the old one, for compatibility</span>
    <span class="n">to_integral</span> <span class="o">=</span> <span class="n">to_integral_value</span>

<div class="viewcode-block" id="Decimal.sqrt"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.sqrt">[docs]</a>    <span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the square root of self.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="c1"># exponent = self._exp // 2.  sqrt(-0) = -0</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span> <span class="s1">&#39;sqrt(-x), x &gt; 0&#39;</span><span class="p">)</span>

        <span class="c1"># At this point self represents a positive number.  Let p be</span>
        <span class="c1"># the desired precision and express self in the form c*100**e</span>
        <span class="c1"># with c a positive real number and e an integer, c and e</span>
        <span class="c1"># being chosen so that 100**(p-1) &lt;= c &lt; 100**p.  Then the</span>
        <span class="c1"># (exact) square root of self is sqrt(c)*10**e, and 10**(p-1)</span>
        <span class="c1"># &lt;= sqrt(c) &lt; 10**p, so the closest representable Decimal at</span>
        <span class="c1"># precision p is n*10**e where n = round_half_even(sqrt(c)),</span>
        <span class="c1"># the closest integer to sqrt(c) with the even integer chosen</span>
        <span class="c1"># in the case of a tie.</span>
        <span class="c1">#</span>
        <span class="c1"># To ensure correct rounding in all cases, we use the</span>
        <span class="c1"># following trick: we compute the square root to an extra</span>
        <span class="c1"># place (precision p+1 instead of precision p), rounding down.</span>
        <span class="c1"># Then, if the result is inexact and its last digit is 0 or 5,</span>
        <span class="c1"># we increase the last digit to 1 or 6 respectively; if it&#39;s</span>
        <span class="c1"># exact we leave the last digit alone.  Now the final round to</span>
        <span class="c1"># p places (or fewer in the case of underflow) will round</span>
        <span class="c1"># correctly and raise the appropriate flags.</span>

        <span class="c1"># use an extra digit of precision</span>
        <span class="n">prec</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="o">+</span><span class="mi">1</span>

        <span class="c1"># write argument in the form c*100**e where e = self._exp//2</span>
        <span class="c1"># is the &#39;ideal&#39; exponent, to be used if the square root is</span>
        <span class="c1"># exactly representable.  l is the number of &#39;digits&#39; of c in</span>
        <span class="c1"># base 100, so that 100**(l-1) &lt;= c &lt; 100**l.</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">exp</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">exp</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">int</span> <span class="o">*</span> <span class="mi">10</span>
            <span class="n">l</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">int</span>
            <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>

        <span class="c1"># rescale so that c has exactly prec base 100 &#39;digits&#39;</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">prec</span><span class="o">-</span><span class="n">l</span>
        <span class="k">if</span> <span class="n">shift</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">*=</span> <span class="mi">100</span><span class="o">**</span><span class="n">shift</span>
            <span class="n">exact</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span><span class="p">,</span> <span class="n">remainder</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">100</span><span class="o">**-</span><span class="n">shift</span><span class="p">)</span>
            <span class="n">exact</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">remainder</span>
        <span class="n">e</span> <span class="o">-=</span> <span class="n">shift</span>

        <span class="c1"># find n = floor(sqrt(c)) using Newton&#39;s method</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">prec</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">c</span><span class="o">//</span><span class="n">n</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">q</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
        <span class="n">exact</span> <span class="o">=</span> <span class="n">exact</span> <span class="ow">and</span> <span class="n">n</span><span class="o">*</span><span class="n">n</span> <span class="o">==</span> <span class="n">c</span>

        <span class="k">if</span> <span class="n">exact</span><span class="p">:</span>
            <span class="c1"># result is exact; rescale to use ideal exponent e</span>
            <span class="k">if</span> <span class="n">shift</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># assert n % 10**shift == 0</span>
                <span class="n">n</span> <span class="o">//=</span> <span class="mi">10</span><span class="o">**</span><span class="n">shift</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">*=</span> <span class="mi">10</span><span class="o">**-</span><span class="n">shift</span>
            <span class="n">e</span> <span class="o">+=</span> <span class="n">shift</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># result is not exact; fix last digit as described above</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">e</span><span class="p">)</span>

        <span class="c1"># round, and fit to current context</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_shallow_copy</span><span class="p">()</span>
        <span class="n">rounding</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_set_rounding</span><span class="p">(</span><span class="n">ROUND_HALF_EVEN</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">rounding</span>

        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="Decimal.max"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.max">[docs]</a>    <span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the larger value.</span>

<span class="sd">        Like max(self, other) except if one is not a number, returns</span>
<span class="sd">        NaN (and signals if one is sNaN).  Also rounds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="c1"># If one operand is a quiet NaN and the other is number, then the</span>
            <span class="c1"># number is always returned</span>
            <span class="n">sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">sn</span> <span class="ow">or</span> <span class="n">on</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sn</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># If both operands are finite and equal in numerical value</span>
            <span class="c1"># then an ordering is applied:</span>
            <span class="c1">#</span>
            <span class="c1"># If the signs differ then max returns the operand with the</span>
            <span class="c1"># positive sign and min returns the operand with the negative sign</span>
            <span class="c1">#</span>
            <span class="c1"># If the signs are the same then the exponent is used to select</span>
            <span class="c1"># the result.  This is exactly the ordering used in compare_total.</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.min"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.min">[docs]</a>    <span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the smaller value.</span>

<span class="sd">        Like min(self, other) except if one is not a number, returns</span>
<span class="sd">        NaN (and signals if one is sNaN).  Also rounds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="c1"># If one operand is a quiet NaN and the other is number, then the</span>
            <span class="c1"># number is always returned</span>
            <span class="n">sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">sn</span> <span class="ow">or</span> <span class="n">on</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sn</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_isinteger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns whether self is an integer&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">rest</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_iseven</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if self is even.  Assumes self is an integer.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;02468&#39;</span>

<div class="viewcode-block" id="Decimal.adjusted"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.adjusted">[docs]</a>    <span class="k">def</span> <span class="nf">adjusted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the adjusted exponent of self&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="c1"># If NaN or Infinity, self._exp is string</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Decimal.canonical"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.canonical">[docs]</a>    <span class="k">def</span> <span class="nf">canonical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the same Decimal object.</span>

<span class="sd">        As we do not have different encodings for the same number, the</span>
<span class="sd">        received object already is in its canonical form.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Decimal.compare_signal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.compare_signal">[docs]</a>    <span class="k">def</span> <span class="nf">compare_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares self to the other operand numerically.</span>

<span class="sd">        It&#39;s pretty much like compare(), but all NaNs signal, with signaling</span>
<span class="sd">        NaNs taking precedence over quiet NaNs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.compare_total"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.compare_total">[docs]</a>    <span class="k">def</span> <span class="nf">compare_total</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares self to other using the abstract representations.</span>

<span class="sd">        This is not like the standard compare, which use their numerical</span>
<span class="sd">        value. Note that a total ordering is defined for all possible abstract</span>
<span class="sd">        representations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># if one is negative and the other is positive, it&#39;s easy</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NegativeOne</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_One</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>

        <span class="c1"># let&#39;s handle both NaN types</span>
        <span class="n">self_nan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
        <span class="n">other_nan</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">self_nan</span> <span class="ow">or</span> <span class="n">other_nan</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">self_nan</span> <span class="o">==</span> <span class="n">other_nan</span><span class="p">:</span>
                <span class="c1"># compare payloads as though they&#39;re integers</span>
                <span class="n">self_key</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>
                <span class="n">other_key</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_int</span><span class="p">),</span> <span class="n">other</span><span class="o">.</span><span class="n">_int</span>
                <span class="k">if</span> <span class="n">self_key</span> <span class="o">&lt;</span> <span class="n">other_key</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sign</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">_One</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">_NegativeOne</span>
                <span class="k">if</span> <span class="n">self_key</span> <span class="o">&gt;</span> <span class="n">other_key</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sign</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">_NegativeOne</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">_One</span>
                <span class="k">return</span> <span class="n">_Zero</span>

            <span class="k">if</span> <span class="n">sign</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">self_nan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_NegativeOne</span>
                <span class="k">if</span> <span class="n">other_nan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_One</span>
                <span class="k">if</span> <span class="n">self_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_NegativeOne</span>
                <span class="k">if</span> <span class="n">other_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_One</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">self_nan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_One</span>
                <span class="k">if</span> <span class="n">other_nan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_NegativeOne</span>
                <span class="k">if</span> <span class="n">self_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_One</span>
                <span class="k">if</span> <span class="n">other_nan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_NegativeOne</span>

        <span class="k">if</span> <span class="bp">self</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NegativeOne</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="o">&gt;</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_One</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sign</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_One</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_NegativeOne</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sign</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_NegativeOne</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_One</span>
        <span class="k">return</span> <span class="n">_Zero</span></div>


<div class="viewcode-block" id="Decimal.compare_total_mag"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.compare_total_mag">[docs]</a>    <span class="k">def</span> <span class="nf">compare_total_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares self to other using abstract repr., ignoring sign.</span>

<span class="sd">        Like compare_total, but with operand&#39;s sign ignored and assumed to be 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">o</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.copy_abs"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.copy_abs">[docs]</a>    <span class="k">def</span> <span class="nf">copy_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy with the sign set to 0. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.copy_negate"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.copy_negate">[docs]</a>    <span class="k">def</span> <span class="nf">copy_negate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy with the sign inverted.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.copy_sign"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.copy_sign">[docs]</a>    <span class="k">def</span> <span class="nf">copy_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns self with the sign of other.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.exp"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.exp">[docs]</a>    <span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns e ** self.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="c1"># exp(NaN) = NaN</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="c1"># exp(-Infinity) = 0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_Zero</span>

        <span class="c1"># exp(0) = 1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_One</span>

        <span class="c1"># exp(Infinity) = Infinity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># the result is now guaranteed to be inexact (the true</span>
        <span class="c1"># mathematical result is transcendental). There&#39;s no need to</span>
        <span class="c1"># raise Rounded and Inexact here---they&#39;ll always be raised as</span>
        <span class="c1"># a result of the call to _fix.</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span>

        <span class="c1"># we only need to do any computation for quite a small range</span>
        <span class="c1"># of adjusted exponents---for example, -29 &lt;= adj &lt;= 10 for</span>
        <span class="c1"># the default context.  For smaller exponent the result is</span>
        <span class="c1"># indistinguishable from 1 at the given precision, while for</span>
        <span class="c1"># larger exponent the result either overflows or underflows.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">adj</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">)):</span>
            <span class="c1"># overflow</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">adj</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">Etiny</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">)):</span>
            <span class="c1"># underflow to 0</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Etiny</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">adj</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">p</span><span class="p">:</span>
            <span class="c1"># p+1 digits; final round will raise correct flags</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">adj</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># p+1 digits; final round will raise correct flags</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># general case</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">exp</span>
            <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span>

            <span class="c1"># compute correctly rounded result: increase precision by</span>
            <span class="c1"># 3 digits at a time until we get an unambiguously</span>
            <span class="c1"># roundable result</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">coeff</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">_dexp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="n">extra</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">coeff</span> <span class="o">%</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coeff</span><span class="p">))</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="k">break</span>
                <span class="n">extra</span> <span class="o">+=</span> <span class="mi">3</span>

            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coeff</span><span class="p">),</span> <span class="n">exp</span><span class="p">)</span>

        <span class="c1"># at this stage, ans should round correctly with *any*</span>
        <span class="c1"># rounding mode, not just with ROUND_HALF_EVEN</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_shallow_copy</span><span class="p">()</span>
        <span class="n">rounding</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_set_rounding</span><span class="p">(</span><span class="n">ROUND_HALF_EVEN</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">rounding</span>

        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="Decimal.is_canonical"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_canonical">[docs]</a>    <span class="k">def</span> <span class="nf">is_canonical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is canonical; otherwise return False.</span>

<span class="sd">        Currently, the encoding of a Decimal instance is always</span>
<span class="sd">        canonical, so this method returns True for any Decimal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="Decimal.is_finite"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_finite">[docs]</a>    <span class="k">def</span> <span class="nf">is_finite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is finite; otherwise return False.</span>

<span class="sd">        A Decimal instance is considered finite if it is neither</span>
<span class="sd">        infinite nor a NaN.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span></div>

<div class="viewcode-block" id="Decimal.is_infinite"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_infinite">[docs]</a>    <span class="k">def</span> <span class="nf">is_infinite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is infinite; otherwise return False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span></div>

<div class="viewcode-block" id="Decimal.is_nan"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_nan">[docs]</a>    <span class="k">def</span> <span class="nf">is_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is a qNaN or sNaN; otherwise return False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.is_normal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_normal">[docs]</a>    <span class="k">def</span> <span class="nf">is_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is a normal number; otherwise return False.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">Emin</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span></div>

<div class="viewcode-block" id="Decimal.is_qnan"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_qnan">[docs]</a>    <span class="k">def</span> <span class="nf">is_qnan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is a quiet NaN; otherwise return False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span></div>

<div class="viewcode-block" id="Decimal.is_signed"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_signed">[docs]</a>    <span class="k">def</span> <span class="nf">is_signed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is negative; otherwise return False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Decimal.is_snan"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_snan">[docs]</a>    <span class="k">def</span> <span class="nf">is_snan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is a signaling NaN; otherwise return False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span></div>

<div class="viewcode-block" id="Decimal.is_subnormal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_subnormal">[docs]</a>    <span class="k">def</span> <span class="nf">is_subnormal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is subnormal; otherwise return False.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">context</span><span class="o">.</span><span class="n">Emin</span></div>

<div class="viewcode-block" id="Decimal.is_zero"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.is_zero">[docs]</a>    <span class="k">def</span> <span class="nf">is_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is a zero; otherwise return False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span></div>

    <span class="k">def</span> <span class="nf">_ln_exp_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute a lower bound for the adjusted exponent of self.ln().</span>
<span class="sd">        In other words, compute r such that self.ln() &gt;= 10**r.  Assumes</span>
<span class="sd">        that self is finite and positive and that self != 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># for 0.1 &lt;= x &lt;= 10 we use the inequalities 1-1/x &lt;= ln(x) &lt;= x-1</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">adj</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># argument &gt;= 10; we use 23/10 = 2.3 as a lower bound for ln(10)</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">adj</span><span class="o">*</span><span class="mi">23</span><span class="o">//</span><span class="mi">10</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">adj</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="c1"># argument &lt;= 0.1</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">adj</span><span class="p">)</span><span class="o">*</span><span class="mi">23</span><span class="o">//</span><span class="mi">10</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">exp</span>
        <span class="k">if</span> <span class="n">adj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># 1 &lt; self &lt; 10</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">10</span><span class="o">**-</span><span class="n">e</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">den</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="n">den</span><span class="p">)</span>
        <span class="c1"># adj == -1, 0.1 &lt;= self &lt; 1</span>
        <span class="k">return</span> <span class="n">e</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="n">e</span> <span class="o">-</span> <span class="n">c</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>


<div class="viewcode-block" id="Decimal.ln"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.ln">[docs]</a>    <span class="k">def</span> <span class="nf">ln</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the natural (base e) logarithm of self.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="c1"># ln(NaN) = NaN</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="c1"># ln(0.0) == -Infinity</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NegativeInfinity</span>

        <span class="c1"># ln(Infinity) = Infinity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_Infinity</span>

        <span class="c1"># ln(1.0) == 0.0</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">_One</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_Zero</span>

        <span class="c1"># ln(negative) raises InvalidOperation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;ln of a negative value&#39;</span><span class="p">)</span>

        <span class="c1"># result is irrational, so necessarily inexact</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">exp</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span>

        <span class="c1"># correctly rounded result: repeatedly increase precision by 3</span>
        <span class="c1"># until we get an unambiguously roundable result</span>
        <span class="n">places</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ln_exp_bound</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span> <span class="c1"># at least p+3 places</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="n">_dlog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">places</span><span class="p">)</span>
            <span class="c1"># assert len(str(abs(coeff)))-p &gt;= 1</span>
            <span class="k">if</span> <span class="n">coeff</span> <span class="o">%</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)))</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                <span class="k">break</span>
            <span class="n">places</span> <span class="o">+=</span> <span class="mi">3</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coeff</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)),</span> <span class="o">-</span><span class="n">places</span><span class="p">)</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_shallow_copy</span><span class="p">()</span>
        <span class="n">rounding</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_set_rounding</span><span class="p">(</span><span class="n">ROUND_HALF_EVEN</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">rounding</span>
        <span class="k">return</span> <span class="n">ans</span></div>

    <span class="k">def</span> <span class="nf">_log10_exp_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute a lower bound for the adjusted exponent of self.log10().</span>
<span class="sd">        In other words, find r such that self.log10() &gt;= 10**r.</span>
<span class="sd">        Assumes that self is finite and positive and that self != 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># For x &gt;= 10 or x &lt; 0.1 we only need a bound on the integer</span>
        <span class="c1"># part of log10(self), and this comes directly from the</span>
        <span class="c1"># exponent of x.  For 0.1 &lt;= x &lt;= 10 we use the inequalities</span>
        <span class="c1"># 1-1/x &lt;= log(x) &lt;= x-1. If x &gt; 1 we have |log10(x)| &gt;</span>
        <span class="c1"># (1-1/x)/2.31 &gt; 0.  If x &lt; 1 then |log10(x)| &gt; (1-x)/2.31 &gt; 0</span>

        <span class="n">adj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">adj</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># self &gt;= 10</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">adj</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">adj</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="c1"># self &lt; 0.1</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">adj</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">exp</span>
        <span class="k">if</span> <span class="n">adj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># 1 &lt; self &lt; 10</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">10</span><span class="o">**-</span><span class="n">e</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">231</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">den</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="n">den</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="c1"># adj == -1, 0.1 &lt;= self &lt; 1</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="n">e</span><span class="o">-</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span> <span class="o">-</span> <span class="p">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="s2">&quot;231&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<div class="viewcode-block" id="Decimal.log10"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.log10">[docs]</a>    <span class="k">def</span> <span class="nf">log10</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the base 10 logarithm of self.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="c1"># log10(NaN) = NaN</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="c1"># log10(0.0) == -Infinity</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NegativeInfinity</span>

        <span class="c1"># log10(Infinity) = Infinity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_Infinity</span>

        <span class="c1"># log10(negative or -Infinity) raises InvalidOperation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">,</span>
                                        <span class="s1">&#39;log10 of a negative value&#39;</span><span class="p">)</span>

        <span class="c1"># log10(10**n) = n</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># answer may need rounding</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># result is irrational, so necessarily inexact</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">_WorkRep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">exp</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span>

            <span class="c1"># correctly rounded result: repeatedly increase precision</span>
            <span class="c1"># until result is unambiguously roundable</span>
            <span class="n">places</span> <span class="o">=</span> <span class="n">p</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_log10_exp_bound</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">coeff</span> <span class="o">=</span> <span class="n">_dlog10</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">places</span><span class="p">)</span>
                <span class="c1"># assert len(str(abs(coeff)))-p &gt;= 1</span>
                <span class="k">if</span> <span class="n">coeff</span> <span class="o">%</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)))</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="k">break</span>
                <span class="n">places</span> <span class="o">+=</span> <span class="mi">3</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coeff</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)),</span> <span class="o">-</span><span class="n">places</span><span class="p">)</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_shallow_copy</span><span class="p">()</span>
        <span class="n">rounding</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_set_rounding</span><span class="p">(</span><span class="n">ROUND_HALF_EVEN</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">rounding</span>
        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="Decimal.logb"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.logb">[docs]</a>    <span class="k">def</span> <span class="nf">logb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the exponent of the magnitude of self&#39;s MSD.</span>

<span class="sd">        The result is the integer which is the exponent of the magnitude</span>
<span class="sd">        of the most significant digit of self (as though it were truncated</span>
<span class="sd">        to a single digit while maintaining the value of that digit and</span>
<span class="sd">        without limiting the resulting exponent).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># logb(NaN) = NaN</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="c1"># logb(+/-Inf) = +Inf</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">_Infinity</span>

        <span class="c1"># logb(0) = -Inf, DivisionByZero</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="s1">&#39;logb(0)&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># otherwise, simply return the adjusted exponent of self, as a</span>
        <span class="c1"># Decimal.  Note that no attempt is made to fit the result</span>
        <span class="c1"># into the current context.</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adjusted</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_islogical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is a logical operand.</span>

<span class="sd">        For being logical, it must be a finite number with a sign of 0,</span>
<span class="sd">        an exponent of 0, and a coefficient whose digits must all be</span>
<span class="sd">        either 0 or 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">dig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dig</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;01&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">_fill_logical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">opa</span><span class="p">,</span> <span class="n">opb</span><span class="p">):</span>
        <span class="n">dif</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">opa</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dif</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">opa</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">dif</span> <span class="o">+</span> <span class="n">opa</span>
        <span class="k">elif</span> <span class="n">dif</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">opa</span> <span class="o">=</span> <span class="n">opa</span><span class="p">[</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:]</span>
        <span class="n">dif</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">opb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dif</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">opb</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">dif</span> <span class="o">+</span> <span class="n">opb</span>
        <span class="k">elif</span> <span class="n">dif</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">opb</span> <span class="o">=</span> <span class="n">opb</span><span class="p">[</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">opa</span><span class="p">,</span> <span class="n">opb</span>

<div class="viewcode-block" id="Decimal.logical_and"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.logical_and">[docs]</a>    <span class="k">def</span> <span class="nf">logical_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies an &#39;and&#39; operation between self and other&#39;s digits.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_islogical</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">other</span><span class="o">.</span><span class="n">_islogical</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>

        <span class="c1"># fill to context.prec</span>
        <span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">opb</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_logical</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>

        <span class="c1"># make the operation, and clean starting zeroes</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&amp;</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span><span class="n">opb</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.logical_invert"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.logical_invert">[docs]</a>    <span class="k">def</span> <span class="nf">logical_invert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Invert all its digits.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                                <span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.logical_or"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.logical_or">[docs]</a>    <span class="k">def</span> <span class="nf">logical_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies an &#39;or&#39; operation between self and other&#39;s digits.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_islogical</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">other</span><span class="o">.</span><span class="n">_islogical</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>

        <span class="c1"># fill to context.prec</span>
        <span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">opb</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_logical</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>

        <span class="c1"># make the operation, and clean starting zeroes</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">|</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span><span class="n">opb</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.logical_xor"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.logical_xor">[docs]</a>    <span class="k">def</span> <span class="nf">logical_xor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies an &#39;xor&#39; operation between self and other&#39;s digits.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_islogical</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">other</span><span class="o">.</span><span class="n">_islogical</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>

        <span class="c1"># fill to context.prec</span>
        <span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">opb</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_logical</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>

        <span class="c1"># make the operation, and clean starting zeroes</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">^</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span><span class="n">opb</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.max_mag"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.max_mag">[docs]</a>    <span class="k">def</span> <span class="nf">max_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares the values numerically with their sign ignored.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="c1"># If one operand is a quiet NaN and the other is number, then the</span>
            <span class="c1"># number is always returned</span>
            <span class="n">sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">sn</span> <span class="ow">or</span> <span class="n">on</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sn</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.min_mag"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.min_mag">[docs]</a>    <span class="k">def</span> <span class="nf">min_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares the values numerically with their sign ignored.&quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="c1"># If one operand is a quiet NaN and the other is number, then the</span>
            <span class="c1"># number is always returned</span>
            <span class="n">sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">sn</span> <span class="ow">or</span> <span class="n">on</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sn</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.next_minus"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.next_minus">[docs]</a>    <span class="k">def</span> <span class="nf">next_minus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the largest representable number smaller than itself.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NegativeInfinity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="o">*</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Etop</span><span class="p">())</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">context</span><span class="o">.</span><span class="n">_set_rounding</span><span class="p">(</span><span class="n">ROUND_FLOOR</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">_ignore_all_flags</span><span class="p">()</span>
        <span class="n">new_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_self</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_self</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sub__</span><span class="p">(</span><span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Etiny</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                            <span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.next_plus"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.next_plus">[docs]</a>    <span class="k">def</span> <span class="nf">next_plus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the smallest representable number larger than itself.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_Infinity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="o">*</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Etop</span><span class="p">())</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">context</span><span class="o">.</span><span class="n">_set_rounding</span><span class="p">(</span><span class="n">ROUND_CEILING</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">_ignore_all_flags</span><span class="p">()</span>
        <span class="n">new_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_self</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_self</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">_dec_from_triple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Etiny</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                            <span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.next_toward"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.next_toward">[docs]</a>    <span class="k">def</span> <span class="nf">next_toward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the number closest to self, in the direction towards other.</span>

<span class="sd">        The result is the closest representable number to self</span>
<span class="sd">        (excluding self) that is in the direction towards other,</span>
<span class="sd">        unless both have the same value.  If the two operands are</span>
<span class="sd">        numerically equal, then the result is a copy of self with the</span>
<span class="sd">        sign set to be the same as the sign of other.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="n">comparison</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comparison</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">comparison</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_plus</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># comparison == 1</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_minus</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="c1"># decide which flags to raise using value of ans</span>
        <span class="k">if</span> <span class="n">ans</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Overflow</span><span class="p">,</span>
                                 <span class="s1">&#39;Infinite result from next_toward&#39;</span><span class="p">,</span>
                                 <span class="n">ans</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ans</span><span class="o">.</span><span class="n">adjusted</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">context</span><span class="o">.</span><span class="n">Emin</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Underflow</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Subnormal</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Inexact</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Rounded</span><span class="p">)</span>
            <span class="c1"># if precision == 1 then we don&#39;t raise Clamped for a</span>
            <span class="c1"># result 0E-Etiny.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ans</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">Clamped</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="Decimal.number_class"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.number_class">[docs]</a>    <span class="k">def</span> <span class="nf">number_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an indication of the class of self.</span>

<span class="sd">        The class is one of the following strings:</span>
<span class="sd">          sNaN</span>
<span class="sd">          NaN</span>
<span class="sd">          -Infinity</span>
<span class="sd">          -Normal</span>
<span class="sd">          -Subnormal</span>
<span class="sd">          -Zero</span>
<span class="sd">          +Zero</span>
<span class="sd">          +Subnormal</span>
<span class="sd">          +Normal</span>
<span class="sd">          +Infinity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_snan</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;sNaN&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;NaN&quot;</span>
        <span class="n">inf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">inf</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;+Infinity&quot;</span>
        <span class="k">if</span> <span class="n">inf</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;-Infinity&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zero</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;-Zero&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;+Zero&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_subnormal</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;-Subnormal&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;+Subnormal&quot;</span>
        <span class="c1"># just a normal, regular, boring number, :)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;-Normal&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;+Normal&quot;</span></div>

<div class="viewcode-block" id="Decimal.radix"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.radix">[docs]</a>    <span class="k">def</span> <span class="nf">radix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Just returns 10, as this is Decimal, :)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.rotate"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.rotate">[docs]</a>    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a rotated copy of self, value-of-other times.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># get values, pad if necessary</span>
        <span class="n">torot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">rotdig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>
        <span class="n">topad</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">rotdig</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">topad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rotdig</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">topad</span> <span class="o">+</span> <span class="n">rotdig</span>
        <span class="k">elif</span> <span class="n">topad</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rotdig</span> <span class="o">=</span> <span class="n">rotdig</span><span class="p">[</span><span class="o">-</span><span class="n">topad</span><span class="p">:]</span>

        <span class="c1"># let&#39;s rotate!</span>
        <span class="n">rotated</span> <span class="o">=</span> <span class="n">rotdig</span><span class="p">[</span><span class="n">torot</span><span class="p">:]</span> <span class="o">+</span> <span class="n">rotdig</span><span class="p">[:</span><span class="n">torot</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span>
                                <span class="n">rotated</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Decimal.scaleb"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.scaleb">[docs]</a>    <span class="k">def</span> <span class="nf">scaleb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns self operand after adding the second value to its exp.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>
        <span class="n">liminf</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Emax</span> <span class="o">+</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">)</span>
        <span class="n">limsup</span> <span class="o">=</span>  <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Emax</span> <span class="o">+</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">liminf</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">limsup</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="Decimal.shift"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Decimal.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a shifted copy of self, value-of-other times.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_nans</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_exp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">InvalidOperation</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isinfinity</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># get values, pad if necessary</span>
        <span class="n">torot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">rotdig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>
        <span class="n">topad</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">rotdig</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">topad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rotdig</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">topad</span> <span class="o">+</span> <span class="n">rotdig</span>
        <span class="k">elif</span> <span class="n">topad</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rotdig</span> <span class="o">=</span> <span class="n">rotdig</span><span class="p">[</span><span class="o">-</span><span class="n">topad</span><span class="p">:]</span>

        <span class="c1"># let&#39;s shift!</span>
        <span class="k">if</span> <span class="n">torot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">shifted</span> <span class="o">=</span> <span class="n">rotdig</span><span class="p">[:</span><span class="n">torot</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shifted</span> <span class="o">=</span> <span class="n">rotdig</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">torot</span>
            <span class="n">shifted</span> <span class="o">=</span> <span class="n">shifted</span><span class="p">[</span><span class="o">-</span><span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span>
                                    <span class="n">shifted</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="p">)</span></div>

    <span class="c1"># Support for pickling, copy, and deepcopy</span>
    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">),))</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Decimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>     <span class="c1"># I&#39;m immutable; therefore I am my own clone</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Decimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>     <span class="c1"># My components are also immutable</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="c1"># PEP 3101 support.  the _localeconv keyword argument should be</span>
    <span class="c1"># considered private: it&#39;s provided for ease of testing only.</span>
    <span class="k">def</span> <span class="nf">__format__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specifier</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">_localeconv</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format a Decimal instance according to the given specifier.</span>

<span class="sd">        The specifier should be a standard format specifier, with the</span>
<span class="sd">        form described in PEP 3101.  Formatting types &#39;e&#39;, &#39;E&#39;, &#39;f&#39;,</span>
<span class="sd">        &#39;F&#39;, &#39;g&#39;, &#39;G&#39;, &#39;n&#39; and &#39;%&#39; are supported.  If the formatting</span>
<span class="sd">        type is omitted it defaults to &#39;g&#39; or &#39;G&#39;, depending on the</span>
<span class="sd">        value of context.capitals.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Note: PEP 3101 says that if the type is not present then</span>
        <span class="c1"># there should be at least one digit after the decimal point.</span>
        <span class="c1"># We take the liberty of ignoring this requirement for</span>
        <span class="c1"># Decimal---it&#39;s presumably there to make sure that</span>
        <span class="c1"># format(float, &#39;&#39;) behaves similarly to str(float).</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>

        <span class="n">spec</span> <span class="o">=</span> <span class="n">_parse_format_specifier</span><span class="p">(</span><span class="n">specifier</span><span class="p">,</span> <span class="n">_localeconv</span><span class="o">=</span><span class="n">_localeconv</span><span class="p">)</span>

        <span class="c1"># special values don&#39;t care about the type or precision</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="n">_format_sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
            <span class="n">body</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span><span class="p">:</span>
                <span class="n">body</span> <span class="o">+=</span> <span class="s1">&#39;%&#39;</span>
            <span class="k">return</span> <span class="n">_format_align</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>

        <span class="c1"># a type of None defaults to &#39;g&#39; or &#39;G&#39;, depending on context</span>
        <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">][</span><span class="n">context</span><span class="o">.</span><span class="n">capitals</span><span class="p">]</span>

        <span class="c1"># if type is &#39;%&#39;, adjust exponent of self accordingly</span>
        <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">_dec_from_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># round if necessary, taking rounding mode from the context</span>
        <span class="n">rounding</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span>
        <span class="n">precision</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;precision&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">precision</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;eE&#39;</span><span class="p">:</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round</span><span class="p">(</span><span class="n">precision</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;fF%&#39;</span><span class="p">:</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="o">-</span><span class="n">precision</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;gG&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">precision</span><span class="p">:</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round</span><span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>
        <span class="c1"># special case: zeros with a positive exponent can&#39;t be</span>
        <span class="c1"># represented in fixed point; rescale them to 0e0.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;fF%&#39;</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span>

        <span class="c1"># figure out placement of the decimal point</span>
        <span class="n">leftdigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;eE&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span> <span class="ow">and</span> <span class="n">precision</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">dotplace</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">precision</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dotplace</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;fF%&#39;</span><span class="p">:</span>
            <span class="n">dotplace</span> <span class="o">=</span> <span class="n">leftdigits</span>
        <span class="k">elif</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;gG&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">leftdigits</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">6</span><span class="p">:</span>
                <span class="n">dotplace</span> <span class="o">=</span> <span class="n">leftdigits</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dotplace</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># find digits before and after decimal point, and get exponent</span>
        <span class="k">if</span> <span class="n">dotplace</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">intpart</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
            <span class="n">fracpart</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dotplace</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span>
        <span class="k">elif</span> <span class="n">dotplace</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">):</span>
            <span class="n">intpart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">dotplace</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">))</span>
            <span class="n">fracpart</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">intpart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[:</span><span class="n">dotplace</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span>
            <span class="n">fracpart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int</span><span class="p">[</span><span class="n">dotplace</span><span class="p">:]</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">leftdigits</span><span class="o">-</span><span class="n">dotplace</span>

        <span class="c1"># done with the decimal-specific stuff;  hand over the rest</span>
        <span class="c1"># of the formatting to the _format_number function</span>
        <span class="k">return</span> <span class="n">_format_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sign</span><span class="p">,</span> <span class="n">intpart</span><span class="p">,</span> <span class="n">fracpart</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">_dec_from_triple</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">,</span> <span class="n">exponent</span><span class="p">,</span> <span class="n">special</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a decimal instance directly, without any validation,</span>
<span class="sd">    normalization (e.g. removal of leading zeros) or argument</span>
<span class="sd">    conversion.</span>

<span class="sd">    This function is for *internal use only*.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">Decimal</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span> <span class="o">=</span> <span class="n">sign</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_int</span> <span class="o">=</span> <span class="n">coefficient</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_exp</span> <span class="o">=</span> <span class="n">exponent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_special</span> <span class="o">=</span> <span class="n">special</span>

    <span class="k">return</span> <span class="bp">self</span>

<span class="c1"># Register Decimal as a kind of Number (an abstract base class).</span>
<span class="c1"># However, do not register it as Real (because Decimals are not</span>
<span class="c1"># interoperable with floats).</span>
<span class="n">_numbers</span><span class="o">.</span><span class="n">Number</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Decimal</span><span class="p">)</span>


<span class="c1">##### Context class #######################################################</span>

<span class="k">class</span> <span class="nc">_ContextManager</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Context manager class to support localcontext().</span>

<span class="sd">      Sets a copy of the supplied context in __enter__() and restores</span>
<span class="sd">      the previous decimal context in __exit__()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_context</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_context</span> <span class="o">=</span> <span class="n">new_context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saved_context</span> <span class="o">=</span> <span class="n">getcontext</span><span class="p">()</span>
        <span class="n">setcontext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_context</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_context</span>
    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">tb</span><span class="p">):</span>
        <span class="n">setcontext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saved_context</span><span class="p">)</span>

<div class="viewcode-block" id="Context"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context">[docs]</a><span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Contains the context for a Decimal instance.</span>

<span class="sd">    Contains:</span>
<span class="sd">    prec - precision (for use in rounding, division, square roots..)</span>
<span class="sd">    rounding - rounding type (how you round)</span>
<span class="sd">    traps - If traps[exception] = 1, then the exception is</span>
<span class="sd">                    raised when it is caused.  Otherwise, a value is</span>
<span class="sd">                    substituted in.</span>
<span class="sd">    flags  - When an exception is caused, flags[exception] is set.</span>
<span class="sd">             (Whether or not the trap_enabler is set)</span>
<span class="sd">             Should be reset by user of Decimal instance.</span>
<span class="sd">    Emin -   Minimum exponent</span>
<span class="sd">    Emax -   Maximum exponent</span>
<span class="sd">    capitals -      If 1, 1*10^1 is printed as 1E+1.</span>
<span class="sd">                    If 0, printed as 1e1</span>
<span class="sd">    _clamp - If 1, change exponents if too high (Default 0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">traps</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">Emin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">capitals</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">_clamp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">_ignored_flags</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># Set defaults; for everything except flags and _ignored_flags,</span>
        <span class="c1"># inherit from DefaultContext.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dc</span> <span class="o">=</span> <span class="n">DefaultContext</span>
        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">prec</span> <span class="k">if</span> <span class="n">prec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">dc</span><span class="o">.</span><span class="n">prec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="n">rounding</span> <span class="k">if</span> <span class="n">rounding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">dc</span><span class="o">.</span><span class="n">rounding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Emin</span> <span class="o">=</span> <span class="n">Emin</span> <span class="k">if</span> <span class="n">Emin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">dc</span><span class="o">.</span><span class="n">Emin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="n">Emax</span> <span class="k">if</span> <span class="n">Emax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">dc</span><span class="o">.</span><span class="n">Emax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capitals</span> <span class="o">=</span> <span class="n">capitals</span> <span class="k">if</span> <span class="n">capitals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">dc</span><span class="o">.</span><span class="n">capitals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clamp</span> <span class="o">=</span> <span class="n">_clamp</span> <span class="k">if</span> <span class="n">_clamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">dc</span><span class="o">.</span><span class="n">_clamp</span>

        <span class="k">if</span> <span class="n">_ignored_flags</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ignored_flags</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ignored_flags</span> <span class="o">=</span> <span class="n">_ignored_flags</span>

        <span class="k">if</span> <span class="n">traps</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">traps</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">traps</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">traps</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="n">traps</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">_signals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">traps</span> <span class="o">=</span> <span class="n">traps</span>

        <span class="k">if</span> <span class="n">flags</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">_signals</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">_signals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show the current context.&quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Context(prec=</span><span class="si">%(prec)d</span><span class="s1">, rounding=</span><span class="si">%(rounding)s</span><span class="s1">, &#39;</span>
                 <span class="s1">&#39;Emin=</span><span class="si">%(Emin)d</span><span class="s1">, Emax=</span><span class="si">%(Emax)d</span><span class="s1">, capitals=</span><span class="si">%(capitals)d</span><span class="s1">&#39;</span>
                 <span class="o">%</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">__name__</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">]</span>
        <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;flags=[&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">__name__</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">]</span>
        <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;traps=[&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>

<div class="viewcode-block" id="Context.clear_flags"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.clear_flags">[docs]</a>    <span class="k">def</span> <span class="nf">clear_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset all flags to zero&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span></div>

    <span class="k">def</span> <span class="nf">_shallow_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a shallow copy from self.&quot;&quot;&quot;</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traps</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">capitals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clamp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignored_flags</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nc</span>

<div class="viewcode-block" id="Context.copy"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a deep copy from self.&quot;&quot;&quot;</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">Emin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Emax</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">capitals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clamp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignored_flags</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nc</span></div>
    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

    <span class="k">def</span> <span class="nf">_raise_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">explanation</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handles an error</span>

<span class="sd">        If the flag is in _ignored_flags, returns the default response.</span>
<span class="sd">        Otherwise, it sets the flag, then, if the corresponding</span>
<span class="sd">        trap_enabler is set, it reraises the exception.  Otherwise, it returns</span>
<span class="sd">        the default value after setting the flag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">_condition_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">condition</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">error</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignored_flags</span><span class="p">:</span>
            <span class="c1"># Don&#39;t touch the flag</span>
            <span class="k">return</span> <span class="n">error</span><span class="p">()</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">error</span><span class="p">]:</span>
            <span class="c1"># The errors define how to handle themselves.</span>
            <span class="k">return</span> <span class="n">condition</span><span class="p">()</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="c1"># Errors should only be risked on copies of the context</span>
        <span class="c1"># self._ignored_flags = []</span>
        <span class="k">raise</span> <span class="n">error</span><span class="p">(</span><span class="n">explanation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ignore_all_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ignore all flags, if they are raised&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_flags</span><span class="p">(</span><span class="o">*</span><span class="n">_signals</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ignore_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">flags</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ignore the flags, if they are raised&quot;&quot;&quot;</span>
        <span class="c1"># Do not mutate-- This way, copies of a context leave the original</span>
        <span class="c1"># alone.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ignored_flags</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ignored_flags</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_regard_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">flags</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop ignoring the flags, if they are raised&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">flags</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ignored_flags</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

    <span class="c1"># We inherit object.__hash__, so we must deny this explicitly</span>
    <span class="n">__hash__</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="Context.Etiny"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.Etiny">[docs]</a>    <span class="k">def</span> <span class="nf">Etiny</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns Etiny (= Emin - prec + 1)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Emin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">prec</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.Etop"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.Etop">[docs]</a>    <span class="k">def</span> <span class="nf">Etop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns maximum exponent (= Emax - prec + 1)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Emax</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">prec</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_set_rounding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the rounding type.</span>

<span class="sd">        Sets the rounding type, and returns the current (previous)</span>
<span class="sd">        rounding type.  Often used like:</span>

<span class="sd">        context = context.copy()</span>
<span class="sd">        # so you don&#39;t change the calling context</span>
<span class="sd">        # if an error occurs in the middle.</span>
<span class="sd">        rounding = context._set_rounding(ROUND_UP)</span>
<span class="sd">        val = self.__sub__(other, context=context)</span>
<span class="sd">        context._set_rounding(rounding)</span>

<span class="sd">        This will make it round up for that operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rounding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rounding</span><span class="o">=</span> <span class="nb">type</span>
        <span class="k">return</span> <span class="n">rounding</span>

<div class="viewcode-block" id="Context.create_decimal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.create_decimal">[docs]</a>    <span class="k">def</span> <span class="nf">create_decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a new Decimal instance but using self as context.</span>

<span class="sd">        This method implements the to-number operation of the</span>
<span class="sd">        IBM Decimal specification.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span> <span class="ow">and</span> <span class="n">num</span> <span class="o">!=</span> <span class="n">num</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">ConversionSyntax</span><span class="p">,</span>
                                     <span class="s2">&quot;no trailing or leading whitespace is &quot;</span>
                                     <span class="s2">&quot;permitted.&quot;</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">_isnan</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">prec</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clamp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error</span><span class="p">(</span><span class="n">ConversionSyntax</span><span class="p">,</span>
                                     <span class="s2">&quot;diagnostic info too long in NaN&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.create_decimal_from_float"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.create_decimal_from_float">[docs]</a>    <span class="k">def</span> <span class="nf">create_decimal_from_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a new Decimal instance from a float but rounding using self</span>
<span class="sd">        as the context.</span>

<span class="sd">        &gt;&gt;&gt; context = Context(prec=5, rounding=ROUND_DOWN)</span>
<span class="sd">        &gt;&gt;&gt; context.create_decimal_from_float(3.1415926535897932)</span>
<span class="sd">        Decimal(&#39;3.1415&#39;)</span>
<span class="sd">        &gt;&gt;&gt; context = Context(prec=5, traps=[Inexact])</span>
<span class="sd">        &gt;&gt;&gt; context.create_decimal_from_float(3.1415926535897932)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        Inexact: None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Decimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>       <span class="c1"># An exact conversion</span>
        <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>             <span class="c1"># Apply the context rounding</span></div>

    <span class="c1"># Methods</span>
<div class="viewcode-block" id="Context.abs"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.abs">[docs]</a>    <span class="k">def</span> <span class="nf">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the absolute value of the operand.</span>

<span class="sd">        If the operand is negative, the result is the same as using the minus</span>
<span class="sd">        operation on the operand.  Otherwise, the result is the same as using</span>
<span class="sd">        the plus operation on the operand.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.abs(Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;2.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.abs(Decimal(&#39;-100&#39;))</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.abs(Decimal(&#39;101.5&#39;))</span>
<span class="sd">        Decimal(&#39;101.5&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.abs(Decimal(&#39;-101.5&#39;))</span>
<span class="sd">        Decimal(&#39;101.5&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.abs(-1)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">__abs__</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.add"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the sum of the two operands.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.add(Decimal(&#39;12&#39;), Decimal(&#39;7.00&#39;))</span>
<span class="sd">        Decimal(&#39;19.00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.add(Decimal(&#39;1E+2&#39;), Decimal(&#39;1.01E+4&#39;))</span>
<span class="sd">        Decimal(&#39;1.02E+4&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.add(1, Decimal(2))</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.add(Decimal(8), 5)</span>
<span class="sd">        Decimal(&#39;13&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.add(5, 5)</span>
<span class="sd">        Decimal(&#39;10&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span></div>

    <span class="k">def</span> <span class="nf">_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">_fix</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

<div class="viewcode-block" id="Context.canonical"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.canonical">[docs]</a>    <span class="k">def</span> <span class="nf">canonical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the same Decimal object.</span>

<span class="sd">        As we do not have different encodings for the same number, the</span>
<span class="sd">        received object already is in its canonical form.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.canonical(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        Decimal(&#39;2.50&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">canonical</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.compare"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.compare">[docs]</a>    <span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares values numerically.</span>

<span class="sd">        If the signs of the operands differ, a value representing each operand</span>
<span class="sd">        (&#39;-1&#39; if the operand is less than zero, &#39;0&#39; if the operand is zero or</span>
<span class="sd">        negative zero, or &#39;1&#39; if the operand is greater than zero) is used in</span>
<span class="sd">        place of that operand for the comparison instead of the actual</span>
<span class="sd">        operand.</span>

<span class="sd">        The comparison is then effected by subtracting the second operand from</span>
<span class="sd">        the first and then returning a value according to the result of the</span>
<span class="sd">        subtraction: &#39;-1&#39; if the result is less than zero, &#39;0&#39; if the result is</span>
<span class="sd">        zero or negative zero, or &#39;1&#39; if the result is greater than zero.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(Decimal(&#39;2.1&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(Decimal(&#39;2.1&#39;), Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(Decimal(&#39;2.1&#39;), Decimal(&#39;2.10&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(Decimal(&#39;3&#39;), Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(Decimal(&#39;2.1&#39;), Decimal(&#39;-3&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(Decimal(&#39;-3&#39;), Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(1, 2)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(Decimal(1), 2)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare(1, Decimal(2))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.compare_signal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.compare_signal">[docs]</a>    <span class="k">def</span> <span class="nf">compare_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares the values of the two operands numerically.</span>

<span class="sd">        It&#39;s pretty much like compare(), but all NaNs signal, with signaling</span>
<span class="sd">        NaNs taking precedence over quiet NaNs.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext</span>
<span class="sd">        &gt;&gt;&gt; c.compare_signal(Decimal(&#39;2.1&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.compare_signal(Decimal(&#39;2.1&#39;), Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.flags[InvalidOperation] = 0</span>
<span class="sd">        &gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; c.compare_signal(Decimal(&#39;NaN&#39;), Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;NaN&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; c.flags[InvalidOperation] = 0</span>
<span class="sd">        &gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; c.compare_signal(Decimal(&#39;sNaN&#39;), Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;NaN&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print c.flags[InvalidOperation]</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; c.compare_signal(-1, 2)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.compare_signal(Decimal(-1), 2)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.compare_signal(-1, Decimal(2))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">compare_signal</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.compare_total"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.compare_total">[docs]</a>    <span class="k">def</span> <span class="nf">compare_total</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares two operands using their abstract representation.</span>

<span class="sd">        This is not like the standard compare, which use their numerical</span>
<span class="sd">        value. Note that a total ordering is defined for all possible abstract</span>
<span class="sd">        representations.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(Decimal(&#39;12.73&#39;), Decimal(&#39;127.9&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(Decimal(&#39;-127&#39;),  Decimal(&#39;12&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(Decimal(&#39;12.30&#39;), Decimal(&#39;12.3&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(Decimal(&#39;12.30&#39;), Decimal(&#39;12.30&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(Decimal(&#39;12.3&#39;),  Decimal(&#39;12.300&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(Decimal(&#39;12.3&#39;),  Decimal(&#39;NaN&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(1, 2)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(Decimal(1), 2)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.compare_total(1, Decimal(2))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">compare_total</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.compare_total_mag"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.compare_total_mag">[docs]</a>    <span class="k">def</span> <span class="nf">compare_total_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares two operands using their abstract representation ignoring sign.</span>

<span class="sd">        Like compare_total, but with operand&#39;s sign ignored and assumed to be 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">compare_total_mag</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.copy_abs"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.copy_abs">[docs]</a>    <span class="k">def</span> <span class="nf">copy_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy of the operand with the sign set to 0.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_abs(Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;2.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_abs(Decimal(&#39;-100&#39;))</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_abs(-1)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">copy_abs</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.copy_decimal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.copy_decimal">[docs]</a>    <span class="k">def</span> <span class="nf">copy_decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy of the decimal object.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_decimal(Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;2.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_decimal(Decimal(&#39;-1.00&#39;))</span>
<span class="sd">        Decimal(&#39;-1.00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_decimal(1)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.copy_negate"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.copy_negate">[docs]</a>    <span class="k">def</span> <span class="nf">copy_negate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy of the operand with the sign inverted.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_negate(Decimal(&#39;101.5&#39;))</span>
<span class="sd">        Decimal(&#39;-101.5&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_negate(Decimal(&#39;-101.5&#39;))</span>
<span class="sd">        Decimal(&#39;101.5&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_negate(1)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">copy_negate</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.copy_sign"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.copy_sign">[docs]</a>    <span class="k">def</span> <span class="nf">copy_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copies the second operand&#39;s sign to the first one.</span>

<span class="sd">        In detail, it returns a copy of the first operand with the sign</span>
<span class="sd">        equal to the sign of the second operand.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_sign(Decimal( &#39;1.50&#39;), Decimal(&#39;7.33&#39;))</span>
<span class="sd">        Decimal(&#39;1.50&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_sign(Decimal(&#39;-1.50&#39;), Decimal(&#39;7.33&#39;))</span>
<span class="sd">        Decimal(&#39;1.50&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_sign(Decimal( &#39;1.50&#39;), Decimal(&#39;-7.33&#39;))</span>
<span class="sd">        Decimal(&#39;-1.50&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_sign(Decimal(&#39;-1.50&#39;), Decimal(&#39;-7.33&#39;))</span>
<span class="sd">        Decimal(&#39;-1.50&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_sign(1, -2)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_sign(Decimal(1), -2)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.copy_sign(1, Decimal(-2))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">copy_sign</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.divide"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.divide">[docs]</a>    <span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Decimal division in a specified context.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;1&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;0.333333333&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;2&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;0.666666667&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;5&#39;), Decimal(&#39;2&#39;))</span>
<span class="sd">        Decimal(&#39;2.5&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;1&#39;), Decimal(&#39;10&#39;))</span>
<span class="sd">        Decimal(&#39;0.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;12&#39;), Decimal(&#39;12&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;8.00&#39;), Decimal(&#39;2&#39;))</span>
<span class="sd">        Decimal(&#39;4.00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;2.400&#39;), Decimal(&#39;2.0&#39;))</span>
<span class="sd">        Decimal(&#39;1.20&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;1000&#39;), Decimal(&#39;100&#39;))</span>
<span class="sd">        Decimal(&#39;10&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;1000&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1000&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(&#39;2.40E+6&#39;), Decimal(&#39;2&#39;))</span>
<span class="sd">        Decimal(&#39;1.20E+6&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(5, 5)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(Decimal(5), 5)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide(5, Decimal(5))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Context.divide_int"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.divide_int">[docs]</a>    <span class="k">def</span> <span class="nf">divide_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Divides two numbers and returns the integer part of the result.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide_int(Decimal(&#39;2&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide_int(Decimal(&#39;10&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide_int(Decimal(&#39;1&#39;), Decimal(&#39;0.3&#39;))</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide_int(10, 3)</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide_int(Decimal(10), 3)</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divide_int(10, Decimal(3))</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">__floordiv__</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Context.divmod"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.divmod">[docs]</a>    <span class="k">def</span> <span class="nf">divmod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return (a // b, a % b).</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.divmod(Decimal(8), Decimal(3))</span>
<span class="sd">        (Decimal(&#39;2&#39;), Decimal(&#39;2&#39;))</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divmod(Decimal(8), Decimal(4))</span>
<span class="sd">        (Decimal(&#39;2&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divmod(8, 4)</span>
<span class="sd">        (Decimal(&#39;2&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divmod(Decimal(8), 4)</span>
<span class="sd">        (Decimal(&#39;2&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.divmod(8, Decimal(4))</span>
<span class="sd">        (Decimal(&#39;2&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">__divmod__</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Context.exp"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.exp">[docs]</a>    <span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns e ** a.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; c.exp(Decimal(&#39;-Infinity&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.exp(Decimal(&#39;-1&#39;))</span>
<span class="sd">        Decimal(&#39;0.367879441&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.exp(Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.exp(Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;2.71828183&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.exp(Decimal(&#39;0.693147181&#39;))</span>
<span class="sd">        Decimal(&#39;2.00000000&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.exp(Decimal(&#39;+Infinity&#39;))</span>
<span class="sd">        Decimal(&#39;Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.exp(10)</span>
<span class="sd">        Decimal(&#39;22026.4658&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span><span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.fma"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.fma">[docs]</a>    <span class="k">def</span> <span class="nf">fma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a multiplied by b, plus c.</span>

<span class="sd">        The first two operands are multiplied together, using multiply,</span>
<span class="sd">        the third operand is then added to the result of that</span>
<span class="sd">        multiplication, using add, all with only one final rounding.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.fma(Decimal(&#39;3&#39;), Decimal(&#39;5&#39;), Decimal(&#39;7&#39;))</span>
<span class="sd">        Decimal(&#39;22&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.fma(Decimal(&#39;3&#39;), Decimal(&#39;-5&#39;), Decimal(&#39;7&#39;))</span>
<span class="sd">        Decimal(&#39;-8&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.fma(Decimal(&#39;888565290&#39;), Decimal(&#39;1557.96930&#39;), Decimal(&#39;-86087.7578&#39;))</span>
<span class="sd">        Decimal(&#39;1.38435736E+12&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.fma(1, 3, 4)</span>
<span class="sd">        Decimal(&#39;7&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.fma(1, Decimal(3), 4)</span>
<span class="sd">        Decimal(&#39;7&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.fma(1, 3, Decimal(4))</span>
<span class="sd">        Decimal(&#39;7&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">fma</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.is_canonical"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_canonical">[docs]</a>    <span class="k">def</span> <span class="nf">is_canonical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is canonical; otherwise return False.</span>

<span class="sd">        Currently, the encoding of a Decimal instance is always</span>
<span class="sd">        canonical, so this method returns True for any Decimal.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_canonical(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_canonical</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.is_finite"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_finite">[docs]</a>    <span class="k">def</span> <span class="nf">is_finite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is finite; otherwise return False.</span>

<span class="sd">        A Decimal instance is considered finite if it is neither</span>
<span class="sd">        infinite nor a NaN.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_finite(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_finite(Decimal(&#39;-0.3&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_finite(Decimal(&#39;0&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_finite(Decimal(&#39;Inf&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_finite(Decimal(&#39;NaN&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_finite(1)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.is_infinite"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_infinite">[docs]</a>    <span class="k">def</span> <span class="nf">is_infinite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is infinite; otherwise return False.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_infinite(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_infinite(Decimal(&#39;-Inf&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_infinite(Decimal(&#39;NaN&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_infinite(1)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.is_nan"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_nan">[docs]</a>    <span class="k">def</span> <span class="nf">is_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is a qNaN or sNaN;</span>
<span class="sd">        otherwise return False.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_nan(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_nan(Decimal(&#39;NaN&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_nan(Decimal(&#39;-sNaN&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_nan(1)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_nan</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.is_normal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_normal">[docs]</a>    <span class="k">def</span> <span class="nf">is_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is a normal number;</span>
<span class="sd">        otherwise return False.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; c.is_normal(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; c.is_normal(Decimal(&#39;0.1E-999&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; c.is_normal(Decimal(&#39;0.00&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; c.is_normal(Decimal(&#39;-Inf&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; c.is_normal(Decimal(&#39;NaN&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; c.is_normal(1)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_normal</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.is_qnan"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_qnan">[docs]</a>    <span class="k">def</span> <span class="nf">is_qnan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is a quiet NaN; otherwise return False.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_qnan(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_qnan(Decimal(&#39;NaN&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_qnan(Decimal(&#39;sNaN&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_qnan(1)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_qnan</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.is_signed"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_signed">[docs]</a>    <span class="k">def</span> <span class="nf">is_signed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is negative; otherwise return False.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_signed(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_signed(Decimal(&#39;-12&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_signed(Decimal(&#39;-0&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_signed(8)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_signed(-8)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_signed</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.is_snan"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_snan">[docs]</a>    <span class="k">def</span> <span class="nf">is_snan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is a signaling NaN;</span>
<span class="sd">        otherwise return False.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_snan(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_snan(Decimal(&#39;NaN&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_snan(Decimal(&#39;sNaN&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_snan(1)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_snan</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.is_subnormal"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_subnormal">[docs]</a>    <span class="k">def</span> <span class="nf">is_subnormal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is subnormal; otherwise return False.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; c.is_subnormal(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; c.is_subnormal(Decimal(&#39;0.1E-999&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; c.is_subnormal(Decimal(&#39;0.00&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; c.is_subnormal(Decimal(&#39;-Inf&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; c.is_subnormal(Decimal(&#39;NaN&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; c.is_subnormal(1)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_subnormal</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.is_zero"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.is_zero">[docs]</a>    <span class="k">def</span> <span class="nf">is_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the operand is a zero; otherwise return False.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_zero(Decimal(&#39;0&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_zero(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_zero(Decimal(&#39;-0E+2&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_zero(1)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.is_zero(0)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span></div>

<div class="viewcode-block" id="Context.ln"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.ln">[docs]</a>    <span class="k">def</span> <span class="nf">ln</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the natural (base e) logarithm of the operand.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; c.ln(Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.ln(Decimal(&#39;1.000&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.ln(Decimal(&#39;2.71828183&#39;))</span>
<span class="sd">        Decimal(&#39;1.00000000&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.ln(Decimal(&#39;10&#39;))</span>
<span class="sd">        Decimal(&#39;2.30258509&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.ln(Decimal(&#39;+Infinity&#39;))</span>
<span class="sd">        Decimal(&#39;Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.ln(1)</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.log10"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.log10">[docs]</a>    <span class="k">def</span> <span class="nf">log10</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the base 10 logarithm of the operand.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; c.log10(Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.log10(Decimal(&#39;0.001&#39;))</span>
<span class="sd">        Decimal(&#39;-3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.log10(Decimal(&#39;1.000&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.log10(Decimal(&#39;2&#39;))</span>
<span class="sd">        Decimal(&#39;0.301029996&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.log10(Decimal(&#39;10&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.log10(Decimal(&#39;70&#39;))</span>
<span class="sd">        Decimal(&#39;1.84509804&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.log10(Decimal(&#39;+Infinity&#39;))</span>
<span class="sd">        Decimal(&#39;Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.log10(0)</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.log10(1)</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.logb"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.logb">[docs]</a>    <span class="k">def</span> <span class="nf">logb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the exponent of the magnitude of the operand&#39;s MSD.</span>

<span class="sd">        The result is the integer which is the exponent of the magnitude</span>
<span class="sd">        of the most significant digit of the operand (as though the</span>
<span class="sd">        operand were truncated to a single digit while maintaining the</span>
<span class="sd">        value of that digit and without limiting the resulting exponent).</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.logb(Decimal(&#39;250&#39;))</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logb(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logb(Decimal(&#39;0.03&#39;))</span>
<span class="sd">        Decimal(&#39;-2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logb(Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logb(1)</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logb(10)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logb(100)</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">logb</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.logical_and"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.logical_and">[docs]</a>    <span class="k">def</span> <span class="nf">logical_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies the logical operation &#39;and&#39; between each operand&#39;s digits.</span>

<span class="sd">        The operands must be both logical numbers.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(Decimal(&#39;0&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(Decimal(&#39;0&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(Decimal(&#39;1&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(Decimal(&#39;1&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(Decimal(&#39;1100&#39;), Decimal(&#39;1010&#39;))</span>
<span class="sd">        Decimal(&#39;1000&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(Decimal(&#39;1111&#39;), Decimal(&#39;10&#39;))</span>
<span class="sd">        Decimal(&#39;10&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(110, 1101)</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(Decimal(110), 1101)</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_and(110, Decimal(1101))</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.logical_invert"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.logical_invert">[docs]</a>    <span class="k">def</span> <span class="nf">logical_invert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Invert all the digits in the operand.</span>

<span class="sd">        The operand must be a logical number.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_invert(Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;111111111&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_invert(Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;111111110&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_invert(Decimal(&#39;111111111&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_invert(Decimal(&#39;101010101&#39;))</span>
<span class="sd">        Decimal(&#39;10101010&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_invert(1101)</span>
<span class="sd">        Decimal(&#39;111110010&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">logical_invert</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.logical_or"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.logical_or">[docs]</a>    <span class="k">def</span> <span class="nf">logical_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies the logical operation &#39;or&#39; between each operand&#39;s digits.</span>

<span class="sd">        The operands must be both logical numbers.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(Decimal(&#39;0&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(Decimal(&#39;0&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(Decimal(&#39;1&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(Decimal(&#39;1&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(Decimal(&#39;1100&#39;), Decimal(&#39;1010&#39;))</span>
<span class="sd">        Decimal(&#39;1110&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(Decimal(&#39;1110&#39;), Decimal(&#39;10&#39;))</span>
<span class="sd">        Decimal(&#39;1110&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(110, 1101)</span>
<span class="sd">        Decimal(&#39;1111&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(Decimal(110), 1101)</span>
<span class="sd">        Decimal(&#39;1111&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_or(110, Decimal(1101))</span>
<span class="sd">        Decimal(&#39;1111&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.logical_xor"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.logical_xor">[docs]</a>    <span class="k">def</span> <span class="nf">logical_xor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies the logical operation &#39;xor&#39; between each operand&#39;s digits.</span>

<span class="sd">        The operands must be both logical numbers.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(Decimal(&#39;0&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(Decimal(&#39;0&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(Decimal(&#39;1&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(Decimal(&#39;1&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(Decimal(&#39;1100&#39;), Decimal(&#39;1010&#39;))</span>
<span class="sd">        Decimal(&#39;110&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(Decimal(&#39;1111&#39;), Decimal(&#39;10&#39;))</span>
<span class="sd">        Decimal(&#39;1101&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(110, 1101)</span>
<span class="sd">        Decimal(&#39;1011&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(Decimal(110), 1101)</span>
<span class="sd">        Decimal(&#39;1011&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.logical_xor(110, Decimal(1101))</span>
<span class="sd">        Decimal(&#39;1011&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.max"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.max">[docs]</a>    <span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;max compares two values numerically and returns the maximum.</span>

<span class="sd">        If either operand is a NaN then the general rules apply.</span>
<span class="sd">        Otherwise, the operands are compared as though by the compare</span>
<span class="sd">        operation.  If they are numerically equal then the left-hand operand</span>
<span class="sd">        is chosen as the result.  Otherwise the maximum (closer to positive</span>
<span class="sd">        infinity) of the two operands is chosen as the result.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.max(Decimal(&#39;3&#39;), Decimal(&#39;2&#39;))</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max(Decimal(&#39;-10&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max(Decimal(&#39;1.0&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max(Decimal(&#39;7&#39;), Decimal(&#39;NaN&#39;))</span>
<span class="sd">        Decimal(&#39;7&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max(1, 2)</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max(Decimal(1), 2)</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max(1, Decimal(2))</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.max_mag"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.max_mag">[docs]</a>    <span class="k">def</span> <span class="nf">max_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares the values numerically with their sign ignored.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.max_mag(Decimal(&#39;7&#39;), Decimal(&#39;NaN&#39;))</span>
<span class="sd">        Decimal(&#39;7&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max_mag(Decimal(&#39;7&#39;), Decimal(&#39;-10&#39;))</span>
<span class="sd">        Decimal(&#39;-10&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max_mag(1, -2)</span>
<span class="sd">        Decimal(&#39;-2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max_mag(Decimal(1), -2)</span>
<span class="sd">        Decimal(&#39;-2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.max_mag(1, Decimal(-2))</span>
<span class="sd">        Decimal(&#39;-2&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">max_mag</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.min"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.min">[docs]</a>    <span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;min compares two values numerically and returns the minimum.</span>

<span class="sd">        If either operand is a NaN then the general rules apply.</span>
<span class="sd">        Otherwise, the operands are compared as though by the compare</span>
<span class="sd">        operation.  If they are numerically equal then the left-hand operand</span>
<span class="sd">        is chosen as the result.  Otherwise the minimum (closer to negative</span>
<span class="sd">        infinity) of the two operands is chosen as the result.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.min(Decimal(&#39;3&#39;), Decimal(&#39;2&#39;))</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min(Decimal(&#39;-10&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;-10&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min(Decimal(&#39;1.0&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1.0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min(Decimal(&#39;7&#39;), Decimal(&#39;NaN&#39;))</span>
<span class="sd">        Decimal(&#39;7&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min(1, 2)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min(Decimal(1), 2)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min(1, Decimal(29))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.min_mag"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.min_mag">[docs]</a>    <span class="k">def</span> <span class="nf">min_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares the values numerically with their sign ignored.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.min_mag(Decimal(&#39;3&#39;), Decimal(&#39;-2&#39;))</span>
<span class="sd">        Decimal(&#39;-2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min_mag(Decimal(&#39;-3&#39;), Decimal(&#39;NaN&#39;))</span>
<span class="sd">        Decimal(&#39;-3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min_mag(1, -2)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min_mag(Decimal(1), -2)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.min_mag(1, Decimal(-2))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">min_mag</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.minus"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.minus">[docs]</a>    <span class="k">def</span> <span class="nf">minus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Minus corresponds to unary prefix minus in Python.</span>

<span class="sd">        The operation is evaluated using the same rules as subtract; the</span>
<span class="sd">        operation minus(a) is calculated as subtract(&#39;0&#39;, a) where the &#39;0&#39;</span>
<span class="sd">        has the same exponent as the operand.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.minus(Decimal(&#39;1.3&#39;))</span>
<span class="sd">        Decimal(&#39;-1.3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.minus(Decimal(&#39;-1.3&#39;))</span>
<span class="sd">        Decimal(&#39;1.3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.minus(1)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">__neg__</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.multiply"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.multiply">[docs]</a>    <span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;multiply multiplies two operands.</span>

<span class="sd">        If either operand is a special value then the general rules apply.</span>
<span class="sd">        Otherwise, the operands are multiplied together</span>
<span class="sd">        (&#39;long multiplication&#39;), resulting in a number which may be as long as</span>
<span class="sd">        the sum of the lengths of the two operands.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.multiply(Decimal(&#39;1.20&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;3.60&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.multiply(Decimal(&#39;7&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;21&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.multiply(Decimal(&#39;0.9&#39;), Decimal(&#39;0.8&#39;))</span>
<span class="sd">        Decimal(&#39;0.72&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.multiply(Decimal(&#39;0.9&#39;), Decimal(&#39;-0&#39;))</span>
<span class="sd">        Decimal(&#39;-0.0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.multiply(Decimal(&#39;654321&#39;), Decimal(&#39;654321&#39;))</span>
<span class="sd">        Decimal(&#39;4.28135971E+11&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.multiply(7, 7)</span>
<span class="sd">        Decimal(&#39;49&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.multiply(Decimal(7), 7)</span>
<span class="sd">        Decimal(&#39;49&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.multiply(7, Decimal(7))</span>
<span class="sd">        Decimal(&#39;49&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">__mul__</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Context.next_minus"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.next_minus">[docs]</a>    <span class="k">def</span> <span class="nf">next_minus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the largest representable number smaller than a.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.next_minus(Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;0.999999999&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_minus(Decimal(&#39;1E-1007&#39;))</span>
<span class="sd">        Decimal(&#39;0E-1007&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.next_minus(Decimal(&#39;-1.00000003&#39;))</span>
<span class="sd">        Decimal(&#39;-1.00000004&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_minus(Decimal(&#39;Infinity&#39;))</span>
<span class="sd">        Decimal(&#39;9.99999999E+999&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_minus(1)</span>
<span class="sd">        Decimal(&#39;0.999999999&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">next_minus</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.next_plus"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.next_plus">[docs]</a>    <span class="k">def</span> <span class="nf">next_plus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the smallest representable number larger than a.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.next_plus(Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1.00000001&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_plus(Decimal(&#39;-1E-1007&#39;))</span>
<span class="sd">        Decimal(&#39;-0E-1007&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.next_plus(Decimal(&#39;-1.00000003&#39;))</span>
<span class="sd">        Decimal(&#39;-1.00000002&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_plus(Decimal(&#39;-Infinity&#39;))</span>
<span class="sd">        Decimal(&#39;-9.99999999E+999&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_plus(1)</span>
<span class="sd">        Decimal(&#39;1.00000001&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">next_plus</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.next_toward"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.next_toward">[docs]</a>    <span class="k">def</span> <span class="nf">next_toward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the number closest to a, in direction towards b.</span>

<span class="sd">        The result is the closest representable number from the first</span>
<span class="sd">        operand (but not the first operand) that is in the direction</span>
<span class="sd">        towards the second operand, unless the operands have the same</span>
<span class="sd">        value.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(Decimal(&#39;1&#39;), Decimal(&#39;2&#39;))</span>
<span class="sd">        Decimal(&#39;1.00000001&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(Decimal(&#39;-1E-1007&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;-0E-1007&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(Decimal(&#39;-1.00000003&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;-1.00000002&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(Decimal(&#39;1&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;0.999999999&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(Decimal(&#39;1E-1007&#39;), Decimal(&#39;-100&#39;))</span>
<span class="sd">        Decimal(&#39;0E-1007&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(Decimal(&#39;-1.00000003&#39;), Decimal(&#39;-10&#39;))</span>
<span class="sd">        Decimal(&#39;-1.00000004&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(Decimal(&#39;0.00&#39;), Decimal(&#39;-0.0000&#39;))</span>
<span class="sd">        Decimal(&#39;-0.00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(0, 1)</span>
<span class="sd">        Decimal(&#39;1E-1007&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(Decimal(0), 1)</span>
<span class="sd">        Decimal(&#39;1E-1007&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.next_toward(0, Decimal(1))</span>
<span class="sd">        Decimal(&#39;1E-1007&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">next_toward</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.normalize"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.normalize">[docs]</a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;normalize reduces an operand to its simplest form.</span>

<span class="sd">        Essentially a plus operation with all trailing zeros removed from the</span>
<span class="sd">        result.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.normalize(Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;2.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.normalize(Decimal(&#39;-2.0&#39;))</span>
<span class="sd">        Decimal(&#39;-2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.normalize(Decimal(&#39;1.200&#39;))</span>
<span class="sd">        Decimal(&#39;1.2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.normalize(Decimal(&#39;-120&#39;))</span>
<span class="sd">        Decimal(&#39;-1.2E+2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.normalize(Decimal(&#39;120.00&#39;))</span>
<span class="sd">        Decimal(&#39;1.2E+2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.normalize(Decimal(&#39;0.00&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.normalize(6)</span>
<span class="sd">        Decimal(&#39;6&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.number_class"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.number_class">[docs]</a>    <span class="k">def</span> <span class="nf">number_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an indication of the class of the operand.</span>

<span class="sd">        The class is one of the following strings:</span>
<span class="sd">          -sNaN</span>
<span class="sd">          -NaN</span>
<span class="sd">          -Infinity</span>
<span class="sd">          -Normal</span>
<span class="sd">          -Subnormal</span>
<span class="sd">          -Zero</span>
<span class="sd">          +Zero</span>
<span class="sd">          +Subnormal</span>
<span class="sd">          +Normal</span>
<span class="sd">          +Infinity</span>

<span class="sd">        &gt;&gt;&gt; c = Context(ExtendedContext)</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;Infinity&#39;))</span>
<span class="sd">        &#39;+Infinity&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;1E-10&#39;))</span>
<span class="sd">        &#39;+Normal&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;2.50&#39;))</span>
<span class="sd">        &#39;+Normal&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;0.1E-999&#39;))</span>
<span class="sd">        &#39;+Subnormal&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;0&#39;))</span>
<span class="sd">        &#39;+Zero&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;-0&#39;))</span>
<span class="sd">        &#39;-Zero&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;-0.1E-999&#39;))</span>
<span class="sd">        &#39;-Subnormal&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;-1E-10&#39;))</span>
<span class="sd">        &#39;-Normal&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;-2.50&#39;))</span>
<span class="sd">        &#39;-Normal&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;-Infinity&#39;))</span>
<span class="sd">        &#39;-Infinity&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;NaN&#39;))</span>
<span class="sd">        &#39;NaN&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;-NaN&#39;))</span>
<span class="sd">        &#39;NaN&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(Decimal(&#39;sNaN&#39;))</span>
<span class="sd">        &#39;sNaN&#39;</span>
<span class="sd">        &gt;&gt;&gt; c.number_class(123)</span>
<span class="sd">        &#39;+Normal&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">number_class</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.plus"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.plus">[docs]</a>    <span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plus corresponds to unary prefix plus in Python.</span>

<span class="sd">        The operation is evaluated using the same rules as add; the</span>
<span class="sd">        operation plus(a) is calculated as add(&#39;0&#39;, a) where the &#39;0&#39;</span>
<span class="sd">        has the same exponent as the operand.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.plus(Decimal(&#39;1.3&#39;))</span>
<span class="sd">        Decimal(&#39;1.3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.plus(Decimal(&#39;-1.3&#39;))</span>
<span class="sd">        Decimal(&#39;-1.3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.plus(-1)</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">__pos__</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.power"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.power">[docs]</a>    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">modulo</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raises a to the power of b, to modulo if given.</span>

<span class="sd">        With two arguments, compute a**b.  If a is negative then b</span>
<span class="sd">        must be integral.  The result will be inexact unless b is</span>
<span class="sd">        integral and the result is finite and can be expressed exactly</span>
<span class="sd">        in &#39;precision&#39; digits.</span>

<span class="sd">        With three arguments, compute (a**b) % modulo.  For the</span>
<span class="sd">        three argument form, the following restrictions on the</span>
<span class="sd">        arguments hold:</span>

<span class="sd">         - all three arguments must be integral</span>
<span class="sd">         - b must be nonnegative</span>
<span class="sd">         - at least one of a or b must be nonzero</span>
<span class="sd">         - modulo must be nonzero and have at most &#39;precision&#39; digits</span>

<span class="sd">        The result of pow(a, b, modulo) is identical to the result</span>
<span class="sd">        that would be obtained by computing (a**b) % modulo with</span>
<span class="sd">        unbounded precision, but is computed more efficiently.  It is</span>
<span class="sd">        always exact.</span>

<span class="sd">        &gt;&gt;&gt; c = ExtendedContext.copy()</span>
<span class="sd">        &gt;&gt;&gt; c.Emin = -999</span>
<span class="sd">        &gt;&gt;&gt; c.Emax = 999</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;2&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;8&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-2&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;-8&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;2&#39;), Decimal(&#39;-3&#39;))</span>
<span class="sd">        Decimal(&#39;0.125&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;1.7&#39;), Decimal(&#39;8&#39;))</span>
<span class="sd">        Decimal(&#39;69.7575744&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;10&#39;), Decimal(&#39;0.301029996&#39;))</span>
<span class="sd">        Decimal(&#39;2.00000000&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;Infinity&#39;), Decimal(&#39;-1&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;Infinity&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;Infinity&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-Infinity&#39;), Decimal(&#39;-1&#39;))</span>
<span class="sd">        Decimal(&#39;-0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-Infinity&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-Infinity&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-Infinity&#39;), Decimal(&#39;2&#39;))</span>
<span class="sd">        Decimal(&#39;Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;0&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;NaN&#39;)</span>

<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;3&#39;), Decimal(&#39;7&#39;), Decimal(&#39;16&#39;))</span>
<span class="sd">        Decimal(&#39;11&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-3&#39;), Decimal(&#39;7&#39;), Decimal(&#39;16&#39;))</span>
<span class="sd">        Decimal(&#39;-11&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-3&#39;), Decimal(&#39;8&#39;), Decimal(&#39;16&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;3&#39;), Decimal(&#39;7&#39;), Decimal(&#39;-16&#39;))</span>
<span class="sd">        Decimal(&#39;11&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;23E12345&#39;), Decimal(&#39;67E189&#39;), Decimal(&#39;123456789&#39;))</span>
<span class="sd">        Decimal(&#39;11729830&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-0&#39;), Decimal(&#39;17&#39;), Decimal(&#39;1729&#39;))</span>
<span class="sd">        Decimal(&#39;-0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.power(Decimal(&#39;-23&#39;), Decimal(&#39;0&#39;), Decimal(&#39;65537&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.power(7, 7)</span>
<span class="sd">        Decimal(&#39;823543&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.power(Decimal(7), 7)</span>
<span class="sd">        Decimal(&#39;823543&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.power(7, Decimal(7), 2)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">__pow__</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">modulo</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Context.quantize"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.quantize">[docs]</a>    <span class="k">def</span> <span class="nf">quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a value equal to &#39;a&#39; (rounded), having the exponent of &#39;b&#39;.</span>

<span class="sd">        The coefficient of the result is derived from that of the left-hand</span>
<span class="sd">        operand.  It may be rounded using the current rounding setting (if the</span>
<span class="sd">        exponent is being increased), multiplied by a positive power of ten (if</span>
<span class="sd">        the exponent is being decreased), or is unchanged (if the exponent is</span>
<span class="sd">        already equal to that of the right-hand operand).</span>

<span class="sd">        Unlike other operations, if the length of the coefficient after the</span>
<span class="sd">        quantize operation would be greater than precision then an Invalid</span>
<span class="sd">        operation condition is raised.  This guarantees that, unless there is</span>
<span class="sd">        an error condition, the exponent of the result of a quantize is always</span>
<span class="sd">        equal to that of the right-hand operand.</span>

<span class="sd">        Also unlike other operations, quantize will never raise Underflow, even</span>
<span class="sd">        if the result is subnormal and inexact.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;2.17&#39;), Decimal(&#39;0.001&#39;))</span>
<span class="sd">        Decimal(&#39;2.170&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;2.17&#39;), Decimal(&#39;0.01&#39;))</span>
<span class="sd">        Decimal(&#39;2.17&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;2.17&#39;), Decimal(&#39;0.1&#39;))</span>
<span class="sd">        Decimal(&#39;2.2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;2.17&#39;), Decimal(&#39;1e+0&#39;))</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;2.17&#39;), Decimal(&#39;1e+1&#39;))</span>
<span class="sd">        Decimal(&#39;0E+1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;-Inf&#39;), Decimal(&#39;Infinity&#39;))</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;2&#39;), Decimal(&#39;Infinity&#39;))</span>
<span class="sd">        Decimal(&#39;NaN&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;-0.1&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;-0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;-0&#39;), Decimal(&#39;1e+5&#39;))</span>
<span class="sd">        Decimal(&#39;-0E+5&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;+35236450.6&#39;), Decimal(&#39;1e-2&#39;))</span>
<span class="sd">        Decimal(&#39;NaN&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;-35236450.6&#39;), Decimal(&#39;1e-2&#39;))</span>
<span class="sd">        Decimal(&#39;NaN&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;217&#39;), Decimal(&#39;1e-1&#39;))</span>
<span class="sd">        Decimal(&#39;217.0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;217&#39;), Decimal(&#39;1e-0&#39;))</span>
<span class="sd">        Decimal(&#39;217&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;217&#39;), Decimal(&#39;1e+1&#39;))</span>
<span class="sd">        Decimal(&#39;2.2E+2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(&#39;217&#39;), Decimal(&#39;1e+2&#39;))</span>
<span class="sd">        Decimal(&#39;2E+2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(1, 2)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(Decimal(1), 2)</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.quantize(1, Decimal(2))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.radix"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.radix">[docs]</a>    <span class="k">def</span> <span class="nf">radix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Just returns 10, as this is Decimal, :)</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.radix()</span>
<span class="sd">        Decimal(&#39;10&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.remainder"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.remainder">[docs]</a>    <span class="k">def</span> <span class="nf">remainder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the remainder from integer division.</span>

<span class="sd">        The result is the residue of the dividend after the operation of</span>
<span class="sd">        calculating integer division as described for divide-integer, rounded</span>
<span class="sd">        to precision digits if necessary.  The sign of the result, if</span>
<span class="sd">        non-zero, is the same as that of the original dividend.</span>

<span class="sd">        This operation will fail under the same conditions as integer division</span>
<span class="sd">        (that is, if integer division on the same two operands would fail, the</span>
<span class="sd">        remainder cannot be calculated).</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(Decimal(&#39;2.1&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;2.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(Decimal(&#39;10&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(Decimal(&#39;-10&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(Decimal(&#39;10.2&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;0.2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(Decimal(&#39;10&#39;), Decimal(&#39;0.3&#39;))</span>
<span class="sd">        Decimal(&#39;0.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(Decimal(&#39;3.6&#39;), Decimal(&#39;1.3&#39;))</span>
<span class="sd">        Decimal(&#39;1.0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(22, 6)</span>
<span class="sd">        Decimal(&#39;4&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(Decimal(22), 6)</span>
<span class="sd">        Decimal(&#39;4&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder(22, Decimal(6))</span>
<span class="sd">        Decimal(&#39;4&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">__mod__</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Context.remainder_near"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.remainder_near">[docs]</a>    <span class="k">def</span> <span class="nf">remainder_near</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns to be &quot;a - b * n&quot;, where n is the integer nearest the exact</span>
<span class="sd">        value of &quot;x / b&quot; (if two integers are equally near then the even one</span>
<span class="sd">        is chosen).  If the result is equal to 0 then its sign will be the</span>
<span class="sd">        sign of a.</span>

<span class="sd">        This operation will fail under the same conditions as integer division</span>
<span class="sd">        (that is, if integer division on the same two operands would fail, the</span>
<span class="sd">        remainder cannot be calculated).</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(Decimal(&#39;2.1&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;-0.9&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(Decimal(&#39;10&#39;), Decimal(&#39;6&#39;))</span>
<span class="sd">        Decimal(&#39;-2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(Decimal(&#39;10&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(Decimal(&#39;-10&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;-1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(Decimal(&#39;10.2&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;0.2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(Decimal(&#39;10&#39;), Decimal(&#39;0.3&#39;))</span>
<span class="sd">        Decimal(&#39;0.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(Decimal(&#39;3.6&#39;), Decimal(&#39;1.3&#39;))</span>
<span class="sd">        Decimal(&#39;-0.3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(3, 11)</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(Decimal(3), 11)</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.remainder_near(3, Decimal(11))</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">remainder_near</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.rotate"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.rotate">[docs]</a>    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a rotated copy of a, b times.</span>

<span class="sd">        The coefficient of the result is a rotated copy of the digits in</span>
<span class="sd">        the coefficient of the first operand.  The number of places of</span>
<span class="sd">        rotation is taken from the absolute value of the second operand,</span>
<span class="sd">        with the rotation being to the left if the second operand is</span>
<span class="sd">        positive or to the right otherwise.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.rotate(Decimal(&#39;34&#39;), Decimal(&#39;8&#39;))</span>
<span class="sd">        Decimal(&#39;400000003&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.rotate(Decimal(&#39;12&#39;), Decimal(&#39;9&#39;))</span>
<span class="sd">        Decimal(&#39;12&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.rotate(Decimal(&#39;123456789&#39;), Decimal(&#39;-2&#39;))</span>
<span class="sd">        Decimal(&#39;891234567&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.rotate(Decimal(&#39;123456789&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;123456789&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.rotate(Decimal(&#39;123456789&#39;), Decimal(&#39;+2&#39;))</span>
<span class="sd">        Decimal(&#39;345678912&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.rotate(1333333, 1)</span>
<span class="sd">        Decimal(&#39;13333330&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.rotate(Decimal(1333333), 1)</span>
<span class="sd">        Decimal(&#39;13333330&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.rotate(1333333, Decimal(1))</span>
<span class="sd">        Decimal(&#39;13333330&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.same_quantum"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.same_quantum">[docs]</a>    <span class="k">def</span> <span class="nf">same_quantum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if the two operands have the same exponent.</span>

<span class="sd">        The result is never affected by either the sign or the coefficient of</span>
<span class="sd">        either operand.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.same_quantum(Decimal(&#39;2.17&#39;), Decimal(&#39;0.001&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.same_quantum(Decimal(&#39;2.17&#39;), Decimal(&#39;0.01&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.same_quantum(Decimal(&#39;2.17&#39;), Decimal(&#39;1&#39;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.same_quantum(Decimal(&#39;Inf&#39;), Decimal(&#39;-Inf&#39;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.same_quantum(10000, -1)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.same_quantum(Decimal(10000), -1)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.same_quantum(10000, Decimal(-1))</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">same_quantum</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.scaleb"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.scaleb">[docs]</a>    <span class="k">def</span> <span class="nf">scaleb</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first operand after adding the second value its exp.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.scaleb(Decimal(&#39;7.50&#39;), Decimal(&#39;-2&#39;))</span>
<span class="sd">        Decimal(&#39;0.0750&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.scaleb(Decimal(&#39;7.50&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;7.50&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.scaleb(Decimal(&#39;7.50&#39;), Decimal(&#39;3&#39;))</span>
<span class="sd">        Decimal(&#39;7.50E+3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.scaleb(1, 4)</span>
<span class="sd">        Decimal(&#39;1E+4&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.scaleb(Decimal(1), 4)</span>
<span class="sd">        Decimal(&#39;1E+4&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.scaleb(1, Decimal(4))</span>
<span class="sd">        Decimal(&#39;1E+4&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.shift"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a shifted copy of a, b times.</span>

<span class="sd">        The coefficient of the result is a shifted copy of the digits</span>
<span class="sd">        in the coefficient of the first operand.  The number of places</span>
<span class="sd">        to shift is taken from the absolute value of the second operand,</span>
<span class="sd">        with the shift being to the left if the second operand is</span>
<span class="sd">        positive or to the right otherwise.  Digits shifted into the</span>
<span class="sd">        coefficient are zeros.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.shift(Decimal(&#39;34&#39;), Decimal(&#39;8&#39;))</span>
<span class="sd">        Decimal(&#39;400000000&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.shift(Decimal(&#39;12&#39;), Decimal(&#39;9&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.shift(Decimal(&#39;123456789&#39;), Decimal(&#39;-2&#39;))</span>
<span class="sd">        Decimal(&#39;1234567&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.shift(Decimal(&#39;123456789&#39;), Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;123456789&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.shift(Decimal(&#39;123456789&#39;), Decimal(&#39;+2&#39;))</span>
<span class="sd">        Decimal(&#39;345678900&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.shift(88888888, 2)</span>
<span class="sd">        Decimal(&#39;888888800&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.shift(Decimal(88888888), 2)</span>
<span class="sd">        Decimal(&#39;888888800&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.shift(88888888, Decimal(2))</span>
<span class="sd">        Decimal(&#39;888888800&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.sqrt"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.sqrt">[docs]</a>    <span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Square root of a non-negative number to context precision.</span>

<span class="sd">        If the result must be inexact, it is rounded using the round-half-even</span>
<span class="sd">        algorithm.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;0&#39;))</span>
<span class="sd">        Decimal(&#39;0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;-0&#39;))</span>
<span class="sd">        Decimal(&#39;-0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;0.39&#39;))</span>
<span class="sd">        Decimal(&#39;0.624499800&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;100&#39;))</span>
<span class="sd">        Decimal(&#39;10&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;1&#39;))</span>
<span class="sd">        Decimal(&#39;1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;1.0&#39;))</span>
<span class="sd">        Decimal(&#39;1.0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;1.00&#39;))</span>
<span class="sd">        Decimal(&#39;1.0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;7&#39;))</span>
<span class="sd">        Decimal(&#39;2.64575131&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(Decimal(&#39;10&#39;))</span>
<span class="sd">        Decimal(&#39;3.16227766&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.sqrt(2)</span>
<span class="sd">        Decimal(&#39;1.41421356&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.prec</span>
<span class="sd">        9</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.subtract"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.subtract">[docs]</a>    <span class="k">def</span> <span class="nf">subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the difference between the two operands.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.subtract(Decimal(&#39;1.3&#39;), Decimal(&#39;1.07&#39;))</span>
<span class="sd">        Decimal(&#39;0.23&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.subtract(Decimal(&#39;1.3&#39;), Decimal(&#39;1.30&#39;))</span>
<span class="sd">        Decimal(&#39;0.00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.subtract(Decimal(&#39;1.3&#39;), Decimal(&#39;2.07&#39;))</span>
<span class="sd">        Decimal(&#39;-0.77&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.subtract(8, 5)</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.subtract(Decimal(8), 5)</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.subtract(8, Decimal(5))</span>
<span class="sd">        Decimal(&#39;3&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">__sub__</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Context.to_eng_string"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.to_eng_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_eng_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Converts a number to a string, using scientific notation.</span>

<span class="sd">        The operation is not affected by the context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">to_eng_string</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.to_sci_string"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.to_sci_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_sci_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Converts a number to a string, using scientific notation.</span>

<span class="sd">        The operation is not affected by the context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">__str__</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Context.to_integral_exact"><a class="viewcode-back" href="../09_numeric/decimal.html#decimal.Context.to_integral_exact">[docs]</a>    <span class="k">def</span> <span class="nf">to_integral_exact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rounds to an integer.</span>

<span class="sd">        When the operand has a negative exponent, the result is the same</span>
<span class="sd">        as using the quantize() operation using the given operand as the</span>
<span class="sd">        left-hand-operand, 1E+0 as the right-hand-operand, and the precision</span>
<span class="sd">        of the operand as the precision setting; Inexact and Rounded flags</span>
<span class="sd">        are allowed in this operation.  The rounding mode is taken from the</span>
<span class="sd">        context.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_exact(Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_exact(Decimal(&#39;100&#39;))</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_exact(Decimal(&#39;100.0&#39;))</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_exact(Decimal(&#39;101.5&#39;))</span>
<span class="sd">        Decimal(&#39;102&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_exact(Decimal(&#39;-101.5&#39;))</span>
<span class="sd">        Decimal(&#39;-102&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_exact(Decimal(&#39;10E+5&#39;))</span>
<span class="sd">        Decimal(&#39;1.0E+6&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_exact(Decimal(&#39;7.89E+77&#39;))</span>
<span class="sd">        Decimal(&#39;7.89E+77&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_exact(Decimal(&#39;-Inf&#39;))</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">to_integral_exact</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">to_integral_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rounds to an integer.</span>

<span class="sd">        When the operand has a negative exponent, the result is the same</span>
<span class="sd">        as using the quantize() operation using the given operand as the</span>
<span class="sd">        left-hand-operand, 1E+0 as the right-hand-operand, and the precision</span>
<span class="sd">        of the operand as the precision setting, except that no flags will</span>
<span class="sd">        be set.  The rounding mode is taken from the context.</span>

<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_value(Decimal(&#39;2.1&#39;))</span>
<span class="sd">        Decimal(&#39;2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_value(Decimal(&#39;100&#39;))</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_value(Decimal(&#39;100.0&#39;))</span>
<span class="sd">        Decimal(&#39;100&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_value(Decimal(&#39;101.5&#39;))</span>
<span class="sd">        Decimal(&#39;102&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_value(Decimal(&#39;-101.5&#39;))</span>
<span class="sd">        Decimal(&#39;-102&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_value(Decimal(&#39;10E+5&#39;))</span>
<span class="sd">        Decimal(&#39;1.0E+6&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_value(Decimal(&#39;7.89E+77&#39;))</span>
<span class="sd">        Decimal(&#39;7.89E+77&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ExtendedContext.to_integral_value(Decimal(&#39;-Inf&#39;))</span>
<span class="sd">        Decimal(&#39;-Infinity&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_convert_other</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">to_integral_value</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># the method name changed, but we provide also the old one, for compatibility</span>
    <span class="n">to_integral</span> <span class="o">=</span> <span class="n">to_integral_value</span></div>

<span class="k">class</span> <span class="nc">_WorkRep</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sign&#39;</span><span class="p">,</span><span class="s1">&#39;int&#39;</span><span class="p">,</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span>
    <span class="c1"># sign: 0 or 1</span>
    <span class="c1"># int:  int or long</span>
    <span class="c1"># exp:  None, int, or string</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_sign</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">_int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_exp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># assert isinstance(value, tuple)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">int</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%r</span><span class="s2">, </span><span class="si">%r</span><span class="s2">, </span><span class="si">%r</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>

    <span class="n">__str__</span> <span class="o">=</span> <span class="n">__repr__</span>



<span class="k">def</span> <span class="nf">_normalize</span><span class="p">(</span><span class="n">op1</span><span class="p">,</span> <span class="n">op2</span><span class="p">,</span> <span class="n">prec</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Normalizes op1, op2 to have the same exp and length of coefficient.</span>

<span class="sd">    Done during addition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">op1</span><span class="o">.</span><span class="n">exp</span> <span class="o">&lt;</span> <span class="n">op2</span><span class="o">.</span><span class="n">exp</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">op2</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">op1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">op1</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">op2</span>

    <span class="c1"># Let exp = min(tmp.exp - 1, tmp.adjusted() - precision - 1).</span>
    <span class="c1"># Then adding 10**exp to tmp has the same effect (after rounding)</span>
    <span class="c1"># as adding any positive quantity smaller than 10**exp; similarly</span>
    <span class="c1"># for subtraction.  So if other is smaller than 10**exp we replace</span>
    <span class="c1"># it with 10**exp.  This avoids tmp.exp - other.exp getting too large.</span>
    <span class="n">tmp_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
    <span class="n">other_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">exp</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmp_len</span> <span class="o">-</span> <span class="n">prec</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">other_len</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">exp</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">exp</span><span class="p">:</span>
        <span class="n">other</span><span class="o">.</span><span class="n">int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">other</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">exp</span>

    <span class="n">tmp</span><span class="o">.</span><span class="n">int</span> <span class="o">*=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">exp</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">exp</span>
    <span class="k">return</span> <span class="n">op1</span><span class="p">,</span> <span class="n">op2</span>

<span class="c1">##### Integer arithmetic functions used by ln, log10, exp and __pow__ #####</span>

<span class="c1"># This function from Tim Peters was taken from here:</span>
<span class="c1"># http://mail.python.org/pipermail/python-list/1999-July/007758.html</span>
<span class="c1"># The correction being in the function definition is for speed, and</span>
<span class="c1"># the whole function is not resolved with math.log because of avoiding</span>
<span class="c1"># the use of floats.</span>
<span class="k">def</span> <span class="nf">_nbits</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">correction</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;0&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}):</span>
    <span class="sd">&quot;&quot;&quot;Number of bits in binary representation of the positive integer n,</span>
<span class="sd">    or 0 if n == 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The argument to _nbits should be nonnegative.&quot;</span><span class="p">)</span>
    <span class="n">hex_n</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">n</span>
    <span class="k">return</span> <span class="mi">4</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">hex_n</span><span class="p">)</span> <span class="o">-</span> <span class="n">correction</span><span class="p">[</span><span class="n">hex_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">_decimal_lshift_exact</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Given integers n and e, return n * 10**e if it&#39;s an integer, else None.</span>

<span class="sd">    The computation is designed to avoid computing large powers of 10</span>
<span class="sd">    unnecessarily.</span>

<span class="sd">    &gt;&gt;&gt; _decimal_lshift_exact(3, 4)</span>
<span class="sd">    30000</span>
<span class="sd">    &gt;&gt;&gt; _decimal_lshift_exact(300, -999999999)  # returns None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">e</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># val_n = largest power of 10 dividing n.</span>
        <span class="n">str_n</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">val_n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_n</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_n</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">val_n</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">e</span> <span class="k">else</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="o">**-</span><span class="n">e</span>

<span class="k">def</span> <span class="nf">_sqrt_nearest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Closest integer to the square root of the positive integer n.  a is</span>
<span class="sd">    an initial approximation to the square root.  Any positive integer</span>
<span class="sd">    will do for a, but the closer a is to the square root of n the</span>
<span class="sd">    faster convergence will be.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both arguments to _sqrt_nearest should be positive.&quot;</span><span class="p">)</span>

    <span class="n">b</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">while</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">--</span><span class="n">n</span><span class="o">//</span><span class="n">a</span><span class="o">&gt;&gt;</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="k">def</span> <span class="nf">_rshift_nearest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shift</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given an integer x and a nonnegative integer shift, return closest</span>
<span class="sd">    integer to x / 2**shift; use round-to-even in case of a tie.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="il">1L</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">,</span> <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">shift</span>
    <span class="k">return</span> <span class="n">q</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">q</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_div_nearest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Closest integer to a/b, a and b positive integers; rounds to even</span>
<span class="sd">    in the case of a tie.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span> <span class="o">+</span> <span class="p">(</span><span class="n">q</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_ilog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integer approximation to M*log(x/M), with absolute error boundable</span>
<span class="sd">    in terms only of x/M.</span>

<span class="sd">    Given positive integers x and M, return an integer approximation to</span>
<span class="sd">    M * log(x/M).  For L = 8 and 0.1 &lt;= x/M &lt;= 10 the difference</span>
<span class="sd">    between the approximation and the exact result is at most 22.  For</span>
<span class="sd">    L = 8 and 1.0 &lt;= x/M &lt;= 10.0 the difference is at most 15.  In</span>
<span class="sd">    both cases these are upper bounds on the error; it will usually be</span>
<span class="sd">    much smaller.&quot;&quot;&quot;</span>

    <span class="c1"># The basic algorithm is the following: let log1p be the function</span>
    <span class="c1"># log1p(x) = log(1+x).  Then log(x/M) = log1p((x-M)/M).  We use</span>
    <span class="c1"># the reduction</span>
    <span class="c1">#</span>
    <span class="c1">#    log1p(y) = 2*log1p(y/(1+sqrt(1+y)))</span>
    <span class="c1">#</span>
    <span class="c1"># repeatedly until the argument to log1p is small (&lt; 2**-L in</span>
    <span class="c1"># absolute value).  For small y we can use the Taylor series</span>
    <span class="c1"># expansion</span>
    <span class="c1">#</span>
    <span class="c1">#    log1p(y) ~ y - y**2/2 + y**3/3 - ... - (-y)**T/T</span>
    <span class="c1">#</span>
    <span class="c1"># truncating at T such that y**T is small enough.  The whole</span>
    <span class="c1"># computation is carried out in a form of fixed-point arithmetic,</span>
    <span class="c1"># with a real number z being represented by an integer</span>
    <span class="c1"># approximation to z*M.  To avoid loss of precision, the y below</span>
    <span class="c1"># is actually an integer approximation to 2**R*y*M, where R is the</span>
    <span class="c1"># number of reductions performed so far.</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">M</span>
    <span class="c1"># argument reduction; R = number of reductions performed</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">R</span> <span class="o">&lt;=</span> <span class="n">L</span> <span class="ow">and</span> <span class="nb">long</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">L</span><span class="o">-</span><span class="n">R</span> <span class="o">&gt;=</span> <span class="n">M</span> <span class="ow">or</span>
           <span class="n">R</span> <span class="o">&gt;</span> <span class="n">L</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">R</span><span class="o">-</span><span class="n">L</span> <span class="o">&gt;=</span> <span class="n">M</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="nb">long</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span>
                         <span class="n">M</span> <span class="o">+</span> <span class="n">_sqrt_nearest</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="n">_rshift_nearest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">R</span><span class="p">)),</span> <span class="n">M</span><span class="p">))</span>
        <span class="n">R</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Taylor series with T terms</span>
    <span class="n">T</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">M</span><span class="p">))</span><span class="o">//</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">L</span><span class="p">))</span>
    <span class="n">yshift</span> <span class="o">=</span> <span class="n">_rshift_nearest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">yshift</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_dlog10</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given integers c, e and p with c &gt; 0, p &gt;= 0, compute an integer</span>
<span class="sd">    approximation to 10**p * log10(c*10**e), with an absolute error of</span>
<span class="sd">    at most 1.  Assumes that c*10**e is not exactly 1.&quot;&quot;&quot;</span>

    <span class="c1"># increase precision by 2; compensate for this by dividing</span>
    <span class="c1"># final result by 100</span>
    <span class="n">p</span> <span class="o">+=</span> <span class="mi">2</span>

    <span class="c1"># write c*10**e as d*10**f with either:</span>
    <span class="c1">#   f &gt;= 0 and 1 &lt;= d &lt;= 10, or</span>
    <span class="c1">#   f &lt;= 0 and 0.1 &lt;= d &lt;= 1.</span>
    <span class="c1"># Thus for c*10**e close to 1, f = 0</span>
    <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">e</span><span class="o">+</span><span class="n">l</span> <span class="o">-</span> <span class="p">(</span><span class="n">e</span><span class="o">+</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">p</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">+</span><span class="n">p</span><span class="o">-</span><span class="n">f</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">*=</span> <span class="mi">10</span><span class="o">**</span><span class="n">k</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="n">k</span><span class="p">)</span>

        <span class="n">log_d</span> <span class="o">=</span> <span class="n">_ilog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span> <span class="c1"># error &lt; 5 + 22 = 27</span>
        <span class="n">log_10</span> <span class="o">=</span> <span class="n">_log10_digits</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="c1"># error &lt; 1</span>
        <span class="n">log_d</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">log_d</span><span class="o">*</span><span class="n">M</span><span class="p">,</span> <span class="n">log_10</span><span class="p">)</span>
        <span class="n">log_tenpower</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">M</span> <span class="c1"># exact</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log_d</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># error &lt; 2.31</span>
        <span class="n">log_tenpower</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="n">p</span><span class="p">)</span> <span class="c1"># error &lt; 0.5</span>

    <span class="k">return</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">log_tenpower</span><span class="o">+</span><span class="n">log_d</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_dlog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given integers c, e and p with c &gt; 0, compute an integer</span>
<span class="sd">    approximation to 10**p * log(c*10**e), with an absolute error of</span>
<span class="sd">    at most 1.  Assumes that c*10**e is not exactly 1.&quot;&quot;&quot;</span>

    <span class="c1"># Increase precision by 2. The precision increase is compensated</span>
    <span class="c1"># for at the end with a division by 100.</span>
    <span class="n">p</span> <span class="o">+=</span> <span class="mi">2</span>

    <span class="c1"># rewrite c*10**e as d*10**f with either f &gt;= 0 and 1 &lt;= d &lt;= 10,</span>
    <span class="c1"># or f &lt;= 0 and 0.1 &lt;= d &lt;= 1.  Then we can compute 10**p * log(c*10**e)</span>
    <span class="c1"># as 10**p * log(d) + 10**p*f * log(10).</span>
    <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">e</span><span class="o">+</span><span class="n">l</span> <span class="o">-</span> <span class="p">(</span><span class="n">e</span><span class="o">+</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># compute approximation to 10**p*log(d), with error &lt; 27</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">+</span><span class="n">p</span><span class="o">-</span><span class="n">f</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">*=</span> <span class="mi">10</span><span class="o">**</span><span class="n">k</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="n">k</span><span class="p">)</span>  <span class="c1"># error of &lt;= 0.5 in c</span>

        <span class="c1"># _ilog magnifies existing error in c by a factor of at most 10</span>
        <span class="n">log_d</span> <span class="o">=</span> <span class="n">_ilog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">p</span><span class="p">)</span> <span class="c1"># error &lt; 5 + 22 = 27</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># p &lt;= 0: just approximate the whole thing by 0; error &lt; 2.31</span>
        <span class="n">log_d</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># compute approximation to f*10**p*log(10), with error &lt; 11.</span>
    <span class="k">if</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">+</span> <span class="n">extra</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># error in f * _log10_digits(p+extra) &lt; |f| * 1 = |f|</span>
            <span class="c1"># after division, error &lt; |f|/10**extra + 0.5 &lt; 10 + 0.5 &lt; 11</span>
            <span class="n">f_log_ten</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">f</span><span class="o">*</span><span class="n">_log10_digits</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">extra</span><span class="p">),</span> <span class="mi">10</span><span class="o">**</span><span class="n">extra</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f_log_ten</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f_log_ten</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># error in sum &lt; 11+27 = 38; error after division &lt; 0.38 + 0.5 &lt; 1</span>
    <span class="k">return</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">f_log_ten</span> <span class="o">+</span> <span class="n">log_d</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">_Log10Memoize</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class to compute, store, and allow retrieval of, digits of the</span>
<span class="sd">    constant log(10) = 2.302585....  This constant is needed by</span>
<span class="sd">    Decimal.ln, Decimal.log10, Decimal.exp and Decimal.__pow__.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">digits</span> <span class="o">=</span> <span class="s2">&quot;23025850929940456840179914546843642076011014886&quot;</span>

    <span class="k">def</span> <span class="nf">getdigits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given an integer p &gt;= 0, return floor(10**p)*log(10).</span>

<span class="sd">        For example, self.getdigits(3) returns 2302.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># digits are stored as a string, for quick conversion to</span>
        <span class="c1"># integer in the case that we&#39;ve already computed enough</span>
        <span class="c1"># digits; the stored digits should always be correct</span>
        <span class="c1"># (truncated, not rounded to nearest).</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;p should be nonnegative&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digits</span><span class="p">):</span>
            <span class="c1"># compute p+3, p+6, p+9, ... digits; continue until at</span>
            <span class="c1"># least one of the extra digits is nonzero</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="c1"># compute p+extra digits, correct to within 1ulp</span>
                <span class="n">M</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">extra</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_div_nearest</span><span class="p">(</span><span class="n">_ilog</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">),</span> <span class="mi">100</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">digits</span><span class="p">[</span><span class="o">-</span><span class="n">extra</span><span class="p">:]</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">extra</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">extra</span> <span class="o">+=</span> <span class="mi">3</span>
            <span class="c1"># keep all reliable digits so far; remove trailing zeros</span>
            <span class="c1"># and next nonzero digit</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">digits</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digits</span><span class="p">[:</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="n">_log10_digits</span> <span class="o">=</span> <span class="n">_Log10Memoize</span><span class="p">()</span><span class="o">.</span><span class="n">getdigits</span>

<span class="k">def</span> <span class="nf">_iexp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given integers x and M, M &gt; 0, such that x/M is small in absolute</span>
<span class="sd">    value, compute an integer approximation to M*exp(x/M).  For 0 &lt;=</span>
<span class="sd">    x/M &lt;= 2.4, the absolute error in the result is bounded by 60 (and</span>
<span class="sd">    is usually much smaller).&quot;&quot;&quot;</span>

    <span class="c1"># Algorithm: to compute exp(z) for a real number z, first divide z</span>
    <span class="c1"># by a suitable power R of 2 so that |z/2**R| &lt; 2**-L.  Then</span>
    <span class="c1"># compute expm1(z/2**R) = exp(z/2**R) - 1 using the usual Taylor</span>
    <span class="c1"># series</span>
    <span class="c1">#</span>
    <span class="c1">#     expm1(x) = x + x**2/2! + x**3/3! + ...</span>
    <span class="c1">#</span>
    <span class="c1"># Now use the identity</span>
    <span class="c1">#</span>
    <span class="c1">#     expm1(2x) = expm1(x)*(expm1(x)+2)</span>
    <span class="c1">#</span>
    <span class="c1"># R times to compute the sequence expm1(z/2**R),</span>
    <span class="c1"># expm1(z/2**(R-1)), ... , exp(z/2), exp(z).</span>

    <span class="c1"># Find R such that x/2**R/M &lt;= 2**-L</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">_nbits</span><span class="p">((</span><span class="nb">long</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">L</span><span class="p">)</span><span class="o">//</span><span class="n">M</span><span class="p">)</span>

    <span class="c1"># Taylor series.  (2**L)**T &gt; M</span>
    <span class="n">T</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">M</span><span class="p">))</span><span class="o">//</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">L</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">Mshift</span> <span class="o">=</span> <span class="nb">long</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">R</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">Mshift</span> <span class="o">+</span> <span class="n">y</span><span class="p">),</span> <span class="n">Mshift</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1"># Expansion</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">Mshift</span> <span class="o">=</span> <span class="nb">long</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">Mshift</span><span class="p">),</span> <span class="n">Mshift</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">M</span><span class="o">+</span><span class="n">y</span>

<span class="k">def</span> <span class="nf">_dexp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute an approximation to exp(c*10**e), with p decimal places of</span>
<span class="sd">    precision.</span>

<span class="sd">    Returns integers d, f such that:</span>

<span class="sd">      10**(p-1) &lt;= d &lt;= 10**p, and</span>
<span class="sd">      (d-1)*10**f &lt; exp(c*10**e) &lt; (d+1)*10**f</span>

<span class="sd">    In other words, d*10**f is an approximation to exp(c*10**e) with p</span>
<span class="sd">    digits of precision, and with an error in d of at most 1.  This is</span>
<span class="sd">    almost, but not quite, the same as the error being &lt; 1ulp: when d</span>
<span class="sd">    = 10**(p-1) the error could be up to 10 ulp.&quot;&quot;&quot;</span>

    <span class="c1"># we&#39;ll call iexp with M = 10**(p+2), giving p+3 digits of precision</span>
    <span class="n">p</span> <span class="o">+=</span> <span class="mi">2</span>

    <span class="c1"># compute log(10) with extra precision = adjusted exponent of c*10**e</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">e</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">extra</span>

    <span class="c1"># compute quotient c*10**e/(log(10)) = c*10**(e+q)/(log(10)*10**q),</span>
    <span class="c1"># rounding down</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">e</span><span class="o">+</span><span class="n">q</span>
    <span class="k">if</span> <span class="n">shift</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cshift</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">shift</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cshift</span> <span class="o">=</span> <span class="n">c</span><span class="o">//</span><span class="mi">10</span><span class="o">**-</span><span class="n">shift</span>
    <span class="n">quot</span><span class="p">,</span> <span class="n">rem</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">cshift</span><span class="p">,</span> <span class="n">_log10_digits</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>

    <span class="c1"># reduce remainder back to original precision</span>
    <span class="n">rem</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">rem</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">extra</span><span class="p">)</span>

    <span class="c1"># error in result of _iexp &lt; 120;  error after division &lt; 0.62</span>
    <span class="k">return</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">_iexp</span><span class="p">(</span><span class="n">rem</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">p</span><span class="p">),</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">quot</span> <span class="o">-</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">_dpower</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">ye</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given integers xc, xe, yc and ye representing Decimals x = xc*10**xe and</span>
<span class="sd">    y = yc*10**ye, compute x**y.  Returns a pair of integers (c, e) such that:</span>

<span class="sd">      10**(p-1) &lt;= c &lt;= 10**p, and</span>
<span class="sd">      (c-1)*10**e &lt; x**y &lt; (c+1)*10**e</span>

<span class="sd">    in other words, c*10**e is an approximation to x**y with p digits</span>
<span class="sd">    of precision, and with an error in c of at most 1.  (This is</span>
<span class="sd">    almost, but not quite, the same as the error being &lt; 1ulp: when c</span>
<span class="sd">    == 10**(p-1) we can only guarantee error &lt; 10ulp.)</span>

<span class="sd">    We assume that: x is positive and not equal to 1, and y is nonzero.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Find b such that 10**(b-1) &lt;= |y| &lt;= 10**b</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">yc</span><span class="p">)))</span> <span class="o">+</span> <span class="n">ye</span>

    <span class="c1"># log(x) = lxc*10**(-p-b-1), to p+b+1 places after the decimal point</span>
    <span class="n">lxc</span> <span class="o">=</span> <span class="n">_dlog</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># compute product y*log(x) = yc*lxc*10**(-p-b-1+ye) = pc*10**(-p-1)</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">ye</span><span class="o">-</span><span class="n">b</span>
    <span class="k">if</span> <span class="n">shift</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pc</span> <span class="o">=</span> <span class="n">lxc</span><span class="o">*</span><span class="n">yc</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">shift</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pc</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">lxc</span><span class="o">*</span><span class="n">yc</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="n">shift</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># we prefer a result that isn&#39;t exactly 1; this makes it</span>
        <span class="c1"># easier to compute a correctly rounded result in __pow__</span>
        <span class="k">if</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">xc</span><span class="p">))</span> <span class="o">+</span> <span class="n">xe</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">yc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)):</span> <span class="c1"># if x**y &gt; 1:</span>
            <span class="n">coeff</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">p</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coeff</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coeff</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">_dexp</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">coeff</span> <span class="o">=</span> <span class="n">_div_nearest</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">exp</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">exp</span>

<span class="k">def</span> <span class="nf">_log10_lb</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">correction</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="mi">53</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
        <span class="s1">&#39;6&#39;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}):</span>
    <span class="sd">&quot;&quot;&quot;Compute a lower bound for 100*log10(c) for a positive integer c.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The argument to _log10_lb should be nonnegative.&quot;</span><span class="p">)</span>
    <span class="n">str_c</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">str_c</span><span class="p">)</span> <span class="o">-</span> <span class="n">correction</span><span class="p">[</span><span class="n">str_c</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="c1">##### Helper Functions ####################################################</span>

<span class="k">def</span> <span class="nf">_convert_other</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">raiseit</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">allow_float</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert other to Decimal.</span>

<span class="sd">    Verifies that it&#39;s ok to use in an implicit construction.</span>
<span class="sd">    If allow_float is true, allow conversion from float;  this</span>
<span class="sd">    is used in the comparison methods (__eq__ and friends).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">other</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">long</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">allow_float</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Decimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">raiseit</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unable to convert </span><span class="si">%s</span><span class="s2"> to Decimal&quot;</span> <span class="o">%</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">NotImplemented</span>

<span class="c1">##### Setup Specific Contexts ############################################</span>

<span class="c1"># The default context prototype used by Context()</span>
<span class="c1"># Is mutable, so that new contexts can have different default values</span>

<span class="n">DefaultContext</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
        <span class="n">prec</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_HALF_EVEN</span><span class="p">,</span>
        <span class="n">traps</span><span class="o">=</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">Overflow</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">],</span>
        <span class="n">flags</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">Emax</span><span class="o">=</span><span class="mi">999999999</span><span class="p">,</span>
        <span class="n">Emin</span><span class="o">=-</span><span class="mi">999999999</span><span class="p">,</span>
        <span class="n">capitals</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Pre-made alternate contexts offered by the specification</span>
<span class="c1"># Don&#39;t change these; the user should be able to select these</span>
<span class="c1"># contexts and be able to reproduce results from other implementations</span>
<span class="c1"># of the spec.</span>

<span class="n">BasicContext</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
        <span class="n">prec</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_HALF_UP</span><span class="p">,</span>
        <span class="n">traps</span><span class="o">=</span><span class="p">[</span><span class="n">DivisionByZero</span><span class="p">,</span> <span class="n">Overflow</span><span class="p">,</span> <span class="n">InvalidOperation</span><span class="p">,</span> <span class="n">Clamped</span><span class="p">,</span> <span class="n">Underflow</span><span class="p">],</span>
        <span class="n">flags</span><span class="o">=</span><span class="p">[],</span>
<span class="p">)</span>

<span class="n">ExtendedContext</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
        <span class="n">prec</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_HALF_EVEN</span><span class="p">,</span>
        <span class="n">traps</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">flags</span><span class="o">=</span><span class="p">[],</span>
<span class="p">)</span>


<span class="c1">##### crud for parsing strings #############################################</span>
<span class="c1">#</span>
<span class="c1"># Regular expression used for parsing numeric strings.  Additional</span>
<span class="c1"># comments:</span>
<span class="c1">#</span>
<span class="c1"># 1. Uncomment the two &#39;\s*&#39; lines to allow leading and/or trailing</span>
<span class="c1"># whitespace.  But note that the specification disallows whitespace in</span>
<span class="c1"># a numeric string.</span>
<span class="c1">#</span>
<span class="c1"># 2. For finite numbers (not infinities and NaNs) the body of the</span>
<span class="c1"># number between the optional sign and the optional exponent must have</span>
<span class="c1"># at least one decimal digit, possibly after the decimal point.  The</span>
<span class="c1"># lookahead expression &#39;(?=\d|\.\d)&#39; checks this.</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="n">_parser</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;        # A numeric string consists of:</span>
<span class="s2">#    \s*</span>
<span class="s2">    (?P&lt;sign&gt;[-+])?              # an optional sign, followed by either...</span>
<span class="s2">    (</span>
<span class="s2">        (?=\d|\.\d)              # ...a number (with at least one digit)</span>
<span class="s2">        (?P&lt;int&gt;\d*)             # having a (possibly empty) integer part</span>
<span class="s2">        (\.(?P&lt;frac&gt;\d*))?       # followed by an optional fractional part</span>
<span class="s2">        (E(?P&lt;exp&gt;[-+]?\d+))?    # followed by an optional exponent, or...</span>
<span class="s2">    |</span>
<span class="s2">        Inf(inity)?              # ...an infinity, or...</span>
<span class="s2">    |</span>
<span class="s2">        (?P&lt;signal&gt;s)?           # ...an (optionally signaling)</span>
<span class="s2">        NaN                      # NaN</span>
<span class="s2">        (?P&lt;diag&gt;\d*)            # with (possibly empty) diagnostic info.</span>
<span class="s2">    )</span>
<span class="s2">#    \s*</span>
<span class="s2">    \Z</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>

<span class="n">_all_zeros</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;0*$&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>
<span class="n">_exact_half</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;50*$&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>

<span class="c1">##### PEP3101 support functions ##############################################</span>
<span class="c1"># The functions in this section have little to do with the Decimal</span>
<span class="c1"># class, and could potentially be reused or adapted for other pure</span>
<span class="c1"># Python numeric classes that want to implement __format__</span>
<span class="c1">#</span>
<span class="c1"># A format specifier for Decimal looks like:</span>
<span class="c1">#</span>
<span class="c1">#   [[fill]align][sign][0][minimumwidth][,][.precision][type]</span>

<span class="n">_parse_format_specifier_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\A</span>
<span class="s2">(?:</span>
<span class="s2">   (?P&lt;fill&gt;.)?</span>
<span class="s2">   (?P&lt;align&gt;[&lt;&gt;=^])</span>
<span class="s2">)?</span>
<span class="s2">(?P&lt;sign&gt;[-+ ])?</span>
<span class="s2">(?P&lt;zeropad&gt;0)?</span>
<span class="s2">(?P&lt;minimumwidth&gt;(?!0)\d+)?</span>
<span class="s2">(?P&lt;thousands_sep&gt;,)?</span>
<span class="s2">(?:\.(?P&lt;precision&gt;0|(?!0)\d+))?</span>
<span class="s2">(?P&lt;type&gt;[eEfFgGn%])?</span>
<span class="s2">\Z</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>

<span class="k">del</span> <span class="n">re</span>

<span class="c1"># The locale module is only needed for the &#39;n&#39; format specifier.  The</span>
<span class="c1"># rest of the PEP 3101 code functions quite happily without it, so we</span>
<span class="c1"># don&#39;t care too much if locale isn&#39;t present.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">locale</span> <span class="kn">as</span> <span class="nn">_locale</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">_parse_format_specifier</span><span class="p">(</span><span class="n">format_spec</span><span class="p">,</span> <span class="n">_localeconv</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse and validate a format specifier.</span>

<span class="sd">    Turns a standard numeric format specifier into a dict, with the</span>
<span class="sd">    following entries:</span>

<span class="sd">      fill: fill character to pad field to minimum width</span>
<span class="sd">      align: alignment type, either &#39;&lt;&#39;, &#39;&gt;&#39;, &#39;=&#39; or &#39;^&#39;</span>
<span class="sd">      sign: either &#39;+&#39;, &#39;-&#39; or &#39; &#39;</span>
<span class="sd">      minimumwidth: nonnegative integer giving minimum width</span>
<span class="sd">      zeropad: boolean, indicating whether to pad with zeros</span>
<span class="sd">      thousands_sep: string to use as thousands separator, or &#39;&#39;</span>
<span class="sd">      grouping: grouping for thousands separators, in format</span>
<span class="sd">        used by localeconv</span>
<span class="sd">      decimal_point: string to use for decimal point</span>
<span class="sd">      precision: nonnegative integer giving precision, or None</span>
<span class="sd">      type: one of the characters &#39;eEfFgG%&#39;, or None</span>
<span class="sd">      unicode: boolean (always True for Python 3.x)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">_parse_format_specifier_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">format_spec</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid format specifier: &quot;</span> <span class="o">+</span> <span class="n">format_spec</span><span class="p">)</span>

    <span class="c1"># get the dictionary</span>
    <span class="n">format_dict</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>

    <span class="c1"># zeropad; defaults for fill and alignment.  If zero padding</span>
    <span class="c1"># is requested, the fill and align fields should be absent.</span>
    <span class="n">fill</span> <span class="o">=</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;fill&#39;</span><span class="p">]</span>
    <span class="n">align</span> <span class="o">=</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;align&#39;</span><span class="p">]</span>
    <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;zeropad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;zeropad&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;zeropad&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Fill character conflicts with &#39;0&#39;&quot;</span>
                             <span class="s2">&quot; in format specifier: &quot;</span> <span class="o">+</span> <span class="n">format_spec</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">align</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Alignment conflicts with &#39;0&#39; in &quot;</span>
                             <span class="s2">&quot;format specifier: &quot;</span> <span class="o">+</span> <span class="n">format_spec</span><span class="p">)</span>
    <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;fill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fill</span> <span class="ow">or</span> <span class="s1">&#39; &#39;</span>
    <span class="c1"># PEP 3101 originally specified that the default alignment should</span>
    <span class="c1"># be left;  it was later agreed that right-aligned makes more sense</span>
    <span class="c1"># for numeric types.  See http://bugs.python.org/issue6857.</span>
    <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;align&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">align</span> <span class="ow">or</span> <span class="s1">&#39;&gt;&#39;</span>

    <span class="c1"># default sign handling: &#39;-&#39; for negative, &#39;&#39; for positive</span>
    <span class="k">if</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>

    <span class="c1"># minimumwidth defaults to 0; precision remains None if not given</span>
    <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;minimumwidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;minimumwidth&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;precision&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;precision&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;precision&#39;</span><span class="p">])</span>

    <span class="c1"># if format type is &#39;g&#39; or &#39;G&#39; then a precision of 0 makes little</span>
    <span class="c1"># sense; convert it to 1.  Same if format type is unspecified.</span>
    <span class="k">if</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;precision&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;gG&#39;</span><span class="p">:</span>
            <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;precision&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># determine thousands separator, grouping, and decimal separator, and</span>
    <span class="c1"># add appropriate entries to format_dict</span>
    <span class="k">if</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
        <span class="c1"># apart from separators, &#39;n&#39; behaves just like &#39;g&#39;</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
        <span class="k">if</span> <span class="n">_localeconv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">_localeconv</span> <span class="o">=</span> <span class="n">_locale</span><span class="o">.</span><span class="n">localeconv</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;thousands_sep&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Explicit thousands separator conflicts with &quot;</span>
                             <span class="s2">&quot;&#39;n&#39; type in format specifier: &quot;</span> <span class="o">+</span> <span class="n">format_spec</span><span class="p">)</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;thousands_sep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_localeconv</span><span class="p">[</span><span class="s1">&#39;thousands_sep&#39;</span><span class="p">]</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;grouping&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_localeconv</span><span class="p">[</span><span class="s1">&#39;grouping&#39;</span><span class="p">]</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;decimal_point&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_localeconv</span><span class="p">[</span><span class="s1">&#39;decimal_point&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;thousands_sep&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;thousands_sep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;grouping&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;decimal_point&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>

    <span class="c1"># record whether return type should be str or unicode</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;unicode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">format_spec</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">format_dict</span><span class="p">[</span><span class="s1">&#39;unicode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">return</span> <span class="n">format_dict</span>

<span class="k">def</span> <span class="nf">_format_align</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given an unpadded, non-aligned numeric string &#39;body&#39; and sign</span>
<span class="sd">    string &#39;sign&#39;, add padding and alignment conforming to the given</span>
<span class="sd">    format specifier dictionary &#39;spec&#39; (as produced by</span>
<span class="sd">    parse_format_specifier).</span>

<span class="sd">    Also converts result to unicode if necessary.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># how much extra space do we have to play with?</span>
    <span class="n">minimumwidth</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;minimumwidth&#39;</span><span class="p">]</span>
    <span class="n">fill</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;fill&#39;</span><span class="p">]</span>
    <span class="n">padding</span> <span class="o">=</span> <span class="n">fill</span><span class="o">*</span><span class="p">(</span><span class="n">minimumwidth</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>

    <span class="n">align</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;align&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">sign</span> <span class="o">+</span> <span class="n">body</span> <span class="o">+</span> <span class="n">padding</span>
    <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">sign</span> <span class="o">+</span> <span class="n">body</span>
    <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">sign</span> <span class="o">+</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">body</span>
    <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;^&#39;</span><span class="p">:</span>
        <span class="n">half</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">padding</span><span class="p">[:</span><span class="n">half</span><span class="p">]</span> <span class="o">+</span> <span class="n">sign</span> <span class="o">+</span> <span class="n">body</span> <span class="o">+</span> <span class="n">padding</span><span class="p">[</span><span class="n">half</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unrecognised alignment field&#39;</span><span class="p">)</span>

    <span class="c1"># make sure that result is unicode if necessary</span>
    <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;unicode&#39;</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">_group_lengths</span><span class="p">(</span><span class="n">grouping</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a localeconv-style grouping into a (possibly infinite)</span>
<span class="sd">    iterable of integers representing group lengths.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The result from localeconv()[&#39;grouping&#39;], and the input to this</span>
    <span class="c1"># function, should be a list of integers in one of the</span>
    <span class="c1"># following three forms:</span>
    <span class="c1">#</span>
    <span class="c1">#   (1) an empty list, or</span>
    <span class="c1">#   (2) nonempty list of positive integers + [0]</span>
    <span class="c1">#   (3) list of positive integers + [locale.CHAR_MAX], or</span>

    <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span><span class="p">,</span> <span class="n">repeat</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">grouping</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="n">grouping</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">grouping</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">chain</span><span class="p">(</span><span class="n">grouping</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">repeat</span><span class="p">(</span><span class="n">grouping</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">grouping</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">_locale</span><span class="o">.</span><span class="n">CHAR_MAX</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">grouping</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;unrecognised format for grouping&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_insert_thousands_sep</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">min_width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Insert thousands separators into a digit string.</span>

<span class="sd">    spec is a dictionary whose keys should include &#39;thousands_sep&#39; and</span>
<span class="sd">    &#39;grouping&#39;; typically it&#39;s the result of parsing the format</span>
<span class="sd">    specifier using _parse_format_specifier.</span>

<span class="sd">    The min_width keyword argument gives the minimum length of the</span>
<span class="sd">    result, which will be padded on the left with zeros if necessary.</span>

<span class="sd">    If necessary, the zero padding adds an extra &#39;0&#39; on the left to</span>
<span class="sd">    avoid a leading thousands separator.  For example, inserting</span>
<span class="sd">    commas every three digits in &#39;123456&#39;, with min_width=8, gives</span>
<span class="sd">    &#39;0,123,456&#39;, even though that has length 9.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sep</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;thousands_sep&#39;</span><span class="p">]</span>
    <span class="n">grouping</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;grouping&#39;</span><span class="p">]</span>

    <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">_group_lengths</span><span class="p">(</span><span class="n">grouping</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;group length should be positive&quot;</span><span class="p">)</span>
        <span class="c1"># max(..., 1) forces at least 1 digit to the left of a separator</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">),</span> <span class="n">min_width</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">l</span><span class="p">)</span>
        <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">))</span> <span class="o">+</span> <span class="n">digits</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="p">:])</span>
        <span class="n">digits</span> <span class="o">=</span> <span class="n">digits</span><span class="p">[:</span><span class="o">-</span><span class="n">l</span><span class="p">]</span>
        <span class="n">min_width</span> <span class="o">-=</span> <span class="n">l</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">digits</span> <span class="ow">and</span> <span class="n">min_width</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">min_width</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">),</span> <span class="n">min_width</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">))</span> <span class="o">+</span> <span class="n">digits</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="p">:])</span>
    <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">groups</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">_format_sign</span><span class="p">(</span><span class="n">is_negative</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine sign character.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_negative</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;-&#39;</span>
    <span class="k">elif</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39; +&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span> <span class="nf">_format_number</span><span class="p">(</span><span class="n">is_negative</span><span class="p">,</span> <span class="n">intpart</span><span class="p">,</span> <span class="n">fracpart</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Format a number, given the following data:</span>

<span class="sd">    is_negative: true if the number is negative, else false</span>
<span class="sd">    intpart: string of digits that must appear before the decimal point</span>
<span class="sd">    fracpart: string of digits that must come after the point</span>
<span class="sd">    exp: exponent, as an integer</span>
<span class="sd">    spec: dictionary resulting from parsing the format specifier</span>

<span class="sd">    This function uses the information in spec to:</span>
<span class="sd">      insert separators (decimal separator and thousands separators)</span>
<span class="sd">      format the sign</span>
<span class="sd">      format the exponent</span>
<span class="sd">      add trailing &#39;%&#39; for the &#39;%&#39; type</span>
<span class="sd">      zero-pad if necessary</span>
<span class="sd">      fill and align if necessary</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sign</span> <span class="o">=</span> <span class="n">_format_sign</span><span class="p">(</span><span class="n">is_negative</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fracpart</span><span class="p">:</span>
        <span class="n">fracpart</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;decimal_point&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">fracpart</span>

    <span class="k">if</span> <span class="n">exp</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;eE&#39;</span><span class="p">:</span>
        <span class="n">echar</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="s1">&#39;e&#39;</span><span class="p">}[</span><span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span>
        <span class="n">fracpart</span> <span class="o">+=</span> <span class="s2">&quot;{0}{1:+}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">echar</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span><span class="p">:</span>
        <span class="n">fracpart</span> <span class="o">+=</span> <span class="s1">&#39;%&#39;</span>

    <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;zeropad&#39;</span><span class="p">]:</span>
        <span class="n">min_width</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;minimumwidth&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">fracpart</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">min_width</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">intpart</span> <span class="o">=</span> <span class="n">_insert_thousands_sep</span><span class="p">(</span><span class="n">intpart</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">min_width</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_format_align</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">intpart</span><span class="o">+</span><span class="n">fracpart</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>


<span class="c1">##### Useful Constants (internal use only) ################################</span>

<span class="c1"># Reusable defaults</span>
<span class="n">_Infinity</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;Inf&#39;</span><span class="p">)</span>
<span class="n">_NegativeInfinity</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-Inf&#39;</span><span class="p">)</span>
<span class="n">_NaN</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>
<span class="n">_Zero</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">_One</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_NegativeOne</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># _SignedInfinity[sign] is infinity w/ that sign</span>
<span class="n">_SignedInfinity</span> <span class="o">=</span> <span class="p">(</span><span class="n">_Infinity</span><span class="p">,</span> <span class="n">_NegativeInfinity</span><span class="p">)</span>



<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span><span class="o">,</span> <span class="nn">sys</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">])</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>